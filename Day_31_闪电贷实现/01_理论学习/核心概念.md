# æ ¸å¿ƒæ¦‚å¿µï¼šé—ªç”µè´·æ·±å…¥ç†è§£

## ğŸ“š ç›®å½•

1. [é—ªç”µè´·åŸºç¡€](#é—ªç”µè´·åŸºç¡€)
2. [Hot Potato æ¨¡å¼è¯¦è§£](#hot-potato-æ¨¡å¼è¯¦è§£)
3. [é—ªç”µè´·åè®®æ¶æ„](#é—ªç”µè´·åè®®æ¶æ„)
4. [åº”ç”¨åœºæ™¯æ·±åº¦åˆ†æ](#åº”ç”¨åœºæ™¯æ·±åº¦åˆ†æ)
5. [å®‰å…¨æ€§ä¸æ”»å‡»é˜²æŠ¤](#å®‰å…¨æ€§ä¸æ”»å‡»é˜²æŠ¤)
6. [æ•°å­¦æ¨¡å‹ä¸è®¡ç®—](#æ•°å­¦æ¨¡å‹ä¸è®¡ç®—)

---

## 1ï¸âƒ£ é—ªç”µè´·åŸºç¡€

### ä»€ä¹ˆæ˜¯é—ªç”µè´·ï¼Ÿ

**é—ªç”µè´·ï¼ˆFlash Loanï¼‰** æ˜¯ä¸€ç§åˆ›æ–°çš„ DeFi å€Ÿè´·æœºåˆ¶ï¼Œå…è®¸ç”¨æˆ·åœ¨**æ— éœ€ä»»ä½•æŠµæŠ¼**çš„æƒ…å†µä¸‹å€Ÿå…¥èµ„äº§ï¼Œå”¯ä¸€æ¡ä»¶æ˜¯**å¿…é¡»åœ¨åŒä¸€ä¸ªäº¤æ˜“ä¸­å½’è¿˜**ã€‚

### æ ¸å¿ƒç‰¹å¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         é—ªç”µè´·çš„å››å¤§æ ¸å¿ƒç‰¹å¾                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. æ— éœ€æŠµæŠ¼ (Uncollateralized)             â”‚
â”‚    - ä¸éœ€è¦æä¾›ä»»ä½•æŠµæŠ¼å“                   â”‚
â”‚    - é™ä½èµ„é‡‘é—¨æ§›                          â”‚
â”‚                                             â”‚
â”‚ 2. åŸå­æ€§ (Atomic)                          â”‚
â”‚    - å€Ÿæ¬¾å’Œè¿˜æ¬¾åœ¨åŒä¸€äº¤æ˜“                   â”‚
â”‚    - è¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥              â”‚
â”‚                                             â”‚
â”‚ 3. å³æ—¶æ€§ (Instant)                         â”‚
â”‚    - å€Ÿæ¬¾åˆ°è¿˜æ¬¾é€šå¸¸åœ¨å‡ ç§’å†…å®Œæˆ              â”‚
â”‚    - æ— éœ€ç­‰å¾…æœŸ                             â”‚
â”‚                                             â”‚
â”‚ 4. æ— è¿çº¦é£é™© (No Default Risk)             â”‚
â”‚    - å¦‚æœæœªå½’è¿˜ï¼Œæ•´ä¸ªäº¤æ˜“å›æ»š                â”‚
â”‚    - åè®®é›¶é£é™©                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å·¥ä½œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  é—ªç”µè´·äº¤æ˜“æµç¨‹                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Transaction Start
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. è¯·æ±‚é—ªç”µè´·       â”‚  ç”¨æˆ·è°ƒç”¨ flash_loan()
â”‚     å€Ÿå…¥ 10000 USDC â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. èµ„é‡‘è½¬ç§»         â”‚  åè®®è½¬ç§» 10000 USDC ç»™ç”¨æˆ·
â”‚     Pool â†’ User     â”‚  åˆ›å»º FlashLoan (Hot Potato)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. æ‰§è¡Œç­–ç•¥         â”‚  ç”¨æˆ·æ‰§è¡Œå¥—åˆ©/æ¸…ç®—ç­‰æ“ä½œ
â”‚     (ç”¨æˆ·é€»è¾‘)       â”‚  å¿…é¡»æŒæœ‰ FlashLoan å¯¹è±¡
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. å½’è¿˜è´·æ¬¾         â”‚  ç”¨æˆ·è°ƒç”¨ repay()
â”‚     10030 USDC      â”‚  é”€æ¯ FlashLoan å¯¹è±¡
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. éªŒè¯æ£€æŸ¥         â”‚  æ£€æŸ¥æ˜¯å¦å·²å½’è¿˜è¶³é¢èµ„é‡‘
â”‚     âœ“ é‡‘é¢æ­£ç¡®      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
Transaction Success âœ…
(æˆ–å› æœªå½’è¿˜è€Œ Fail âŒ)
```

### ä¸ä¼ ç»Ÿå€Ÿè´·å¯¹æ¯”

| ç»´åº¦ | ä¼ ç»Ÿå€Ÿè´· | é—ªç”µè´· |
|------|---------|--------|
| **æŠµæŠ¼è¦æ±‚** | éœ€è¦ 120%-150% è¶…é¢æŠµæŠ¼ | å®Œå…¨æ— éœ€æŠµæŠ¼ |
| **å€Ÿæ¬¾é¢åº¦** | å—é™äºæŠµæŠ¼å“ä»·å€¼ | ä»…å—é™äºæ± å­æµåŠ¨æ€§ |
| **å€Ÿæ¬¾æ—¶é•¿** | å¤©/å‘¨/æœˆ/å¹´ | å•ä¸ªäº¤æ˜“ï¼ˆç§’çº§ï¼‰ |
| **åˆ©æ¯è®¡ç®—** | æŒ‰æ—¶é—´è®¡æ¯ï¼ˆå¹´åŒ–ï¼‰ | å›ºå®šæ‰‹ç»­è´¹ï¼ˆ0.05%-0.3%ï¼‰ |
| **è¿çº¦é£é™©** | å€Ÿæ¬¾äººå¯èƒ½è¿çº¦ | æ— è¿çº¦é£é™©ï¼ˆäº¤æ˜“å›æ»šï¼‰ |
| **æ¸…ç®—æœºåˆ¶** | éœ€è¦æ¸…ç®—äººæ¸…ç®—æŠµæŠ¼å“ | è‡ªåŠ¨å›æ»šï¼Œæ— éœ€æ¸…ç®— |
| **å‡†å…¥é—¨æ§›** | éœ€è¦æœ‰èµ„äº§ä½œä¸ºæŠµæŠ¼ | ä»»ä½•äººéƒ½å¯ä»¥ä½¿ç”¨ |
| **ä½¿ç”¨åœºæ™¯** | é•¿æœŸèµ„é‡‘éœ€æ±‚ | å¥—åˆ©ã€æ¸…ç®—ã€å†èèµ„ |

---

## 2ï¸âƒ£ Hot Potato æ¨¡å¼è¯¦è§£

### ä»€ä¹ˆæ˜¯ Hot Potatoï¼Ÿ

**Hot Potato** æ˜¯ Move è¯­è¨€ä¸­çš„ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œç”¨äºåˆ›å»º**å¿…é¡»è¢«å¤„ç†**çš„èµ„æºã€‚

```move
// Hot Potato ç¤ºä¾‹ï¼šæ²¡æœ‰ä»»ä½•èƒ½åŠ›
struct FlashLoan {
    amount: u64,        // å€Ÿæ¬¾é‡‘é¢
    fee: u64,           // åº”ä»˜æ‰‹ç»­è´¹
}
// æ³¨æ„ï¼šæ²¡æœ‰ copy, drop, store, key èƒ½åŠ›
```

### å››ç§èƒ½åŠ›ä¸é™åˆ¶

Move ä¸­çš„èµ„æºå¯ä»¥æœ‰å››ç§èƒ½åŠ›ï¼ˆAbilitiesï¼‰ï¼š

| èƒ½åŠ› | å«ä¹‰ | Hot Potato |
|------|------|-----------|
| **copy** | å¯ä»¥å¤åˆ¶ | âŒ ä¸èƒ½å¤åˆ¶ |
| **drop** | å¯ä»¥ä¸¢å¼ƒ/å¿½ç•¥ | âŒ ä¸èƒ½ä¸¢å¼ƒ |
| **store** | å¯ä»¥å­˜å‚¨åœ¨å…¨å±€çŠ¶æ€ | âŒ ä¸èƒ½å­˜å‚¨ |
| **key** | å¯ä»¥ä½œä¸ºå…¨å±€å­˜å‚¨çš„é”® | âŒ ä¸èƒ½ä½œä¸ºé”® |

**Hot Potato = é›¶èƒ½åŠ›**

```move
// âŒ ç¼–è¯‘é”™è¯¯ï¼šä¸èƒ½ä¸¢å¼ƒ
public fun bad_example(flash_loan: FlashLoan) {
    // é”™è¯¯ï¼flash_loan æ²¡æœ‰ drop èƒ½åŠ›ï¼Œä¸èƒ½å¿½ç•¥
}

// âŒ ç¼–è¯‘é”™è¯¯ï¼šä¸èƒ½å¤åˆ¶
public fun bad_example2(flash_loan: FlashLoan) {
    let copy = flash_loan; // é”™è¯¯ï¼æ²¡æœ‰ copy èƒ½åŠ›
}

// âŒ ç¼–è¯‘é”™è¯¯ï¼šä¸èƒ½å­˜å‚¨
struct Storage has key {
    flash_loan: FlashLoan  // é”™è¯¯ï¼FlashLoan æ²¡æœ‰ store èƒ½åŠ›
}

// âœ… æ­£ç¡®ï¼šå¿…é¡»æ˜¾å¼è§£æ„
public fun correct_example(flash_loan: FlashLoan) {
    let FlashLoan { amount, fee } = flash_loan;  // è§£æ„
    // ä½¿ç”¨ amount å’Œ fee
}
```

### ä¸ºä»€ä¹ˆå« "Hot Potato"ï¼Ÿ

æƒ³è±¡ä½ æ‹¿ç€ä¸€ä¸ª**çƒ«æ‰‹çš„åœŸè±†**ï¼š

```
ğŸ¥” çƒ«æ‰‹çš„åœŸè±†
  â”‚
  â”œâ”€ âŒ ä¸èƒ½æ‰”æ‰ (no drop)
  â”œâ”€ âŒ ä¸èƒ½å¤åˆ¶ä¸€ä¸ª (no copy)
  â”œâ”€ âŒ ä¸èƒ½æ”¾è¿›å†°ç®±å­˜èµ·æ¥ (no store)
  â””â”€ âœ… åªèƒ½èµ¶ç´§ä¼ ç»™ä¸‹ä¸€ä¸ªäººï¼Œæˆ–è€…"åƒæ‰"(è§£æ„)
```

**åœ¨é—ªç”µè´·ä¸­**ï¼š
- å€Ÿæ¬¾æ—¶åˆ›å»º `FlashLoan` (æ‹¿åˆ°çƒ«æ‰‹åœŸè±†)
- æ— æ³•ä¸¢å¼ƒã€å¤åˆ¶ã€å­˜å‚¨ (å¿…é¡»å¤„ç†)
- å¿…é¡»è°ƒç”¨ `repay()` å‡½æ•°æ¥"æ¶ˆè´¹"å®ƒ
- ç¼–è¯‘å™¨å¼ºåˆ¶ä¿è¯ä½ ä¸€å®šä¼šè¿˜æ¬¾

### Hot Potato çš„ç±»å‹å®‰å…¨

```move
module flash_loan::core {
    struct FlashLoan {
        amount: u64,
        fee: u64,
    }

    // å€Ÿæ¬¾ï¼šåˆ›å»º Hot Potato
    public fun flash_loan<CoinType>(
        pool: &mut Pool<CoinType>,
        amount: u64
    ): (Coin<CoinType>, FlashLoan) {
        let coins = coin::extract(&mut pool.reserves, amount);
        let flash_loan = FlashLoan {
            amount,
            fee: calculate_fee(amount, pool.fee_rate),
        };
        (coins, flash_loan)  // è¿”å›èµ„é‡‘å’Œ Hot Potato
    }

    // è¿˜æ¬¾ï¼šæ¶ˆè´¹ Hot Potato
    public fun repay<CoinType>(
        pool: &mut Pool<CoinType>,
        coins: Coin<CoinType>,
        flash_loan: FlashLoan  // æ¥æ”¶ Hot Potato
    ) {
        let FlashLoan { amount, fee } = flash_loan;  // è§£æ„ï¼ˆæ¶ˆè´¹ï¼‰
        
        // éªŒè¯é‡‘é¢
        assert!(coin::value(&coins) >= amount + fee, E_INSUFFICIENT_REPAYMENT);
        
        // å½’è¿˜
        coin::merge(&mut pool.reserves, coins);
    }
}

// ç”¨æˆ·ä½¿ç”¨
public fun arbitrage() {
    // 1. å€Ÿæ¬¾
    let (borrowed_coins, flash_loan) = flash_loan::flash_loan(&mut pool, 10000);
    
    // 2. æ‰§è¡Œå¥—åˆ©
    let profit_coins = execute_arbitrage(borrowed_coins);
    
    // 3. å¿…é¡»è¿˜æ¬¾ï¼Œå¦åˆ™ç¼–è¯‘é”™è¯¯ï¼
    flash_loan::repay(&mut pool, profit_coins, flash_loan);
    // flash_loan è¢«æ¶ˆè´¹ï¼Œä¸èƒ½å†ä½¿ç”¨
}
```

### Hot Potato çš„ç¼–è¯‘æ—¶æ£€æŸ¥

```move
// âŒ ç¤ºä¾‹ 1ï¼šå¿˜è®°è¿˜æ¬¾
public fun bad_arbitrage() {
    let (borrowed_coins, flash_loan) = flash_loan::flash_loan(&mut pool, 10000);
    
    let profit_coins = execute_arbitrage(borrowed_coins);
    
    // å¿˜è®°è¿˜æ¬¾ï¼
    // ç¼–è¯‘é”™è¯¯ï¼šflash_loan çš„å€¼æœªè¢«ä½¿ç”¨
}

// âŒ ç¤ºä¾‹ 2ï¼šæ¡ä»¶åˆ†æ”¯æœªå¤„ç†
public fun bad_conditional(condition: bool) {
    let (borrowed_coins, flash_loan) = flash_loan::flash_loan(&mut pool, 10000);
    
    if (condition) {
        flash_loan::repay(&mut pool, borrowed_coins, flash_loan);
    }
    // else åˆ†æ”¯æ²¡æœ‰å¤„ç† flash_loan
    // ç¼–è¯‘é”™è¯¯ï¼
}

// âœ… ç¤ºä¾‹ 3ï¼šæ­£ç¡®çš„æ¡ä»¶å¤„ç†
public fun good_conditional(condition: bool) {
    let (borrowed_coins, flash_loan) = flash_loan::flash_loan(&mut pool, 10000);
    
    if (condition) {
        flash_loan::repay(&mut pool, borrowed_coins, flash_loan);
    } else {
        flash_loan::repay(&mut pool, borrowed_coins, flash_loan);
    }
    // æ‰€æœ‰åˆ†æ”¯éƒ½å¤„ç†äº† flash_loan âœ…
}
```

---

## 3ï¸âƒ£ é—ªç”µè´·åè®®æ¶æ„

### æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              é—ªç”µè´·åè®®æ¶æ„                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Pool Manager   â”‚  èµ„äº§æ± ç®¡ç†
â”‚   - æµåŠ¨æ€§ç®¡ç†    â”‚
â”‚   - æ‰‹ç»­è´¹è®¾ç½®    â”‚
â”‚   - ç»Ÿè®¡æ•°æ®      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ è°ƒç”¨
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Flash Loan     â”‚  æ ¸å¿ƒå€Ÿè´·é€»è¾‘
â”‚   - å€Ÿæ¬¾æ¥å£      â”‚
â”‚   - è¿˜æ¬¾æ¥å£      â”‚
â”‚   - Hot Potato   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ å›è°ƒ
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Strategy   â”‚  ç”¨æˆ·è‡ªå®šä¹‰é€»è¾‘
â”‚   - å¥—åˆ©ç­–ç•¥      â”‚
â”‚   - æ¸…ç®—é€»è¾‘      â”‚
â”‚   - å…¶ä»–æ“ä½œ      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒæ•°æ®ç»“æ„

```move
// 1. èµ„äº§æ± 
struct Pool<phantom CoinType> has key {
    // æµåŠ¨æ€§å‚¨å¤‡
    reserves: Coin<CoinType>,
    
    // æ‰‹ç»­è´¹ç‡ï¼ˆåŸºç‚¹ï¼Œå¦‚ 30 = 0.3%ï¼‰
    fee_rate: u64,
    
    // ç»Ÿè®¡æ•°æ®
    total_flash_loans: u64,
    total_fees: u64,
    total_volume: u64,
    
    // ç®¡ç†å‘˜æƒé™
    admin: address,
    
    // æš‚åœæ ‡å¿—
    paused: bool,
}

// 2. Hot Potato
struct FlashLoan {
    amount: u64,      // å€Ÿæ¬¾æœ¬é‡‘
    fee: u64,         // åº”ä»˜æ‰‹ç»­è´¹
}

// 3. é—ªç”µè´·äº‹ä»¶
struct FlashLoanEvent has drop, store {
    user: address,
    amount: u64,
    fee: u64,
    timestamp: u64,
}
```

### æ¥å£è®¾è®¡

```move
module flash_loan::pool {
    
    // === ç®¡ç†æ¥å£ ===
    
    /// åˆå§‹åŒ–èµ„äº§æ± 
    public entry fun initialize<CoinType>(
        admin: &signer,
        initial_liquidity: u64,
        fee_rate: u64
    )
    
    /// æ·»åŠ æµåŠ¨æ€§
    public entry fun add_liquidity<CoinType>(
        provider: &signer,
        amount: u64
    )
    
    /// ç§»é™¤æµåŠ¨æ€§
    public entry fun remove_liquidity<CoinType>(
        provider: &signer,
        amount: u64
    )
    
    // === æ ¸å¿ƒå€Ÿè´·æ¥å£ ===
    
    /// é—ªç”µè´·å€Ÿæ¬¾
    /// è¿”å›ï¼š(å€Ÿå…¥çš„ä»£å¸, FlashLoan Hot Potato)
    public fun flash_loan<CoinType>(
        pool: &mut Pool<CoinType>,
        amount: u64
    ): (Coin<CoinType>, FlashLoan)
    
    /// é—ªç”µè´·è¿˜æ¬¾
    /// æ¶ˆè´¹ FlashLoan Hot Potato
    public fun repay<CoinType>(
        pool: &mut Pool<CoinType>,
        coins: Coin<CoinType>,
        flash_loan: FlashLoan
    )
    
    // === æŸ¥è¯¢æ¥å£ ===
    
    /// æŸ¥è¯¢æ± å­æµåŠ¨æ€§
    public fun get_liquidity<CoinType>(pool: &Pool<CoinType>): u64
    
    /// æŸ¥è¯¢æ‰‹ç»­è´¹ç‡
    public fun get_fee_rate<CoinType>(pool: &Pool<CoinType>): u64
    
    /// è®¡ç®—æ‰‹ç»­è´¹
    public fun calculate_fee(amount: u64, fee_rate: u64): u64
}
```

---

## 4ï¸âƒ£ åº”ç”¨åœºæ™¯æ·±åº¦åˆ†æ

### åœºæ™¯ 1: DEX å¥—åˆ©

**åŸç†**ï¼šåˆ©ç”¨ä¸åŒ DEX ä¹‹é—´çš„ä»·æ ¼å·®å¼‚èµšå–åˆ©æ¶¦

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          DEX å¥—åˆ©ç¤ºä¾‹                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åˆå§‹çŠ¶æ€ï¼š
  - Pancakeswap: 1 APT = 10 USDC
  - Liquidswap:  1 APT = 11 USDC
  - ä»·å·®: 1 USDC / APT (10%)

ç­–ç•¥æ‰§è¡Œï¼š
  1. é—ªç”µè´·å€Ÿå…¥ 10,000 USDC
     â”‚
  2. åœ¨ Pancakeswap ä¹°å…¥ APT
     â”‚  10,000 USDC â†’ 1,000 APT
     â”‚  (10,000 / 10 = 1,000)
     â”‚
  3. åœ¨ Liquidswap å–å‡º APT
     â”‚  1,000 APT â†’ 11,000 USDC
     â”‚  (1,000 * 11 = 11,000)
     â”‚
  4. å½’è¿˜é—ªç”µè´·
     â”‚  æœ¬é‡‘: 10,000 USDC
     â”‚  æ‰‹ç»­è´¹: 30 USDC (0.3%)
     â”‚  æ€»è®¡: 10,030 USDC
     â”‚
  5. è®¡ç®—åˆ©æ¶¦
     â””â”€ æ”¶å…¥: 11,000 USDC
        æ”¯å‡º: 10,030 USDC
        åˆ©æ¶¦: 970 USDC âœ…
```

**ç›ˆäºå¹³è¡¡åˆ†æ**ï¼š

è®¾ï¼š
- Pâ‚ = DEX A çš„ä»·æ ¼
- Pâ‚‚ = DEX B çš„ä»·æ ¼
- F = é—ªç”µè´·æ‰‹ç»­è´¹ç‡
- G = DEX äº¤æ˜“æ‰‹ç»­è´¹

ç›ˆåˆ©æ¡ä»¶ï¼š
```
Pâ‚‚ / Pâ‚ > (1 + F) * (1 + G)Â²
```

ç¤ºä¾‹ï¼š
- F = 0.3% = 0.003
- G = 0.3% = 0.003
- éœ€è¦: Pâ‚‚ / Pâ‚ > 1.003 * 1.006Â² â‰ˆ 1.015

å³ä»·å·®éœ€è¦å¤§äº 1.5% æ‰èƒ½ç›ˆåˆ©

### åœºæ™¯ 2: æ¸…ç®—å¥—åˆ©

**åŸç†**ï¼šæ¸…ç®—å€Ÿè´·åè®®ä¸­çš„ä¸è‰¯å€ºåŠ¡ï¼Œè·å¾—æŠ˜æ‰£æŠµæŠ¼å“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          æ¸…ç®—å¥—åˆ©ç¤ºä¾‹                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å€Ÿè´·åè®®çŠ¶æ€ï¼š
  - ç”¨æˆ· A å€Ÿäº† 50,000 USDC
  - æŠµæŠ¼äº† 10 ETH (ä»·å€¼ 60,000 USDC, 120% æŠµæŠ¼ç‡)
  - ETH ä»·æ ¼ä¸‹è·Œåˆ° 5,000 USDC
  - æŠµæŠ¼å“ä»·å€¼ = 50,000 USDC
  - å¥åº·å› å­ = 1.0 (å¯æ¸…ç®—)

æ¸…ç®—ç­–ç•¥ï¼š
  1. é—ªç”µè´·å€Ÿå…¥ 50,000 USDC
     â”‚
  2. æ¸…ç®—ç”¨æˆ· A çš„å€ºåŠ¡
     â”‚  æ”¯ä»˜: 50,000 USDC
     â”‚  è·å¾—: 10 ETH + 10% æ¸…ç®—å¥–åŠ±
     â”‚  å®å¾—: 11 ETH (ä»·å€¼ 55,000 USDC)
     â”‚
  3. å–å‡º ETH
     â”‚  11 ETH â†’ 55,000 USDC
     â”‚
  4. å½’è¿˜é—ªç”µè´·
     â”‚  æœ¬é‡‘: 50,000 USDC
     â”‚  æ‰‹ç»­è´¹: 150 USDC (0.3%)
     â”‚  æ€»è®¡: 50,150 USDC
     â”‚
  5. è®¡ç®—åˆ©æ¶¦
     â””â”€ æ”¶å…¥: 55,000 USDC
        æ”¯å‡º: 50,150 USDC
        åˆ©æ¶¦: 4,850 USDC âœ…
```

### åœºæ™¯ 3: æŠµæŠ¼å“äº’æ¢

**åŸç†**ï¼šæ— éœ€é¢å¤–èµ„é‡‘å³å¯æ›´æ¢å€Ÿè´·åè®®ä¸­çš„æŠµæŠ¼å“ç±»å‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        æŠµæŠ¼å“äº’æ¢ç¤ºä¾‹                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åˆå§‹çŠ¶æ€ï¼š
  - åœ¨åè®® A ä¸­ï¼š
    Â· æŠµæŠ¼ 10 ETH
    Â· å€Ÿå‡º 50,000 USDC
  - æƒ³è¦åˆ‡æ¢ä¸ºæŠµæŠ¼ BTC

äº’æ¢ç­–ç•¥ï¼š
  1. é—ªç”µè´·å€Ÿå…¥ 50,000 USDC
     â”‚
  2. å½’è¿˜åè®® A çš„å€ºåŠ¡
     â”‚  æ”¯ä»˜: 50,000 USDC
     â”‚  è§£é”: 10 ETH
     â”‚
  3. å–å‡º ETH ä¹°å…¥ BTC
     â”‚  10 ETH â†’ 0.2 BTC
     â”‚
  4. åœ¨åè®® A ä¸­æŠµæŠ¼ BTC å€Ÿå‡º USDC
     â”‚  æŠµæŠ¼: 0.2 BTC
     â”‚  å€Ÿå‡º: 50,150 USDC
     â”‚
  5. å½’è¿˜é—ªç”µè´·
     â””â”€ è¿˜æ¬¾: 50,150 USDC

ç»“æœï¼šæŠµæŠ¼å“ä» ETH å˜ä¸º BTCï¼Œæ— éœ€é¢å¤–èµ„é‡‘ âœ…
```

### åœºæ™¯ 4: ä¸‰è§’å¥—åˆ©

**åŸç†**ï¼šåˆ©ç”¨ä¸‰ä¸ªäº¤æ˜“å¯¹çš„ä»·æ ¼ä¸ä¸€è‡´æ€§

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ä¸‰è§’å¥—åˆ©ç¤ºä¾‹                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¸‚åœºä»·æ ¼ï¼š
  Pool A: APT/USDC = 10
  Pool B: APT/BTC  = 0.0005
  Pool C: BTC/USDC = 21,000

ç†è®ºä»·æ ¼æ£€æŸ¥ï¼š
  é€šè¿‡ B å’Œ C è®¡ç®— APT ä»·æ ¼ï¼š
  1 APT = 0.0005 BTC = 0.0005 * 21,000 = 10.5 USDC
  
  ä»·å·®ï¼šPool A ä»·æ ¼åä½ (10 < 10.5)

å¥—åˆ©è·¯å¾„ï¼š
  1. é—ªç”µè´·å€Ÿå…¥ 10,000 USDC
     â”‚
  2. Pool A: 10,000 USDC â†’ 1,000 APT
     â”‚  (10,000 / 10)
     â”‚
  3. Pool B: 1,000 APT â†’ 0.5 BTC
     â”‚  (1,000 * 0.0005)
     â”‚
  4. Pool C: 0.5 BTC â†’ 10,500 USDC
     â”‚  (0.5 * 21,000)
     â”‚
  5. å½’è¿˜é—ªç”µè´·: 10,030 USDC
     â”‚
  6. åˆ©æ¶¦: 470 USDC âœ…
```

---

## 5ï¸âƒ£ å®‰å…¨æ€§ä¸æ”»å‡»é˜²æŠ¤

### å¸¸è§æ”»å‡»å‘é‡

#### æ”»å‡» 1: é‡å…¥æ”»å‡»

**æè¿°**ï¼šåœ¨å€Ÿæ¬¾å’Œè¿˜æ¬¾ä¹‹é—´é‡å¤è°ƒç”¨é—ªç”µè´·

```move
// âŒ æœ‰æ¼æ´çš„å®ç°
public fun vulnerable_flash_loan<CoinType>(
    pool: &mut Pool<CoinType>,
    amount: u64
): Coin<CoinType> {
    let coins = coin::extract(&mut pool.reserves, amount);
    // é—®é¢˜ï¼šæ²¡æœ‰åˆ›å»º Hot Potatoï¼Œç”¨æˆ·å¯ä»¥å†æ¬¡è°ƒç”¨
    coins
}

// âœ… å®‰å…¨çš„å®ç°
public fun safe_flash_loan<CoinType>(
    pool: &mut Pool<CoinType>,
    amount: u64
): (Coin<CoinType>, FlashLoan) {
    let coins = coin::extract(&mut pool.reserves, amount);
    let flash_loan = FlashLoan { amount, fee: calc_fee(amount) };
    // Hot Potato ç¡®ä¿å¿…é¡»å½’è¿˜
    (coins, flash_loan)
}
```

**é˜²æŠ¤**ï¼šä½¿ç”¨ Hot Potato æ¨¡å¼ï¼Œç¼–è¯‘å™¨è‡ªåŠ¨é˜²æŠ¤

#### æ”»å‡» 2: ä»·æ ¼æ“çºµ

**æè¿°**ï¼šä½¿ç”¨é—ªç”µè´·æ“çºµé¢„è¨€æœºä»·æ ¼

```
æ”»å‡»æµç¨‹ï¼š
  1. é—ªç”µè´·å€Ÿå…¥å¤§é‡ Token A
  2. åœ¨ DEX ä¸­ç”¨ Token A å¤§é‡ä¹°å…¥ Token B
  3. Token B ä»·æ ¼è¢«äººä¸ºæ¨é«˜
  4. åœ¨ä½¿ç”¨è¯¥ DEX ä½œä¸ºé¢„è¨€æœºçš„åè®®ä¸­å¥—åˆ©
  5. å½’è¿˜é—ªç”µè´·

ç»“æœï¼šæ“çºµä»·æ ¼è·åˆ©ï¼Œåè®®æŸå¤±
```

**é˜²æŠ¤æ–¹æ¡ˆ**ï¼š

```move
// âŒ è„†å¼±çš„ä»·æ ¼è·å–
public fun get_price_vulnerable<X, Y>(): u64 {
    let (reserve_x, reserve_y) = dex::get_reserves<X, Y>();
    // å³æ—¶ä»·æ ¼ï¼Œå®¹æ˜“è¢«æ“çºµ
    reserve_y / reserve_x
}

// âœ… å®‰å…¨çš„ä»·æ ¼è·å–
public fun get_price_safe<X, Y>(): u64 {
    // ä½¿ç”¨æ—¶é—´åŠ æƒå¹³å‡ä»·æ ¼ (TWAP)
    oracle::get_twap<X, Y>(3600)  // 1å°æ—¶ TWAP
}

// âœ… å¤šæºä»·æ ¼èšåˆ
public fun get_price_aggregated<X, Y>(): u64 {
    let price1 = oracle_a::get_price<X, Y>();
    let price2 = oracle_b::get_price<X, Y>();
    let price3 = oracle_c::get_price<X, Y>();
    
    // å–ä¸­ä½æ•°
    median(price1, price2, price3)
}
```

#### æ”»å‡» 3: æ²»ç†æ”»å‡»

**æè¿°**ï¼šä½¿ç”¨é—ªç”µè´·æš‚æ—¶è·å¾—å¤§é‡æ²»ç†ä»£å¸ï¼Œæ“çºµæŠ•ç¥¨

```
æ”»å‡»æµç¨‹ï¼š
  1. é—ªç”µè´·å€Ÿå…¥å¤§é‡æ²»ç†ä»£å¸
  2. åœ¨ DAO ææ¡ˆä¸­æŠ•ç¥¨
  3. é€šè¿‡æ¶æ„ææ¡ˆ
  4. å½’è¿˜é—ªç”µè´·

ç»“æœï¼šä»…æŒæœ‰ä»£å¸å‡ ç§’é’Ÿå°±æ“çºµäº†æ²»ç†
```

**é˜²æŠ¤æ–¹æ¡ˆ**ï¼š

```move
// âœ… æŠ•ç¥¨æƒé‡å¿«ç…§
struct Proposal has key {
    snapshot_timestamp: u64,  // åˆ›å»ºææ¡ˆæ—¶çš„æ—¶é—´æˆ³
    // ...
}

public fun vote(voter: &signer, proposal_id: u64) {
    let voting_power = governance::get_voting_power_at(
        signer::address_of(voter),
        proposal.snapshot_timestamp  // ä½¿ç”¨å¿«ç…§æ—¶çš„æƒé‡ï¼Œè€Œéå½“å‰æƒé‡
    );
    // ...
}

// âœ… æ—¶é—´é”å®š
public fun stake_for_voting(staker: &signer, amount: u64) {
    // è¦æ±‚ä»£å¸é”å®šä¸€æ®µæ—¶é—´æ‰èƒ½è·å¾—æŠ•ç¥¨æƒ
    let unlock_time = timestamp::now_seconds() + LOCK_PERIOD;
    // ...
}
```

### å®‰å…¨æœ€ä½³å®è·µ

#### 1. ä¸å˜é‡æ£€æŸ¥

```move
public fun flash_loan<CoinType>(
    pool: &mut Pool<CoinType>,
    amount: u64
): (Coin<CoinType>, FlashLoan) {
    // è®°å½•åˆå§‹çŠ¶æ€
    let balance_before = coin::value(&pool.reserves);
    
    // æå–èµ„é‡‘
    let coins = coin::extract(&mut pool.reserves, amount);
    
    // åˆ›å»º Hot Potato
    let flash_loan = FlashLoan {
        amount,
        fee: calculate_fee(amount, pool.fee_rate),
    };
    
    // å‘å°„äº‹ä»¶
    event::emit(FlashLoanEvent {
        user: tx_context::sender(),
        amount,
        fee: flash_loan.fee,
        timestamp: timestamp::now_seconds(),
    });
    
    (coins, flash_loan)
}

public fun repay<CoinType>(
    pool: &mut Pool<CoinType>,
    coins: Coin<CoinType>,
    flash_loan: FlashLoan
) {
    let FlashLoan { amount, fee } = flash_loan;
    
    // æ£€æŸ¥å½’è¿˜é‡‘é¢
    let repay_amount = coin::value(&coins);
    assert!(repay_amount >= amount + fee, E_INSUFFICIENT_REPAYMENT);
    
    // å½’è¿˜èµ„é‡‘
    coin::merge(&mut pool.reserves, coins);
    
    // ä¸å˜é‡æ£€æŸ¥ï¼šæ± å­ä½™é¢åº”è¯¥å¢åŠ 
    let balance_after = coin::value(&pool.reserves);
    assert!(balance_after >= balance_before + fee, E_INVARIANT_VIOLATION);
    
    // æ›´æ–°ç»Ÿè®¡
    pool.total_flash_loans = pool.total_flash_loans + 1;
    pool.total_fees = pool.total_fees + fee;
}
```

#### 2. é˜²æŠ¤æ£€æŸ¥æ¸…å•

```move
module flash_loan::security_checks {
    
    // âœ… æµåŠ¨æ€§æ£€æŸ¥
    fun check_liquidity<CoinType>(
        pool: &Pool<CoinType>,
        amount: u64
    ) {
        assert!(
            coin::value(&pool.reserves) >= amount,
            E_INSUFFICIENT_LIQUIDITY
        );
    }
    
    // âœ… æš‚åœæ£€æŸ¥
    fun check_not_paused<CoinType>(pool: &Pool<CoinType>) {
        assert!(!pool.paused, E_POOL_PAUSED);
    }
    
    // âœ… é‡‘é¢åˆç†æ€§æ£€æŸ¥
    fun check_amount_reasonable(amount: u64) {
        assert!(amount > 0, E_ZERO_AMOUNT);
        assert!(amount <= MAX_FLASH_LOAN_AMOUNT, E_AMOUNT_TOO_LARGE);
    }
    
    // âœ… æ‰‹ç»­è´¹è®¡ç®—æ­£ç¡®æ€§
    fun check_fee_calculation(
        amount: u64,
        fee_rate: u64,
        expected_fee: u64
    ) {
        let calculated_fee = (amount * fee_rate) / FEE_DENOMINATOR;
        assert!(expected_fee == calculated_fee, E_INVALID_FEE);
    }
}
```

---

## 6ï¸âƒ£ æ•°å­¦æ¨¡å‹ä¸è®¡ç®—

### æ‰‹ç»­è´¹è®¡ç®—

```
æ‰‹ç»­è´¹ = å€Ÿæ¬¾é‡‘é¢ Ã— æ‰‹ç»­è´¹ç‡

Fee = Amount Ã— Rate

ç¤ºä¾‹ï¼š
  Amount = 10,000 USDC
  Rate = 0.3% = 0.003
  Fee = 10,000 Ã— 0.003 = 30 USDC
```

**åœ¨ Move ä¸­å®ç°**ï¼š

```move
const FEE_DENOMINATOR: u64 = 10000;  // åŸºç‚¹åˆ†æ¯

// 30 åŸºç‚¹ = 0.3%
const DEFAULT_FEE_RATE: u64 = 30;

public fun calculate_fee(amount: u64, fee_rate_bps: u64): u64 {
    // ä½¿ç”¨åŸºç‚¹é¿å…æµ®ç‚¹æ•°
    // fee_rate_bps = 30 è¡¨ç¤º 0.3%
    (amount * fee_rate_bps) / FEE_DENOMINATOR
}

// ç¤ºä¾‹
let fee = calculate_fee(10000, 30);  // fee = 30
```

### å¥—åˆ©ç›ˆåˆ©è®¡ç®—

**å•æ¬¡äº¤æ¢å¥—åˆ©**ï¼š

```
Profit = (Priceâ‚‚ / Priceâ‚) Ã— Amount - Amount - Fee - Gas

ç¤ºä¾‹ï¼š
  Priceâ‚ = 10 USDC/APT
  Priceâ‚‚ = 11 USDC/APT
  Amount = 10,000 USDC
  Fee = 30 USDC (0.3%)
  
  Profit = (11/10) Ã— 10,000 - 10,000 - 30
         = 11,000 - 10,000 - 30
         = 970 USDC
```

**è€ƒè™‘æ»‘ç‚¹çš„ç›ˆåˆ©è®¡ç®—**ï¼š

```
æ’å®šä¹˜ç§¯å…¬å¼ï¼šx Ã— y = k

ä¹°å…¥ä»·æ ¼ï¼ˆå«æ»‘ç‚¹ï¼‰ï¼š
  Î”y = (y Ã— Î”x) / (x + Î”x)
  
  å…¶ä¸­ï¼š
    x = æ± å­ä¸­ Token X çš„æ•°é‡
    y = æ± å­ä¸­ Token Y çš„æ•°é‡
    Î”x = ä¹°å…¥çš„ Token X æ•°é‡
    Î”y = å¾—åˆ°çš„ Token Y æ•°é‡

å®é™…ä»·æ ¼ = Î”y / Î”x
```

**ç¤ºä¾‹ä»£ç **ï¼š

```move
public fun calculate_output_amount(
    reserve_in: u64,
    reserve_out: u64,
    amount_in: u64,
    fee_rate: u64  // å¦‚ 30 = 0.3%
): u64 {
    // æ‰£é™¤æ‰‹ç»­è´¹
    let amount_in_with_fee = amount_in * (FEE_DENOMINATOR - fee_rate);
    
    // è®¡ç®—è¾“å‡ºæ•°é‡
    let numerator = amount_in_with_fee * reserve_out;
    let denominator = (reserve_in * FEE_DENOMINATOR) + amount_in_with_fee;
    
    numerator / denominator
}

// è®¡ç®—å¥—åˆ©åˆ©æ¶¦
public fun calculate_arbitrage_profit(
    amount: u64,
    reserve_a_in: u64,
    reserve_a_out: u64,
    reserve_b_in: u64,
    reserve_b_out: u64,
    flash_loan_fee: u64
): u64 {
    // åœ¨ DEX A ä¹°å…¥
    let bought = calculate_output_amount(
        reserve_a_in,
        reserve_a_out,
        amount,
        30  // DEX æ‰‹ç»­è´¹ 0.3%
    );
    
    // åœ¨ DEX B å–å‡º
    let sold = calculate_output_amount(
        reserve_b_in,
        reserve_b_out,
        bought,
        30
    );
    
    // è®¡ç®—åˆ©æ¶¦
    if (sold > amount + flash_loan_fee) {
        sold - amount - flash_loan_fee
    } else {
        0
    }
}
```

### æœ€å°å¥—åˆ©é‡‘é¢è®¡ç®—

```
MinAmount = (Fee_Flash + Fee_DEX_A + Fee_DEX_B + Gas) / (PriceDiff - TotalFeeRate)

ç¤ºä¾‹ï¼š
  Fee_Flash = 0.3%
  Fee_DEX_A = 0.3%
  Fee_DEX_B = 0.3%
  PriceDiff = 2% (DEX B ä»·æ ¼æ¯” DEX A é«˜ 2%)
  
  TotalFeeRate = 0.3% + 0.3% + 0.3% = 0.9%
  NetPriceDiff = 2% - 0.9% = 1.1%
  
  å¦‚æœå›ºå®šæˆæœ¬ï¼ˆGas ç­‰ï¼‰= 10 USDC
  MinAmount = 10 / 0.011 = 909 USDC
```

---

## ğŸ“š æ€»ç»“

### æ ¸å¿ƒè¦ç‚¹

1. **é—ªç”µè´· = æ— æŠµæŠ¼ + åŸå­æ€§ + å³æ—¶æ€§**
2. **Hot Potato = Move çš„ç±»å‹å®‰å…¨æœºåˆ¶**
3. **åº”ç”¨åœºæ™¯ = å¥—åˆ© + æ¸…ç®— + å†èèµ„**
4. **å®‰å…¨é˜²æŠ¤ = ä¸å˜é‡æ£€æŸ¥ + ä»·æ ¼èšåˆ + æ—¶é—´é”**

### ä¸‹ä¸€æ­¥

æŒæ¡æ ¸å¿ƒæ¦‚å¿µåï¼Œç»§ç»­å­¦ä¹ ï¼š
- ğŸ“„ `ä»£ç ç¤ºä¾‹.move` - å®Œæ•´å®ç°
- ğŸ”¨ `02_å®è·µä»»åŠ¡` - åŠ¨æ‰‹ç¼–ç 
- ğŸ“ `03_æ¯æ—¥è€ƒè¯•` - æ£€éªŒç†è§£

**é—ªç”µè´·æ˜¯ DeFi åˆ›æ–°çš„ä»£è¡¨ï¼Œä¹Ÿæ˜¯å¥—åˆ©æœºå™¨äººçš„æ ¸å¿ƒå·¥å…·ï¼** âš¡ğŸ’°
