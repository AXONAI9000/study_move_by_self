# Moveè¯­è¨€å‡½æ•°ä¸æ§åˆ¶æµæ ¸å¿ƒæ¦‚å¿µ

## ç¬¬ä¸€éƒ¨åˆ†ï¼šå‡½æ•°åŸºç¡€

### 1.1 ä¸ºä»€ä¹ˆéœ€è¦å‡½æ•°ï¼Ÿ

å‡½æ•°æ˜¯ç»„ç»‡ä»£ç çš„åŸºæœ¬å•å…ƒï¼Œå®ƒå¸®åŠ©æˆ‘ä»¬ï¼š
- **ä»£ç å¤ç”¨**ï¼šé¿å…é‡å¤ç¼–å†™ç›¸åŒé€»è¾‘
- **æ¨¡å—åŒ–**ï¼šå°†å¤æ‚é—®é¢˜åˆ†è§£ä¸ºå°å•å…ƒ
- **æŠ½è±¡**ï¼šéšè—å®ç°ç»†èŠ‚ï¼Œæä¾›æ¸…æ™°æ¥å£
- **æµ‹è¯•**ï¼šç‹¬ç«‹æµ‹è¯•æ¯ä¸ªåŠŸèƒ½å•å…ƒ

### 1.2 Moveå‡½æ•°çš„ç‰¹ç‚¹

1. **é™æ€ç±»å‹**ï¼šæ‰€æœ‰å‚æ•°å’Œè¿”å›å€¼éƒ½æœ‰æ˜ç¡®ç±»å‹
2. **æ— éšå¼è¿”å›**ï¼šå¿…é¡»æ˜ç¡®è¿”å›å€¼ï¼ˆæˆ–ä½¿ç”¨è¡¨è¾¾å¼ï¼‰
3. **æ— å‡½æ•°é‡è½½**ï¼šä¸æ”¯æŒåŒåä¸åŒå‚æ•°çš„å‡½æ•°
4. **æ— é»˜è®¤å‚æ•°**ï¼šæ‰€æœ‰å‚æ•°å¿…é¡»ä¼ é€’
5. **å¯è§æ€§æ§åˆ¶**ï¼šç²¾ç»†çš„è®¿é—®æ§åˆ¶æœºåˆ¶

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šå‡½æ•°å®šä¹‰ä¸è¯­æ³•

### 2.1 åŸºæœ¬è¯­æ³•

```move
fun function_name(param1: Type1, param2: Type2): ReturnType {
    // å‡½æ•°ä½“
    return_value
}
```

#### å…³é”®è¦ç´ 

| å…ƒç´  | è¯´æ˜ | æ˜¯å¦å¿…éœ€ |
|------|------|---------|
| `fun` | å‡½æ•°å…³é”®å­— | å¿…éœ€ |
| å‡½æ•°å | éµå¾ªsnake_caseå‘½å | å¿…éœ€ |
| å‚æ•°åˆ—è¡¨ | `(name: type, ...)` | å¯é€‰ |
| è¿”å›ç±»å‹ | `: ReturnType` | å¯é€‰ï¼ˆæ— è¿”å›å€¼å¯çœç•¥ï¼‰|
| å‡½æ•°ä½“ | `{ ... }` | å¿…éœ€ |

### 2.2 ç®€å•å‡½æ•°ç¤ºä¾‹

```move
module my_addr::examples {
    // æ— å‚æ•°ã€æ— è¿”å›å€¼
    public fun hello() {
        // åªæ‰§è¡Œæ“ä½œï¼Œä¸è¿”å›ä»»ä½•å€¼
    }
    
    // æœ‰å‚æ•°ã€æœ‰è¿”å›å€¼
    public fun add(a: u64, b: u64): u64 {
        a + b  // æœ€åä¸€ä¸ªè¡¨è¾¾å¼ä½œä¸ºè¿”å›å€¼
    }
    
    // å¤šä¸ªå‚æ•°å’Œè¿”å›å€¼
    public fun swap(a: u64, b: u64): (u64, u64) {
        (b, a)  // è¿”å›å…ƒç»„
    }
    
    // ä½¿ç”¨returnå…³é”®å­—
    public fun max(a: u64, b: u64): u64 {
        if (a > b) {
            return a
        };
        b
    }
}
```

### 2.3 å‚æ•°ä¼ é€’

Moveä¸­çš„å‚æ•°ä¼ é€’æœ‰ä¸‰ç§æ–¹å¼ï¼š

#### (1) æŒ‰å€¼ä¼ é€’ï¼ˆCopyç±»å‹ï¼‰

```move
public fun by_value(x: u64): u64 {
    x + 1  // xæ˜¯å‰¯æœ¬ï¼Œä¸å½±å“åŸå€¼
}

// ä½¿ç”¨
let a = 10;
let b = by_value(a);  // aä»ç„¶æ˜¯10ï¼Œbæ˜¯11
```

#### (2) ä¸å¯å˜å¼•ç”¨ï¼ˆ`&T`ï¼‰

```move
public fun by_immutable_ref(x: &u64): u64 {
    *x + 1  // åªèƒ½è¯»å–ï¼Œä¸èƒ½ä¿®æ”¹
}

// ä½¿ç”¨
let a = 10;
let b = by_immutable_ref(&a);  // ä¼ é€’å¼•ç”¨
```

#### (3) å¯å˜å¼•ç”¨ï¼ˆ`&mut T`ï¼‰

```move
public fun by_mutable_ref(x: &mut u64) {
    *x = *x + 1;  // å¯ä»¥ä¿®æ”¹åŸå€¼
}

// ä½¿ç”¨
let mut a = 10;
by_mutable_ref(&mut a);  // aç°åœ¨æ˜¯11
```

### 2.4 è¿”å›å€¼

Moveæ”¯æŒä¸‰ç§è¿”å›æ–¹å¼ï¼š

#### (1) è¡¨è¾¾å¼è¿”å›ï¼ˆæ¨èï¼‰

```move
public fun add(a: u64, b: u64): u64 {
    a + b  // æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼è‡ªåŠ¨è¿”å›ï¼ˆæ— åˆ†å·ï¼‰
}
```

#### (2) æ˜¾å¼return

```move
public fun max(a: u64, b: u64): u64 {
    if (a > b) {
        return a  // æå‰è¿”å›
    };
    b
}
```

#### (3) è¿”å›å¤šä¸ªå€¼ï¼ˆå…ƒç»„ï¼‰

```move
public fun divide_with_remainder(a: u64, b: u64): (u64, u64) {
    let quotient = a / b;
    let remainder = a % b;
    (quotient, remainder)  // è¿”å›å…ƒç»„
}

// ä½¿ç”¨
let (q, r) = divide_with_remainder(10, 3);  // q=3, r=1
```

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šå‡½æ•°å¯è§æ€§

### 3.1 å¯è§æ€§ä¿®é¥°ç¬¦

Moveæä¾›å››ç§å¯è§æ€§çº§åˆ«ï¼š

| ä¿®é¥°ç¬¦ | å¯è§èŒƒå›´ | ä½¿ç”¨åœºæ™¯ |
|--------|---------|---------|
| ï¼ˆæ— ä¿®é¥°ç¬¦ï¼‰ | å½“å‰æ¨¡å—å†… | å†…éƒ¨è¾…åŠ©å‡½æ•° |
| `public` | æ‰€æœ‰æ¨¡å— | å…¬å¼€API |
| `public(friend)` | å‹å…ƒæ¨¡å— | å—é™å…±äº« |
| `public entry` | å¤–éƒ¨è°ƒç”¨ | äº¤æ˜“å…¥å£ |

### 3.2 ç§æœ‰å‡½æ•°ï¼ˆé»˜è®¤ï¼‰

```move
module my_addr::example {
    // ç§æœ‰å‡½æ•°ï¼šåªèƒ½åœ¨æœ¬æ¨¡å—å†…è°ƒç”¨
    fun internal_helper(): u64 {
        42
    }
    
    public fun public_api(): u64 {
        internal_helper()  // âœ… å¯ä»¥è°ƒç”¨
    }
}

// å…¶ä»–æ¨¡å—
module other_addr::other {
    use my_addr::example;
    
    public fun test() {
        // example::internal_helper();  // âŒ ç¼–è¯‘é”™è¯¯
        example::public_api();  // âœ… å¯ä»¥è°ƒç”¨
    }
}
```

### 3.3 å…¬å¼€å‡½æ•°ï¼ˆpublicï¼‰

```move
module my_addr::math {
    // ä»»ä½•æ¨¡å—éƒ½å¯ä»¥è°ƒç”¨
    public fun add(a: u64, b: u64): u64 {
        a + b
    }
}

// ä»»ä½•æ¨¡å—éƒ½å¯ä»¥ä½¿ç”¨
module other::client {
    use my_addr::math;
    
    public fun test() {
        let result = math::add(1, 2);  // âœ…
    }
}
```

### 3.4 å‹å…ƒå‡½æ•°ï¼ˆpublic(friend)ï¼‰

```move
module my_addr::bank {
    friend my_addr::admin;  // å£°æ˜å‹å…ƒæ¨¡å—
    
    // åªæœ‰å‹å…ƒæ¨¡å—å¯ä»¥è°ƒç”¨
    public(friend) fun mint_coins(amount: u64): u64 {
        amount
    }
}

// å‹å…ƒæ¨¡å—
module my_addr::admin {
    use my_addr::bank;
    
    public fun create_coins() {
        bank::mint_coins(1000);  // âœ… å‹å…ƒå¯ä»¥è°ƒç”¨
    }
}

// éå‹å…ƒæ¨¡å—
module other::hacker {
    use my_addr::bank;
    
    public fun steal() {
        // bank::mint_coins(1000);  // âŒ ç¼–è¯‘é”™è¯¯
    }
}
```

### 3.5 å…¥å£å‡½æ•°ï¼ˆpublic entryï¼‰

```move
module my_addr::game {
    use std::signer;
    
    // å¯ä»¥ä½œä¸ºäº¤æ˜“å…¥å£ç‚¹
    public entry fun start_game(player: &signer) {
        let addr = signer::address_of(player);
        // åˆå§‹åŒ–æ¸¸æˆ...
    }
    
    // æ™®é€šå…¬å¼€å‡½æ•°ï¼Œä¸èƒ½ä½œä¸ºäº¤æ˜“å…¥å£
    public fun get_score(): u64 {
        100
    }
}

// ç”¨æˆ·å¯ä»¥é€šè¿‡CLIè°ƒç”¨ï¼š
// aptos move run --function-id '0x1::game::start_game'
```

---

## ç¬¬å››éƒ¨åˆ†ï¼šæ¡ä»¶æ§åˆ¶

### 4.1 ifè¡¨è¾¾å¼

Moveä¸­çš„`if`æ˜¯**è¡¨è¾¾å¼**ï¼Œä¸æ˜¯è¯­å¥ï¼Œå› æ­¤å®ƒæœ‰è¿”å›å€¼ã€‚

#### åŸºæœ¬è¯­æ³•

```move
if (condition) {
    // trueåˆ†æ”¯
} else {
    // falseåˆ†æ”¯
}
```

#### ç®€å•ç¤ºä¾‹

```move
public fun max(a: u64, b: u64): u64 {
    if (a > b) {
        a
    } else {
        b
    }
}

// ifè¡¨è¾¾å¼çš„å€¼å¯ä»¥èµ‹å€¼ç»™å˜é‡
public fun abs_diff(a: u64, b: u64): u64 {
    let diff = if (a > b) {
        a - b
    } else {
        b - a
    };
    diff
}
```

### 4.2 if-else if-elseé“¾

```move
public fun grade(score: u64): u8 {
    if (score >= 90) {
        1  // A
    } else if (score >= 80) {
        2  // B
    } else if (score >= 70) {
        3  // C
    } else if (score >= 60) {
        4  // D
    } else {
        5  // F
    }
}
```

### 4.3 æ— elseåˆ†æ”¯çš„if

```move
// âŒ é”™è¯¯ï¼šifè¡¨è¾¾å¼å¿…é¡»æœ‰elseï¼ˆé™¤éåœ¨è¯­å¥ä½ç½®ï¼‰
public fun wrong(): u64 {
    let x = if (true) { 10 };  // ç¼–è¯‘é”™è¯¯
    x
}

// âœ… æ­£ç¡®ï¼šifä½œä¸ºè¯­å¥ä½¿ç”¨
public fun correct() {
    let mut x = 0;
    if (true) {
        x = 10;  // è¿™é‡Œifæ˜¯è¯­å¥ï¼Œä¸éœ€è¦else
    };
}
```

### 4.4 æ¡ä»¶è¡¨è¾¾å¼çš„ç±»å‹ä¸€è‡´æ€§

```move
// âŒ é”™è¯¯ï¼šä¸¤ä¸ªåˆ†æ”¯ç±»å‹ä¸ä¸€è‡´
public fun wrong(flag: bool): u64 {
    if (flag) {
        10u64
    } else {
        true  // é”™è¯¯ï¼šboolç±»å‹
    }
}

// âœ… æ­£ç¡®ï¼šä¸¤ä¸ªåˆ†æ”¯ç±»å‹ç›¸åŒ
public fun correct(flag: bool): u64 {
    if (flag) {
        10
    } else {
        20
    }
}
```

---

## ç¬¬äº”éƒ¨åˆ†ï¼šå¾ªç¯ç»“æ„

### 5.1 whileå¾ªç¯

#### åŸºæœ¬è¯­æ³•

```move
while (condition) {
    // å¾ªç¯ä½“
}
```

#### ç¤ºä¾‹ï¼šè®¡æ•°å¾ªç¯

```move
public fun count_to_ten(): u64 {
    let mut i = 0;
    let mut sum = 0;
    
    while (i < 10) {
        sum = sum + i;
        i = i + 1;
    };
    
    sum  // è¿”å›0+1+2+...+9 = 45
}
```

#### ç¤ºä¾‹ï¼šæ¡ä»¶å¾ªç¯

```move
public fun find_power_of_two(n: u64): u64 {
    let mut power = 1;
    
    while (power < n) {
        power = power * 2;
    };
    
    power
}
```

### 5.2 loopæ— é™å¾ªç¯

`loop`ç”¨äºåˆ›å»ºæ— é™å¾ªç¯ï¼Œå¿…é¡»ä½¿ç”¨`break`è·³å‡ºã€‚

```move
public fun find_divisor(n: u64): u64 {
    let mut i = 2;
    
    loop {
        if (i * i > n) {
            break  // è·³å‡ºå¾ªç¯
        };
        
        if (n % i == 0) {
            return i  // æ‰¾åˆ°å› æ•°ï¼Œç›´æ¥è¿”å›
        };
        
        i = i + 1;
    };
    
    n  // è´¨æ•°
}
```

### 5.3 breakå’Œcontinue

#### breakï¼šè·³å‡ºå¾ªç¯

```move
public fun first_even(start: u64): u64 {
    let mut i = start;
    
    loop {
        if (i % 2 == 0) {
            break  // æ‰¾åˆ°å¶æ•°ï¼Œè·³å‡º
        };
        i = i + 1;
    };
    
    i
}
```

#### continueï¼šè·³è¿‡æœ¬æ¬¡å¾ªç¯

```move
public fun sum_odd_numbers(n: u64): u64 {
    let mut i = 0;
    let mut sum = 0;
    
    while (i < n) {
        i = i + 1;
        
        if (i % 2 == 0) {
            continue  // å¶æ•°è·³è¿‡
        };
        
        sum = sum + i;
    };
    
    sum
}
```

### 5.4 åµŒå¥—å¾ªç¯

```move
public fun multiplication_table(): vector<vector<u64>> {
    use std::vector;
    
    let mut table = vector::empty();
    let mut i = 1;
    
    while (i <= 9) {
        let mut row = vector::empty();
        let mut j = 1;
        
        while (j <= 9) {
            vector::push_back(&mut row, i * j);
            j = j + 1;
        };
        
        vector::push_back(&mut table, row);
        i = i + 1;
    };
    
    table
}
```

---

## ç¬¬å…­éƒ¨åˆ†ï¼šæå‰é€€å‡º

### 6.1 returnè¯­å¥

`return`ç”¨äºæå‰é€€å‡ºå‡½æ•°ï¼š

```move
public fun check_positive(x: u64): bool {
    if (x == 0) {
        return false  // æå‰è¿”å›
    };
    
    // å…¶ä»–å¤„ç†...
    true
}

public fun find_in_range(start: u64, end: u64, target: u64): bool {
    let mut i = start;
    
    while (i <= end) {
        if (i == target) {
            return true  // æ‰¾åˆ°ç›®æ ‡ï¼Œç«‹å³è¿”å›
        };
        i = i + 1;
    };
    
    false  // æœªæ‰¾åˆ°
}
```

### 6.2 abortç»ˆæ­¢æ‰§è¡Œ

`abort`ç”¨äºé”™è¯¯æƒ…å†µï¼Œä¼šç»ˆæ­¢æ•´ä¸ªäº¤æ˜“ï¼š

```move
public fun divide(a: u64, b: u64): u64 {
    if (b == 0) {
        abort 1  // é”™è¯¯ç 1ï¼šé™¤é›¶é”™è¯¯
    };
    a / b
}

// ä½¿ç”¨å¸¸é‡å®šä¹‰é”™è¯¯ç ï¼ˆæ¨èï¼‰
const E_DIVISION_BY_ZERO: u64 = 1;
const E_OVERFLOW: u64 = 2;

public fun safe_divide(a: u64, b: u64): u64 {
    if (b == 0) {
        abort E_DIVISION_BY_ZERO
    };
    a / b
}
```

### 6.3 assertå®

`assert!`æ˜¯æœ€å¸¸ç”¨çš„é”™è¯¯æ£€æŸ¥æ–¹å¼ï¼š

```move
public fun transfer(from: u64, to: u64, amount: u64): (u64, u64) {
    assert!(amount <= from, 1);  // ä½™é¢æ£€æŸ¥
    
    (from - amount, to + amount)
}

// ä½¿ç”¨å‘½åé”™è¯¯ç 
const E_INSUFFICIENT_BALANCE: u64 = 1;

public fun withdraw(balance: u64, amount: u64): u64 {
    assert!(balance >= amount, E_INSUFFICIENT_BALANCE);
    balance - amount
}
```

---

## ç¬¬ä¸ƒéƒ¨åˆ†ï¼šè¡¨è¾¾å¼vsè¯­å¥

### 7.1 ç†è§£è¡¨è¾¾å¼

Moveæ˜¯**é¢å‘è¡¨è¾¾å¼**çš„è¯­è¨€ï¼Œå¤§éƒ¨åˆ†ç»“æ„éƒ½æ˜¯è¡¨è¾¾å¼ã€‚

#### è¡¨è¾¾å¼æœ‰å€¼

```move
// ç®—æœ¯è¡¨è¾¾å¼
let x = 1 + 2;  // è¡¨è¾¾å¼çš„å€¼æ˜¯3

// ifè¡¨è¾¾å¼
let max = if (a > b) { a } else { b };  // è¡¨è¾¾å¼çš„å€¼æ˜¯aæˆ–b

// blockè¡¨è¾¾å¼
let result = {
    let x = 10;
    let y = 20;
    x + y  // blockçš„å€¼æ˜¯æœ€åä¸€ä¸ªè¡¨è¾¾å¼
};  // result = 30
```

#### è¯­å¥æ— å€¼

```move
// letè¯­å¥
let x = 10;  // è¿™æ˜¯è¯­å¥ï¼Œæ— è¿”å›å€¼

// èµ‹å€¼è¯­å¥
x = 20;  // è¿™æ˜¯è¯­å¥ï¼Œæ— è¿”å›å€¼

// å‡½æ•°è°ƒç”¨åŠ åˆ†å·å˜æˆè¯­å¥
my_function();  // è¯­å¥
```

### 7.2 åˆ†å·çš„ä½œç”¨

åˆ†å·å°†è¡¨è¾¾å¼è½¬æ¢ä¸ºè¯­å¥ï¼š

```move
public fun example(): u64 {
    let x = {
        10  // æ— åˆ†å·ï¼Œè¿™æ˜¯è¡¨è¾¾å¼ï¼Œblockçš„å€¼æ˜¯10
    };
    
    let y = {
        10;  // æœ‰åˆ†å·ï¼Œè¿™æ˜¯è¯­å¥ï¼Œblockçš„å€¼æ˜¯()
        20   // blockçš„å€¼æ˜¯20
    };
    
    x + y  // 10 + 20 = 30
}
```

### 7.3 Unitç±»å‹ `()`

`()`è¡¨ç¤º"æ— å€¼"ï¼Œç›¸å½“äºå…¶ä»–è¯­è¨€çš„`void`ï¼š

```move
// æ— è¿”å›å€¼çš„å‡½æ•°è¿”å›()
public fun print_hello() {
    // éšå¼è¿”å›()
}

// ç­‰ä»·äº
public fun print_hello(): () {
    ()
}

// è¯­å¥æ±‚å€¼ä¸º()
public fun statements() {
    let x = 10;  // letè¯­å¥æ±‚å€¼ä¸º()
    x = 20;      // èµ‹å€¼è¯­å¥æ±‚å€¼ä¸º()
}
```

---

## ç¬¬å…«éƒ¨åˆ†ï¼šä½œç”¨åŸŸ

### 8.1 å—ä½œç”¨åŸŸ

å¤§æ‹¬å·`{}`åˆ›å»ºæ–°ä½œç”¨åŸŸï¼š

```move
public fun scope_example() {
    let x = 10;
    
    {
        let x = 20;  // æ–°ä½œç”¨åŸŸä¸­çš„xé®è”½å¤–å±‚x
        // è¿™é‡Œxæ˜¯20
    };
    
    // è¿™é‡Œxæ˜¯10
}
```

### 8.2 å˜é‡é®è”½ï¼ˆShadowingï¼‰

å¯ä»¥åœ¨åŒä¸€ä½œç”¨åŸŸé‡æ–°å£°æ˜åŒåå˜é‡ï¼š

```move
public fun shadowing() {
    let x = 10;
    let x = x + 1;  // é®è”½ä¹‹å‰çš„xï¼Œæ–°x = 11
    let x = x * 2;  // å†æ¬¡é®è”½ï¼Œæ–°x = 22
}

// å¯ä»¥æ”¹å˜ç±»å‹
public fun type_change() {
    let x = 10u64;
    let x = true;  // âœ… é®è”½ï¼Œç±»å‹æ”¹å˜
}
```

### 8.3 å˜é‡ç”Ÿå‘½å‘¨æœŸ

å˜é‡åœ¨ä½œç”¨åŸŸç»“æŸæ—¶é”€æ¯ï¼š

```move
public fun lifetime() {
    {
        let x = 10;
        // xåœ¨è¿™é‡Œæœ‰æ•ˆ
    };  // xåœ¨è¿™é‡Œè¢«é”€æ¯
    
    // xåœ¨è¿™é‡Œä¸å¯è®¿é—®
}
```

---

## ç¬¬ä¹éƒ¨åˆ†ï¼šæœ€ä½³å®è·µ

### 9.1 å‡½æ•°è®¾è®¡åŸåˆ™

#### (1) å•ä¸€èŒè´£

```move
// âŒ ä¸å¥½ï¼šå‡½æ•°åšå¤ªå¤šäº‹
public fun process_user(user: &signer, amount: u64) {
    // éªŒè¯ç”¨æˆ·
    // è½¬è´¦
    // è®°å½•æ—¥å¿—
    // æ›´æ–°çŠ¶æ€
}

// âœ… å¥½ï¼šæ¯ä¸ªå‡½æ•°åšä¸€ä»¶äº‹
public fun validate_user(user: &signer): bool { /* ... */ }
public fun transfer(from: address, to: address, amount: u64) { /* ... */ }
public fun log_transaction(tx_id: u64) { /* ... */ }
```

#### (2) å‚æ•°ä¸å®œè¿‡å¤š

```move
// âŒ ä¸å¥½ï¼šå¤ªå¤šå‚æ•°
public fun create_user(
    name: vector<u8>,
    age: u8,
    email: vector<u8>,
    phone: vector<u8>,
    address: vector<u8>,
    country: vector<u8>
) { /* ... */ }

// âœ… å¥½ï¼šä½¿ç”¨ç»“æ„ä½“
struct UserInfo has copy, drop {
    name: vector<u8>,
    age: u8,
    email: vector<u8>,
    phone: vector<u8>,
    address: vector<u8>,
    country: vector<u8>,
}

public fun create_user(info: UserInfo) { /* ... */ }
```

### 9.2 æ§åˆ¶æµæœ€ä½³å®è·µ

#### (1) å°½æ—©è¿”å›

```move
// âŒ ä¸å¥½ï¼šåµŒå¥—è¿‡æ·±
public fun process(x: u64): u64 {
    if (x > 0) {
        if (x < 100) {
            if (x % 2 == 0) {
                return x * 2
            } else {
                return x
            }
        } else {
            return 100
        }
    } else {
        return 0
    }
}

// âœ… å¥½ï¼šå°½æ—©è¿”å›
public fun process(x: u64): u64 {
    if (x == 0) return 0;
    if (x >= 100) return 100;
    if (x % 2 == 0) return x * 2;
    x
}
```

#### (2) é¿å…æ·±å±‚åµŒå¥—

```move
// âŒ ä¸å¥½
public fun complex_logic(a: bool, b: bool, c: bool): u64 {
    if (a) {
        if (b) {
            if (c) {
                return 1
            } else {
                return 2
            }
        } else {
            return 3
        }
    } else {
        return 4
    }
}

// âœ… å¥½
public fun complex_logic(a: bool, b: bool, c: bool): u64 {
    if (!a) return 4;
    if (!b) return 3;
    if (c) return 1;
    2
}
```

### 9.3 é”™è¯¯å¤„ç†

#### (1) ä½¿ç”¨å‘½åé”™è¯¯ç 

```move
// âœ… å¥½çš„åšæ³•
const E_INSUFFICIENT_BALANCE: u64 = 1;
const E_INVALID_AMOUNT: u64 = 2;
const E_ACCOUNT_NOT_FOUND: u64 = 3;

public fun withdraw(balance: u64, amount: u64): u64 {
    assert!(amount > 0, E_INVALID_AMOUNT);
    assert!(balance >= amount, E_INSUFFICIENT_BALANCE);
    balance - amount
}
```

#### (2) é”™è¯¯ç æ–‡æ¡£åŒ–

```move
/// é”™è¯¯ç è¯´æ˜ï¼š
/// - E_INSUFFICIENT_BALANCE (1): ä½™é¢ä¸è¶³
/// - E_INVALID_AMOUNT (2): æ— æ•ˆé‡‘é¢ï¼ˆå¿…é¡»>0ï¼‰
/// - E_ACCOUNT_NOT_FOUND (3): è´¦æˆ·ä¸å­˜åœ¨
module my_addr::bank {
    const E_INSUFFICIENT_BALANCE: u64 = 1;
    const E_INVALID_AMOUNT: u64 = 2;
    const E_ACCOUNT_NOT_FOUND: u64 = 3;
    
    // ...
}
```

---

## ç¬¬åéƒ¨åˆ†ï¼šå¸¸è§æ¨¡å¼

### 10.1 å®ˆå«æ¨¡å¼ï¼ˆGuard Patternï¼‰

```move
public fun transfer(from: &signer, to: address, amount: u64) {
    // æ‰€æœ‰å‰ç½®æ¡ä»¶æ£€æŸ¥
    assert!(amount > 0, E_INVALID_AMOUNT);
    assert!(from_balance >= amount, E_INSUFFICIENT_BALANCE);
    assert!(exists<Account>(to), E_ACCOUNT_NOT_FOUND);
    
    // æ‰§è¡Œæ ¸å¿ƒé€»è¾‘
    // ...
}
```

### 10.2 ç´¯åŠ å™¨æ¨¡å¼

```move
public fun sum_range(start: u64, end: u64): u64 {
    let mut sum = 0;
    let mut i = start;
    
    while (i <= end) {
        sum = sum + i;
        i = i + 1;
    };
    
    sum
}
```

### 10.3 æœç´¢æ¨¡å¼

```move
public fun find_first_match(vec: &vector<u64>, target: u64): Option<u64> {
    use std::vector;
    use std::option::{Self, Option};
    
    let len = vector::length(vec);
    let mut i = 0;
    
    while (i < len) {
        if (*vector::borrow(vec, i) == target) {
            return option::some(i)
        };
        i = i + 1;
    };
    
    option::none()
}
```

### 10.4 è½¬æ¢æ¨¡å¼

```move
public fun map_add_one(vec: &vector<u64>): vector<u64> {
    use std::vector;
    
    let len = vector::length(vec);
    let mut result = vector::empty();
    let mut i = 0;
    
    while (i < len) {
        let value = *vector::borrow(vec, i);
        vector::push_back(&mut result, value + 1);
        i = i + 1;
    };
    
    result
}
```

---

## æ€»ç»“

### æ ¸å¿ƒè¦ç‚¹

1. **å‡½æ•°æ˜¯åŸºæœ¬ç»„ç»‡å•å…ƒ**
   - æ˜ç¡®çš„ç±»å‹ç­¾å
   - çµæ´»çš„å¯è§æ€§æ§åˆ¶
   - æ”¯æŒå¤šè¿”å›å€¼

2. **æ§åˆ¶æµæ˜¯è¡¨è¾¾å¼**
   - `if`æœ‰è¿”å›å€¼
   - ç±»å‹å¿…é¡»ä¸€è‡´
   - å–„ç”¨è¡¨è¾¾å¼ç‰¹æ€§

3. **å¾ªç¯ç®€å•é«˜æ•ˆ**
   - `while`ç”¨äºæ¡ä»¶å¾ªç¯
   - `loop`ç”¨äºæ— é™å¾ªç¯
   - `break`/`continue`æ§åˆ¶æµç¨‹

4. **é”™è¯¯å¤„ç†æ˜ç¡®**
   - `assert!`æ£€æŸ¥å‰ç½®æ¡ä»¶
   - `abort`ç»ˆæ­¢æ‰§è¡Œ
   - ä½¿ç”¨å‘½åé”™è¯¯ç 

5. **ä»£ç ç»„ç»‡æ¸…æ™°**
   - å•ä¸€èŒè´£åŸåˆ™
   - å°½æ—©è¿”å›
   - é¿å…æ·±å±‚åµŒå¥—

### ä¸‹ä¸€æ­¥

æŒæ¡äº†å‡½æ•°å’Œæ§åˆ¶æµåï¼Œæˆ‘ä»¬å°†å­¦ä¹ ï¼š
- Day 04ï¼šç»“æ„ä½“ä¸èµ„æºæ¦‚å¿µ
- Day 05ï¼šæ¨¡å—ç³»ç»Ÿä¸å¯è§æ€§
- Day 06ï¼šæ³›å‹ç¼–ç¨‹ä¸èƒ½åŠ›ç³»ç»Ÿ

ç»§ç»­åŠ æ²¹ï¼ğŸ’ª
