# Day 27 æ¯æ—¥è€ƒè¯• - ç­”æ¡ˆè§£æ

## é€‰æ‹©é¢˜ç­”æ¡ˆï¼ˆ40åˆ†ï¼‰

### ç­”æ¡ˆé€ŸæŸ¥è¡¨

```
1.  [B]    11. [B]
2.  [A]    12. [B]
3.  [B]    13. [B]
4.  [C]    14. [D]
5.  [C]    15. [C]
6.  [C]    16. [A]
7.  [C]    17. [C]
8.  [B]    18. [B]
9.  [C]    19. [B]
10. [B]    20. [C]
```

### è¯¦ç»†è§£æ

#### ç¬¬ä¸€éƒ¨åˆ†ï¼šäº¤æ˜“åŸºç¡€

**1. ç­”æ¡ˆï¼šB**
- sequence_number çš„ä¸»è¦ä½œç”¨æ˜¯é˜²æ­¢é‡æ”¾æ”»å‡»å’Œç¡®ä¿äº¤æ˜“é¡ºåº
- æ¯ä¸ªè´¦æˆ·çš„ sequence_number ä» 0 å¼€å§‹ï¼Œæ¯æ¬¡äº¤æ˜“é€’å¢
- ä¸ç”¨äºä¼˜å…ˆçº§ã€å“ˆå¸Œæˆ–è´¹ç”¨è®¡ç®—

**2. ç­”æ¡ˆï¼šA**
- expiration_timestamp_secs å¿…é¡»æ˜¯æœªæ¥çš„æ—¶é—´ç‚¹
- äº¤æ˜“ä¼šåœ¨è¿‡æœŸæ—¶é—´åè¢«æ‹’ç»
- è¿™é˜²æ­¢äº¤æ˜“æ°¸ä¹…åœç•™åœ¨ Mempool ä¸­

**3. ç­”æ¡ˆï¼šB**
- Aptos ä¸»ç½‘ chain_id = 1
- æµ‹è¯•ç½‘ = 2ï¼Œå¼€å‘ç½‘ = 4

**4. ç­”æ¡ˆï¼šC**
- æœ€å¤§è´¹ç”¨ = max_gas_amount Ã— gas_unit_price
- ä¾‹å¦‚ï¼š100,000 gas units Ã— 100 Octas = 10,000,000 Octas

**5. ç­”æ¡ˆï¼šC**
- Aptos ä½¿ç”¨ BFT å…±è¯†ï¼Œä¸æ˜¯ PoWï¼Œæ‰€ä»¥æ²¡æœ‰"æŒ–çŸ¿"é˜¶æ®µ
- æ­£ç¡®çš„é˜¶æ®µï¼šæ„é€ ã€ç­¾åã€æäº¤ã€éªŒè¯ã€æ‰§è¡Œã€ç¡®è®¤

**6. ç­”æ¡ˆï¼šC**
- sequence_number ä¸èƒ½è·³è¿‡ï¼Œå¿…é¡»è¿ç»­
- å¦‚æœå½“å‰æ˜¯ 3ï¼Œä¸‹ä¸€ä¸ªå¿…é¡»æ˜¯ 4ï¼Œä¸èƒ½æ˜¯ 5

**7. ç­”æ¡ˆï¼šC**
- 1 APT = 100,000,000 Octas (10^8)
- ç±»ä¼¼äº 1 ETH = 10^18 Wei

---

#### ç¬¬äºŒéƒ¨åˆ†ï¼šPayload ç±»å‹

**8. ç­”æ¡ˆï¼šB**
- EntryFunction æ˜¯æœ€å¸¸ç”¨çš„ Payload ç±»å‹
- ç”¨äºè°ƒç”¨å·²éƒ¨ç½²æ¨¡å—çš„ public entry å‡½æ•°

**9. ç­”æ¡ˆï¼šC**
- EntryFunction åŒ…å«å®Œæ•´ä¿¡æ¯ï¼š
  - module: ModuleId (åœ°å€ + åç§°)
  - function: å‡½æ•°å
  - ty_args: ç±»å‹å‚æ•°
  - args: å‡½æ•°å‚æ•°

**10. ç­”æ¡ˆï¼šB**
- Script çš„ gas æˆæœ¬æ›´é«˜ï¼Œå› ä¸ºæ¯æ¬¡äº¤æ˜“éƒ½åŒ…å«å­—èŠ‚ç 
- EntryFunction åªå¼•ç”¨å·²éƒ¨ç½²çš„ä»£ç ï¼Œæ›´é«˜æ•ˆ
- Script ä¸æ¨èç”¨äºå¸¸è§„æ“ä½œ

**11. ç­”æ¡ˆï¼šB**
- Multisig éœ€è¦è¾¾åˆ°è®¾å®šçš„é˜ˆå€¼ï¼ˆthresholdï¼‰
- ä¾‹å¦‚ï¼š3-of-5 å¤šç­¾éœ€è¦è‡³å°‘ 3 ä¸ªç­¾å

**12. ç­”æ¡ˆï¼šB**
- ty_args ç”¨äºæŒ‡å®šæ³›å‹ç±»å‹å‚æ•°
- ä¾‹å¦‚ï¼š`transfer<AptosCoin>` ä¸­çš„ `AptosCoin`

---

#### ç¬¬ä¸‰éƒ¨åˆ†ï¼šäº‹ä»¶ç³»ç»Ÿ

**13. ç­”æ¡ˆï¼šB**
- sequence_number è¡¨ç¤ºäº‹ä»¶çš„å‘å‡ºé¡ºåº
- ä» 0 å¼€å§‹é€’å¢ï¼Œæ¯ä¸ª EventHandle ç‹¬ç«‹è®¡æ•°

**14. ç­”æ¡ˆï¼šD**
- Event ç»“æ„åŒ…å«ï¼škey, sequence_number, type_, data
- ä¸åŒ…å« senderï¼ˆsender ä¿¡æ¯åœ¨äº¤æ˜“å±‚é¢ï¼‰

**15. ç­”æ¡ˆï¼šC**
- äº‹ä»¶æ•°æ®ä½¿ç”¨ BCS (Binary Canonical Serialization) ç¼–ç 
- ä¸äº¤æ˜“çš„å…¶ä»–éƒ¨åˆ†ä¸€è‡´

**16. ç­”æ¡ˆï¼šA**
- é€šè¿‡éå†äº‹ä»¶å¹¶æ£€æŸ¥ type_ å­—æ®µæ¥è¿‡æ»¤
- ä¹Ÿå¯ä»¥ä½¿ç”¨ Indexer çš„ GraphQL API è¿›è¡Œé«˜æ•ˆæŸ¥è¯¢

---

#### ç¬¬å››éƒ¨åˆ†ï¼šç­¾åå’ŒéªŒè¯

**17. ç­”æ¡ˆï¼šC**
- Aptos æ”¯æŒ Ed25519 å’Œ MultiEd25519
- ä¸æ”¯æŒ ECDSA æˆ– RSA

**18. ç­”æ¡ˆï¼šB**
- Ed25519 ç­¾åé•¿åº¦ï¼š64 bytes
- å…¬é’¥é•¿åº¦ï¼š32 bytes

**19. ç­”æ¡ˆï¼šB**
- bitmap æ ‡è¯†å“ªäº›å…¬é’¥å‚ä¸äº†ç­¾å
- ä½¿ç”¨ 4 å­—èŠ‚ï¼ˆ32ä½ï¼‰bitmap

**20. ç­”æ¡ˆï¼šC**
- é˜ˆå€¼ä¸º 3ï¼Œæ‰€ä»¥è‡³å°‘éœ€è¦ 3 ä¸ªç­¾å
- å³ä½¿æœ‰ 5 ä¸ªå…¬é’¥ï¼Œåªéœ€ 3 ä¸ªç­¾åå³å¯

---

## ç¼–ç¨‹é¢˜ç­”æ¡ˆï¼ˆ60åˆ†ï¼‰

### ç¼–ç¨‹é¢˜ 1ï¼šäº¤æ˜“éªŒè¯å™¨ï¼ˆ20åˆ†ï¼‰

```move
module exam::transaction_validator {
    use aptos_framework::timestamp;
    
    struct Transaction has drop {
        sender: address,
        sequence_number: u64,
        max_gas_amount: u64,
        gas_unit_price: u64,
        expiration_timestamp_secs: u64,
        chain_id: u8,
    }
    
    const MAINNET_CHAIN_ID: u8 = 1;
    const MAX_GAS_LIMIT: u64 = 2_000_000;
    const MIN_GAS_PRICE: u64 = 100;
    
    const ERROR_INVALID_GAS_AMOUNT: u64 = 1;
    const ERROR_INVALID_GAS_PRICE: u64 = 2;
    const ERROR_EXPIRED: u64 = 3;
    const ERROR_INVALID_CHAIN_ID: u64 = 4;
    const ERROR_INVALID_SEQUENCE: u64 = 5;
    
    public fun validate_transaction(txn: &Transaction): bool {
        // 1. éªŒè¯ max_gas_amount
        assert!(
            txn.max_gas_amount > 0 && txn.max_gas_amount <= MAX_GAS_LIMIT,
            ERROR_INVALID_GAS_AMOUNT
        );
        
        // 2. éªŒè¯ gas_unit_price
        assert!(
            txn.gas_unit_price >= MIN_GAS_PRICE,
            ERROR_INVALID_GAS_PRICE
        );
        
        // 3. éªŒè¯æœªè¿‡æœŸ
        let current_time = timestamp::now_seconds();
        assert!(
            txn.expiration_timestamp_secs > current_time,
            ERROR_EXPIRED
        );
        
        // 4. éªŒè¯ chain_id
        assert!(
            txn.chain_id == MAINNET_CHAIN_ID,
            ERROR_INVALID_CHAIN_ID
        );
        
        // 5. éªŒè¯ sequence_number
        assert!(
            txn.sequence_number > 0,
            ERROR_INVALID_SEQUENCE
        );
        
        true
    }
    
    public fun calculate_max_fee(txn: &Transaction): u64 {
        txn.max_gas_amount * txn.gas_unit_price
    }
}
```

**è¯„åˆ†ç‚¹**ï¼š
- âœ… æ‰€æœ‰ 5 ä¸ªéªŒè¯è§„åˆ™æ­£ç¡®å®ç°ï¼ˆ12åˆ†ï¼‰
- âœ… æ­£ç¡®è®¡ç®—æœ€å¤§è´¹ç”¨ï¼ˆ4åˆ†ï¼‰
- âœ… ä½¿ç”¨é€‚å½“çš„é”™è¯¯ç ï¼ˆ2åˆ†ï¼‰
- âœ… ä»£ç æ¸…æ™°æ˜“è¯»ï¼ˆ2åˆ†ï¼‰

---

### ç¼–ç¨‹é¢˜ 2ï¼šäº‹ä»¶è¿‡æ»¤å™¨ï¼ˆ20åˆ†ï¼‰

```move
module exam::event_filter {
    use std::vector;
    use std::string::{Self, String};
    use std::option::{Self, Option};
    
    struct EventData has drop, copy {
        sequence_number: u64,
        event_type: String,
        data_length: u64,
    }
    
    struct EventFilter has drop {
        type_filter: Option<String>,
        min_sequence: Option<u64>,
        max_sequence: Option<u64>,
        min_data_length: Option<u64>,
    }
    
    public fun create_event(
        sequence_number: u64,
        event_type: vector<u8>,
        data_length: u64,
    ): EventData {
        EventData {
            sequence_number,
            event_type: string::utf8(event_type),
            data_length,
        }
    }
    
    public fun create_filter(
        type_filter: Option<String>,
        min_sequence: Option<u64>,
        max_sequence: Option<u64>,
        min_data_length: Option<u64>,
    ): EventFilter {
        EventFilter {
            type_filter,
            min_sequence,
            max_sequence,
            min_data_length,
        }
    }
    
    public fun matches(event: &EventData, filter: &EventFilter): bool {
        // æ£€æŸ¥äº‹ä»¶ç±»å‹
        if (option::is_some(&filter.type_filter)) {
            let expected_type = option::borrow(&filter.type_filter);
            if (&event.event_type != expected_type) {
                return false
            };
        };
        
        // æ£€æŸ¥æœ€å°åºåˆ—å·
        if (option::is_some(&filter.min_sequence)) {
            let min = *option::borrow(&filter.min_sequence);
            if (event.sequence_number < min) {
                return false
            };
        };
        
        // æ£€æŸ¥æœ€å¤§åºåˆ—å·
        if (option::is_some(&filter.max_sequence)) {
            let max = *option::borrow(&filter.max_sequence);
            if (event.sequence_number > max) {
                return false
            };
        };
        
        // æ£€æŸ¥æœ€å°æ•°æ®é•¿åº¦
        if (option::is_some(&filter.min_data_length)) {
            let min = *option::borrow(&filter.min_data_length);
            if (event.data_length < min) {
                return false
            };
        };
        
        true
    }
    
    public fun apply_filter(
        events: &vector<EventData>,
        filter: &EventFilter,
    ): vector<EventData> {
        let result = vector::empty<EventData>();
        let i = 0;
        let len = vector::length(events);
        
        while (i < len) {
            let event = vector::borrow(events, i);
            if (matches(event, filter)) {
                vector::push_back(&mut result, *event);
            };
            i = i + 1;
        };
        
        result
    }
}
```

**è¯„åˆ†ç‚¹**ï¼š
- âœ… æ­£ç¡®åˆ›å»ºäº‹ä»¶å’Œè¿‡æ»¤å™¨ï¼ˆ4åˆ†ï¼‰
- âœ… matches å‡½æ•°å®ç°æ‰€æœ‰4ä¸ªæ¡ä»¶æ£€æŸ¥ï¼ˆ8åˆ†ï¼‰
- âœ… apply_filter æ­£ç¡®éå†å’Œè¿‡æ»¤ï¼ˆ4åˆ†ï¼‰
- âœ… ä»£ç è´¨é‡å’Œæ•ˆç‡ï¼ˆ4åˆ†ï¼‰

---

### ç¼–ç¨‹é¢˜ 3ï¼šäº¤æ˜“åˆ†æå™¨ï¼ˆ20åˆ†ï¼‰

```move
module exam::transaction_analyzer {
    use std::vector;
    use std::string::String;
    use std::option::{Self, Option};
    
    struct TransactionSummary has drop, copy {
        sender: address,
        gas_used: u64,
        success: bool,
    }
    
    public fun calculate_average_gas(
        summaries: &vector<TransactionSummary>
    ): u64 {
        let len = vector::length(summaries);
        if (len == 0) {
            return 0
        };
        
        let total_gas = 0u128;
        let i = 0;
        
        while (i < len) {
            let summary = vector::borrow(summaries, i);
            total_gas = total_gas + (summary.gas_used as u128);
            i = i + 1;
        };
        
        ((total_gas / (len as u128)) as u64)
    }
    
    public fun calculate_success_rate(
        summaries: &vector<TransactionSummary>
    ): u64 {
        let len = vector::length(summaries);
        if (len == 0) {
            return 0
        };
        
        let success_count = 0;
        let i = 0;
        
        while (i < len) {
            let summary = vector::borrow(summaries, i);
            if (summary.success) {
                success_count = success_count + 1;
            };
            i = i + 1;
        };
        
        // è¿”å›ç™¾åˆ†æ¯”
        (success_count * 100) / len
    }
    
    public fun find_highest_gas_transaction(
        summaries: &vector<TransactionSummary>
    ): Option<TransactionSummary> {
        if (vector::is_empty(summaries)) {
            return option::none()
        };
        
        let max_gas = 0;
        let max_index = 0;
        let i = 0;
        let len = vector::length(summaries);
        
        while (i < len) {
            let summary = vector::borrow(summaries, i);
            if (summary.gas_used > max_gas) {
                max_gas = summary.gas_used;
                max_index = i;
            };
            i = i + 1;
        };
        
        option::some(*vector::borrow(summaries, max_index))
    }
    
    public fun count_transactions_from_sender(
        summaries: &vector<TransactionSummary>,
        sender: address,
    ): u64 {
        let count = 0;
        let i = 0;
        let len = vector::length(summaries);
        
        while (i < len) {
            let summary = vector::borrow(summaries, i);
            if (summary.sender == sender) {
                count = count + 1;
            };
            i = i + 1;
        };
        
        count
    }
}
```

**è¯„åˆ†ç‚¹**ï¼š
- âœ… calculate_average_gas æ­£ç¡®å¤„ç†ç©ºå‘é‡å’Œä½¿ç”¨ u128ï¼ˆ5åˆ†ï¼‰
- âœ… calculate_success_rate æ­£ç¡®è®¡ç®—ç™¾åˆ†æ¯”ï¼ˆ5åˆ†ï¼‰
- âœ… find_highest_gas_transaction è¿”å›æ­£ç¡®çš„ Optionï¼ˆ5åˆ†ï¼‰
- âœ… count_transactions_from_sender æ­£ç¡®ç»Ÿè®¡ï¼ˆ3åˆ†ï¼‰
- âœ… æ­£ç¡®å¤„ç†è¾¹ç•Œæƒ…å†µï¼ˆ2åˆ†ï¼‰

---

## ğŸ“Š æ€»åˆ†è®¡ç®—

### é€‰æ‹©é¢˜ï¼ˆ40åˆ†ï¼‰
- æ¯é¢˜ 2 åˆ†
- æ­£ç¡®é¢˜æ•° Ã— 2 = ä½ çš„å¾—åˆ†

### ç¼–ç¨‹é¢˜ï¼ˆ60åˆ†ï¼‰
- ç¼–ç¨‹é¢˜ 1ï¼š____ / 20åˆ†
- ç¼–ç¨‹é¢˜ 2ï¼š____ / 20åˆ†
- ç¼–ç¨‹é¢˜ 3ï¼š____ / 20åˆ†

### æ€»åˆ†
```
é€‰æ‹©é¢˜å¾—åˆ†ï¼š____ / 40åˆ†
ç¼–ç¨‹é¢˜å¾—åˆ†ï¼š____ / 60åˆ†
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»åˆ†ï¼š      ____ / 100åˆ†
```

---

## ğŸ¯ è¯„çº§æ ‡å‡†

| åˆ†æ•°èŒƒå›´ | è¯„çº§ | è¯´æ˜ |
|---------|------|------|
| 90-100 | ä¼˜ç§€ â­â­â­â­â­ | å®Œå…¨æŒæ¡äº¤æ˜“è§£æ |
| 80-89 | è‰¯å¥½ â­â­â­â­ | è¾ƒå¥½æŒæ¡æ ¸å¿ƒæ¦‚å¿µ |
| 70-79 | åŠæ ¼ â­â­â­ | åŸºæœ¬æŒæ¡ï¼Œå¯ç»§ç»­å­¦ä¹  |
| 60-69 | éœ€åŠ å¼º â­â­ | éœ€è¦é‡æ–°å­¦ä¹ éƒ¨åˆ†å†…å®¹ |
| < 60 | ä¸åŠæ ¼ â­ | å»ºè®®é‡æ–°å­¦ä¹ ä»Šå¤©çš„å†…å®¹ |

---

## ğŸ“ å­¦ä¹ å»ºè®®

### å¦‚æœå¾—åˆ† < 70 åˆ†

1. **é‡æ–°é˜…è¯»ç†è®º**ï¼š`01_ç†è®ºå­¦ä¹ /æ ¸å¿ƒæ¦‚å¿µ.md`
2. **ç ”ç©¶ä»£ç ç¤ºä¾‹**ï¼š`01_ç†è®ºå­¦ä¹ /ä»£ç ç¤ºä¾‹.move`
3. **é‡åšå®è·µä»»åŠ¡**ï¼š`02_å®è·µä»»åŠ¡/ä»»åŠ¡è¯´æ˜.md`
4. **é‡ç‚¹å¤ä¹ é”™é¢˜**ï¼šç†è§£ä¸ºä»€ä¹ˆé”™äº†

### å¦‚æœå¾—åˆ† â‰¥ 70 åˆ†

1. âœ… ç»§ç»­å­¦ä¹  Day 28
2. ğŸ’¡ å°è¯•ä¼˜åŒ–ä½ çš„ä»£ç 
3. ğŸ” ç ”ç©¶çœŸå®é¡¹ç›®çš„äº¤æ˜“è§£æå®ç°
4. ğŸš€ å¼€å§‹æ„å»ºè‡ªå·±çš„ç›‘æ§å·¥å…·

---

## ğŸŒŸ å…³é”®çŸ¥è¯†ç‚¹æ€»ç»“

### å¿…é¡»æŒæ¡

1. **UserTransaction ç»“æ„**
   - 8 ä¸ªå…³é”®å­—æ®µåŠå…¶ä½œç”¨
   - sequence_number çš„è¿ç»­æ€§è¦æ±‚
   - gas æœºåˆ¶å’Œè´¹ç”¨è®¡ç®—

2. **Payload ç±»å‹**
   - EntryFunction æ˜¯æœ€å¸¸ç”¨ç±»å‹
   - åŒ…å«æ¨¡å—ã€å‡½æ•°ã€ç±»å‹å‚æ•°ã€å‡½æ•°å‚æ•°

3. **äº‹ä»¶ç³»ç»Ÿ**
   - Event ç»“æ„ï¼škey, sequence_number, type_, data
   - ä½¿ç”¨ BCS ç¼–ç 
   - å¯ä»¥æŒ‰ç±»å‹ã€åºåˆ—å·ç­‰è¿‡æ»¤

4. **ç­¾åéªŒè¯**
   - Ed25519 å’Œ MultiEd25519
   - ç­¾åå’Œå…¬é’¥çš„é•¿åº¦
   - MultiEd25519 çš„é˜ˆå€¼æœºåˆ¶

5. **å®é™…åº”ç”¨**
   - äº¤æ˜“è§£æå’ŒéªŒè¯
   - äº‹ä»¶è¿‡æ»¤å’ŒæŸ¥è¯¢
   - ç»Ÿè®¡åˆ†æ

---

**æ­å–œå®Œæˆ Day 27 è€ƒè¯•ï¼ğŸ‰**

**ä¸‹ä¸€æ­¥**ï¼š
- æŸ¥çœ‹ä½ çš„é”™é¢˜
- ç†è§£æ¯ä¸ªç­”æ¡ˆçš„è§£æ
- å‡†å¤‡å­¦ä¹  Day 28: Indexer ä¸ GraphQL æŸ¥è¯¢
