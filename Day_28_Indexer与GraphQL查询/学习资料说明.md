# Day 28 å­¦ä¹ èµ„æ–™è¯´æ˜

## ğŸ“š èµ„æ–™æ¦‚è§ˆ

æœ¬ç›®å½•åŒ…å« Day 28ã€ŒIndexer ä¸ GraphQL æŸ¥è¯¢ã€çš„å®Œæ•´å­¦ä¹ èµ„æ–™ã€‚

---

## ğŸ“‚ ç›®å½•ç»“æ„

```
Day_28_Indexerä¸GraphQLæŸ¥è¯¢/
â”œâ”€â”€ README.md                     # å­¦ä¹ æŒ‡å—ï¼ˆä»è¿™é‡Œå¼€å§‹ï¼‰
â”œâ”€â”€ å­¦ä¹ èµ„æ–™è¯´æ˜.md               # æœ¬æ–‡ä»¶
â”œâ”€â”€ Move.toml                     # Move é¡¹ç›®é…ç½®
â”‚
â”œâ”€â”€ 01_ç†è®ºå­¦ä¹ /                  # ç†è®ºçŸ¥è¯†
â”‚   â”œâ”€â”€ æ ¸å¿ƒæ¦‚å¿µ.md               # è¯¦ç»†çš„ç†è®ºè®²è§£
â”‚   â””â”€â”€ ä»£ç ç¤ºä¾‹.move             # Move åˆçº¦ç¤ºä¾‹
â”‚
â”œâ”€â”€ 02_å®è·µä»»åŠ¡/                  # å®è·µé¡¹ç›®
â”‚   â””â”€â”€ ä»»åŠ¡è¯´æ˜.md               # 4ä¸ªå®è·µä»»åŠ¡
â”‚
â”œâ”€â”€ 03_æ¯æ—¥è€ƒè¯•/                  # è€ƒè¯•ææ–™
â”‚   â”œâ”€â”€ é€‰æ‹©é¢˜.md                 # 20é“é€‰æ‹©é¢˜
â”‚   â”œâ”€â”€ ç¼–ç¨‹é¢˜.md                 # 3é“ç¼–ç¨‹é¢˜
â”‚   â””â”€â”€ ç­”æ¡ˆè§£æ.md               # å®Œæ•´ç­”æ¡ˆ
â”‚
â”œâ”€â”€ sources/                      # Move ä»£ç 
â”‚   â”œâ”€â”€ indexer_client.move       # Indexer å®¢æˆ·ç«¯ç¤ºä¾‹
â”‚   â”œâ”€â”€ event_definitions.move    # äº‹ä»¶å®šä¹‰
â”‚   â””â”€â”€ data_structures.move      # æ•°æ®ç»“æ„
â”‚
â””â”€â”€ scripts/                      # TypeScript ç¤ºä¾‹
    â””â”€â”€ (ä½ çš„ TypeScript ä»£ç )
```

---

## ğŸ¯ å­¦ä¹ è·¯å¾„

### ç¬¬ä¸€æ­¥ï¼šé˜…è¯»å­¦ä¹ æŒ‡å—ï¼ˆ15åˆ†é’Ÿï¼‰
æ‰“å¼€ `README.md`ï¼Œäº†è§£ä»Šå¤©çš„å­¦ä¹ ç›®æ ‡å’Œæ•´ä½“å®‰æ’ã€‚

### ç¬¬äºŒæ­¥ï¼šç†è®ºå­¦ä¹ ï¼ˆ90åˆ†é’Ÿï¼‰
1. é˜…è¯» `01_ç†è®ºå­¦ä¹ /æ ¸å¿ƒæ¦‚å¿µ.md`
2. ç†è§£ Aptos Indexer æ¶æ„
3. å­¦ä¹  GraphQL æŸ¥è¯¢è¯­æ³•
4. äº†è§£æ•°æ®æ¨¡å‹å’Œè®¢é˜…æœºåˆ¶

### ç¬¬ä¸‰æ­¥ï¼šä»£ç å­¦ä¹ ï¼ˆ60åˆ†é’Ÿï¼‰
1. ç ”ç©¶ `01_ç†è®ºå­¦ä¹ /ä»£ç ç¤ºä¾‹.move`
2. ç†è§£äº‹ä»¶å®šä¹‰å’Œæ•°æ®ç»“æ„
3. åœ¨ GraphiQL ä¸­è¿è¡Œç¤ºä¾‹æŸ¥è¯¢

### ç¬¬å››æ­¥ï¼šå®è·µä»»åŠ¡ï¼ˆ180åˆ†é’Ÿï¼‰
æŒ‰ç…§ `02_å®è·µä»»åŠ¡/ä»»åŠ¡è¯´æ˜.md` å®Œæˆå››ä¸ªä»»åŠ¡ï¼š
- ä»»åŠ¡ä¸€ï¼šGraphQL å®¢æˆ·ç«¯
- ä»»åŠ¡äºŒï¼šäº‹ä»¶ç›‘å¬å™¨
- ä»»åŠ¡ä¸‰ï¼šæ•°æ®åˆ†æå·¥å…·
- ä»»åŠ¡å››ï¼šæ€§èƒ½ä¼˜åŒ–

### ç¬¬äº”æ­¥ï¼šæ¯æ—¥è€ƒè¯•ï¼ˆ60åˆ†é’Ÿï¼‰
1. å®Œæˆé€‰æ‹©é¢˜ï¼ˆ20é¢˜ï¼‰
2. å®Œæˆç¼–ç¨‹é¢˜ï¼ˆ3é¢˜ï¼‰
3. å¯¹ç…§ç­”æ¡ˆè§£æè‡ªæˆ‘è¯„åˆ†

---

## ğŸ› ï¸ ç¯å¢ƒå‡†å¤‡

### Node.js ç¯å¢ƒ
```bash
# æ£€æŸ¥ Node.js ç‰ˆæœ¬ï¼ˆéœ€è¦ >= 16ï¼‰
node --version

# å®‰è£…ä¾èµ–
npm install @apollo/client graphql subscriptions-transport-ws ws axios
npm install --save-dev @types/ws typescript ts-node
```

### Move ç¯å¢ƒ
```bash
# æ£€æŸ¥ Aptos CLI
aptos --version

# ç¼–è¯‘ Move ä»£ç ï¼ˆå¯é€‰ï¼‰
aptos move compile
```

### GraphQL Playground
è®¿é—®ä»¥ä¸‹åœ°å€è¿›è¡Œäº¤äº’å¼æŸ¥è¯¢ï¼š
- **Mainnet**: https://cloud.hasura.io/public/graphiql?endpoint=https://indexer.mainnet.aptoslabs.com/v1/graphql
- **Testnet**: https://cloud.hasura.io/public/graphiql?endpoint=https://indexer.testnet.aptoslabs.com/v1/graphql

---

## ğŸ“– æ ¸å¿ƒæ¦‚å¿µé€ŸæŸ¥

### Indexer æ¶æ„
```
Fullnode â†’ TSS â†’ Processor â†’ Database â†’ GraphQL â†’ ä½ çš„åº”ç”¨
```

### GraphQL ä¸‰ç§æ“ä½œ
- **Query**: è¯»å–æ•°æ®
- **Mutation**: ä¿®æ”¹æ•°æ®ï¼ˆIndexer ä¸æ”¯æŒï¼‰
- **Subscription**: å®æ—¶è®¢é˜…

### ä¸»è¦æ•°æ®è¡¨
- `transactions`: äº¤æ˜“æ•°æ®
- `events`: äº‹ä»¶æ•°æ®
- `current_coin_balances`: ä»£å¸ä½™é¢
- `current_token_ownerships_v2`: NFT æ‰€æœ‰æƒ

### å¸¸ç”¨æŸ¥è¯¢æ¨¡å¼
```graphql
# æŸ¥è¯¢è´¦æˆ·ä½™é¢
query {
  current_coin_balances(where: {owner_address: {_eq: "0x1"}}) {
    coin_type
    amount
  }
}

# è®¢é˜…æ–°äº¤æ˜“
subscription {
  transactions(limit: 1, order_by: {version: desc}) {
    version
    hash
  }
}
```

---

## ğŸ’¡ å­¦ä¹ æŠ€å·§

### ç†è®ºå­¦ä¹ 
- âœ… è¾¹è¯»è¾¹ç”»æ¶æ„å›¾
- âœ… åœ¨ GraphiQL ä¸­å®é™…è¿è¡ŒæŸ¥è¯¢
- âœ… å¯¹æ¯”ä¸åŒæŸ¥è¯¢æ–¹å¼çš„æ€§èƒ½
- âœ… è®°å½•ä¸ç†è§£çš„æ¦‚å¿µ

### ä»£ç å­¦ä¹ 
- âœ… è¿½è¸ªæ•°æ®æµè½¬è¿‡ç¨‹
- âœ… ç†è§£æ¯ä¸ªå­—æ®µçš„ä½œç”¨
- âœ… ä¿®æ”¹ç¤ºä¾‹ä»£ç å¹¶è§‚å¯Ÿç»“æœ
- âœ… ç¼–å†™è‡ªå·±çš„æŸ¥è¯¢

### å®è·µä»»åŠ¡
- âœ… å…ˆå®ç°åŸºç¡€åŠŸèƒ½å†ä¼˜åŒ–
- âœ… å……åˆ†æµ‹è¯•è¾¹ç•Œæƒ…å†µ
- âœ… å‚è€ƒç­”æ¡ˆè§£æä¸­çš„ä»£ç 
- âœ… è®°å½•é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### è€ƒè¯•å‡†å¤‡
- âœ… å¤ä¹ æ ¸å¿ƒæ¦‚å¿µ
- âœ… ç†Ÿæ‚‰ GraphQL è¯­æ³•
- âœ… ç»ƒä¹ ç¼–å†™æŸ¥è¯¢
- âœ… ç†è§£æ•°æ®æ¨¡å‹

---

## ğŸ”— å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£
- [Aptos Indexer](https://aptos.dev/indexer/)
- [GraphQL](https://graphql.org/learn/)
- [Hasura](https://hasura.io/docs/latest/index/)

### API ç«¯ç‚¹
- Mainnet GraphQL: `https://indexer.mainnet.aptoslabs.com/v1/graphql`
- Testnet GraphQL: `https://indexer.testnet.aptoslabs.com/v1/graphql`

### å·¥å…·
- [GraphiQL](https://github.com/graphql/graphiql)
- [Apollo Client](https://www.apollographql.com/docs/react/)
- [Postman](https://www.postman.com/)

### ç¤ºä¾‹ä»£ç 
- [Aptos SDK](https://github.com/aptos-labs/aptos-core/tree/main/ecosystem/typescript/sdk)
- [Indexer Processors](https://github.com/aptos-labs/aptos-core/tree/main/ecosystem/indexer-grpc)

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: GraphQL æŸ¥è¯¢æ€»æ˜¯è¶…æ—¶æ€ä¹ˆåŠï¼Ÿ
A: 
- å‡å° `limit` å€¼
- åªæŸ¥è¯¢å¿…è¦çš„å­—æ®µ
- ä½¿ç”¨ç´¢å¼•å­—æ®µï¼ˆå¦‚ versionï¼‰è¿‡æ»¤
- æ£€æŸ¥ç½‘ç»œè¿æ¥

### Q2: WebSocket è®¢é˜…ä¸€ç›´æ–­çº¿ï¼Ÿ
A: 
- å®ç°é‡è¿æœºåˆ¶
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
- ä½¿ç”¨ç¨³å®šçš„ç½‘ç»œç¯å¢ƒ
- å¢åŠ å¿ƒè·³æ£€æµ‹

### Q3: æŸ¥è¯¢çš„æ•°æ®å’Œé“¾ä¸Šä¸ä¸€è‡´ï¼Ÿ
A: 
- Indexer æœ‰å»¶è¿Ÿï¼ˆ400-500msï¼‰
- ç­‰å¾…å‡ ç§’åé‡æ–°æŸ¥è¯¢
- ä½¿ç”¨ Fullnode API è·å–å®æ—¶æ•°æ®

### Q4: å¦‚ä½•è°ƒè¯• GraphQL æŸ¥è¯¢ï¼Ÿ
A: 
- ä½¿ç”¨ GraphiQL Playground
- æŸ¥çœ‹æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„ç½‘ç»œè¯·æ±‚
- æ£€æŸ¥è¿”å›çš„ errors å­—æ®µ
- ç®€åŒ–æŸ¥è¯¢é€æ­¥æ’æŸ¥

---

## ğŸ“Š å­¦ä¹ è¯„ä¼°

å®Œæˆä»Šå¤©çš„å­¦ä¹ åï¼Œä½ åº”è¯¥èƒ½å¤Ÿï¼š

- [ ] è§£é‡Š Indexer çš„å·¥ä½œåŸç†
- [ ] ç¼–å†™å„ç§ GraphQL æŸ¥è¯¢
- [ ] ä½¿ç”¨è®¢é˜…ç›‘å¬å®æ—¶æ•°æ®
- [ ] å®ç°æ•°æ®æŸ¥è¯¢å·¥å…·
- [ ] ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½
- [ ] å¤„ç†æŸ¥è¯¢é”™è¯¯

å¦‚æœä»¥ä¸Šä»»ä¸€é¡¹ä¸èƒ½åšåˆ°ï¼Œè¯·é‡æ–°å­¦ä¹ ç›¸å…³éƒ¨åˆ†ã€‚

---

## ğŸ“ ä¸‹ä¸€æ­¥

å®Œæˆ Day 28 åï¼š
- âœ… å¦‚æœè€ƒè¯• â‰¥ 70 åˆ†ï¼šç»§ç»­ Day 29
- âŒ å¦‚æœè€ƒè¯• < 70 åˆ†ï¼šé‡æ–°å­¦ä¹ å¹¶é‡è€ƒ

Day 29 ä¸»é¢˜ï¼š**Mempool ç›‘æ§ä¸äº¤æ˜“è¿½è¸ª**

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœåœ¨å­¦ä¹ è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. **æŸ¥é˜…ç†è®ºå­¦ä¹ ææ–™** - å¤§å¤šæ•°é—®é¢˜éƒ½èƒ½åœ¨æ ¸å¿ƒæ¦‚å¿µä¸­æ‰¾åˆ°ç­”æ¡ˆ
2. **è¿è¡Œç¤ºä¾‹ä»£ç ** - åŠ¨æ‰‹å®è·µæ˜¯æœ€å¥½çš„å­¦ä¹ æ–¹å¼
3. **æŸ¥çœ‹ç­”æ¡ˆè§£æ** - å¯¹æ¯”ä½ çš„å®ç°å’Œå‚è€ƒç­”æ¡ˆ
4. **æœç´¢å®˜æ–¹æ–‡æ¡£** - Aptos å’Œ GraphQL æ–‡æ¡£å¾ˆè¯¦ç»†
5. **é‡æ–°å­¦ä¹ ç›¸å…³ç« èŠ‚** - ä¸è¦æ€¥äºæ±‚æˆ

---

**ç¥å­¦ä¹ æ„‰å¿«ï¼è®°ä½ï¼Œç†è§£åŸç†æ¯”è®°ä½è¯­æ³•æ›´é‡è¦ã€‚ğŸš€**

**æœ€åæ›´æ–°**: 2025-11-12
