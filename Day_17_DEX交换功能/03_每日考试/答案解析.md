# Day 17 æ¯æ—¥è€ƒè¯• - ç­”æ¡ˆè§£æ

## ğŸ“‹ é€‰æ‹©é¢˜ç­”æ¡ˆ

### å¿«é€ŸæŸ¥çœ‹ç­”æ¡ˆ

```
1. B    6. B    11. B    16. C
2. D    7. A    12. B    17. B
3. B    8. C    13. C    18. D
4. B    9. B    14. A    19. B
5. B    10. B   15. A    20. B
```

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šåŸºç¡€æ¦‚å¿µè¯¦è§£

### 1. ç­”æ¡ˆï¼šB

**è§£æ**ï¼š
- **Exact Input** = ç”¨æˆ·æŒ‡å®šè¾“å…¥æ•°é‡ï¼Œç³»ç»Ÿè®¡ç®—è¾“å‡º
- **Exact Output** = ç”¨æˆ·æŒ‡å®šè¾“å‡ºæ•°é‡ï¼Œç³»ç»Ÿè®¡ç®—è¾“å…¥

**è®°å¿†æŠ€å·§**ï¼šExact æŒ‡çš„æ˜¯ç”¨æˆ·"ç²¾ç¡®çŸ¥é“"çš„é‚£ä¸ªå€¼ã€‚

---

### 2. ç­”æ¡ˆï¼šD âŒ

**è§£æ**ï¼š
æ‰‹ç»­è´¹æ˜¯ä»**è¾“å…¥ä»£å¸**ä¸­æ‰£é™¤çš„ï¼Œä¸æ˜¯ä»è¾“å‡ºæ‰£é™¤ã€‚

æ­£ç¡®æµç¨‹ï¼š
```
1. ç”¨æˆ·è¾“å…¥ 1000 ä»£å¸
2. æ‰£é™¤æ‰‹ç»­è´¹ï¼š1000 * 0.003 = 3 ä»£å¸
3. å®é™…ç”¨äºäº¤æ¢ï¼š997 ä»£å¸
4. è®¡ç®—è¾“å‡ºï¼ˆåŸºäº 997ï¼‰
5. å°†è¾“å‡ºå…¨é¢å‘ç»™ç”¨æˆ·
```

é”™è¯¯é€‰é¡¹ D çš„é—®é¢˜ï¼šå¦‚æœä»è¾“å‡ºæ‰£é™¤ï¼Œä¼šå¯¼è‡´ LP æ— æ³•å…¬å¹³è·å¾—æ‰‹ç»­è´¹æ”¶ç›Šã€‚

---

### 3. ç­”æ¡ˆï¼šB

**è§£æ**ï¼š
Uniswap V2 çš„æ ‡å‡†æ‰‹ç»­è´¹ç‡æ˜¯ **0.3%**ï¼ˆ30 åŸºç‚¹ï¼‰ã€‚

ä¸åŒåè®®çš„å¯¹æ¯”ï¼š
- Uniswap V2: 0.3%
- Uniswap V3: 0.05%, 0.3%, 1%ï¼ˆå¯é€‰ï¼‰
- SushiSwap: 0.3%
- PancakeSwap: 0.25%

---

### 4. ç­”æ¡ˆï¼šB

**è§£æ**ï¼š
```
è¾“å…¥ï¼š1000
æ‰‹ç»­è´¹ç‡ï¼š0.3% = 0.003
å®é™…ç”¨äºäº¤æ¢ = 1000 * (1 - 0.003)
                = 1000 * 0.997
                = 997
```

**å¸¸è§é”™è¯¯**ï¼š
- è®¡ç®—æˆ 1000 - 3 = 997 âœ“ï¼ˆç»“æœå¯¹ï¼‰
- è®¡ç®—æˆ 1000 * 0.003 = 3ï¼ˆè¿™æ˜¯æ‰‹ç»­è´¹é‡‘é¢ï¼Œä¸æ˜¯å‰©ä½™ï¼‰

---

### 5. ç­”æ¡ˆï¼šB

**è§£æ**ï¼š
**æ»‘ç‚¹ï¼ˆSlippageï¼‰** = é¢„æœŸä»·æ ¼ä¸å®é™…æ‰§è¡Œä»·æ ¼ä¹‹é—´çš„å·®å¼‚

**äº§ç”ŸåŸå› **ï¼š
1. äº¤æ˜“è§„æ¨¡å¯¼è‡´ä»·æ ¼ç§»åŠ¨ï¼ˆAMM ç‰¹æ€§ï¼‰
2. å…¶ä»–äººæŠ¢å…ˆäº¤æ˜“ï¼ˆMEVï¼‰
3. ç½‘ç»œå»¶è¿Ÿ

**ç¤ºä¾‹**ï¼š
```
é¢„æœŸä»·æ ¼ï¼š1 APT = 20 USDC
å®é™…ä»·æ ¼ï¼š1 APT = 20.4 USDC
æ»‘ç‚¹ï¼š(20.4 - 20) / 20 = 2%
```

---

### 6. ç­”æ¡ˆï¼šB

**è§£æ**ï¼š
ä»·æ ¼æ»‘ç‚¹ âˆ äº¤æ˜“é‡ / å‚¨å¤‡é‡

**å…¬å¼æ¨å¯¼**ï¼š
```
ä»·æ ¼ = reserve_y / reserve_x
æ–°ä»·æ ¼ = (reserve_y - amount_out) / (reserve_x + amount_in)

å½“ amount_in å¾ˆå¤§ï¼Œreserve_x å¾ˆå°æ—¶ï¼š
æ–°ä»·æ ¼ >> æ—§ä»·æ ¼ â†’ æ»‘ç‚¹å¤§
```

**å®ä¾‹å¯¹æ¯”**ï¼š
```
æƒ…å†µ A: å‚¨å¤‡ 1,000,000ï¼Œäº¤æ˜“ 1,000 â†’ æ»‘ç‚¹ ~0.1%
æƒ…å†µ B: å‚¨å¤‡ 10,000ï¼Œäº¤æ˜“ 1,000 â†’ æ»‘ç‚¹ ~10%
```

---

### 7. ç­”æ¡ˆï¼šA âœ“

**è§£æ**ï¼š
Exact Output ä¸­ï¼š
- ç”¨æˆ·æŒ‡å®š `amount_out`ï¼ˆæƒ³è¦çš„è¾“å‡ºï¼‰
- ç³»ç»Ÿè®¡ç®— `amount_in`ï¼ˆéœ€è¦çš„è¾“å…¥ï¼‰
- æ»‘ç‚¹ä¿æŠ¤ç”¨ `max_amount_in`ï¼ˆä¸æ˜¯ `min_amount_out`ï¼‰

**å‚æ•°å¯¹æ¯”**ï¼š
| Swap ç±»å‹ | ç”¨æˆ·æŒ‡å®š | æ»‘ç‚¹ä¿æŠ¤å‚æ•° |
|-----------|---------|-------------|
| Exact Input | amount_in | min_amount_out |
| Exact Output | amount_out | max_amount_in |

---

### 8. ç­”æ¡ˆï¼šC

**è§£æ**ï¼š
K å€¼ä¼š**ç•¥å¾®å¢åŠ **ï¼Œå› ä¸ºæ‰‹ç»­è´¹å½’å…¥å‚¨å¤‡ã€‚

**æ•°å­¦è¯æ˜**ï¼š
```
äº¤æ˜“å‰ï¼šk = x * y
äº¤æ˜“åï¼šk' = (x + amount_in) * (y - amount_out)

ç”±äºæ‰‹ç»­è´¹å‡å°‘äº† amount_outï¼š
amount_out < ç†è®ºè¾“å‡º
â†’ y - amount_out > ç†è®ºå‰©ä½™
â†’ k' > k
```

**å¢é•¿ç‡ â‰ˆ æ‰‹ç»­è´¹ç‡**ï¼š
```
å‡è®¾æ‰‹ç»­è´¹ 0.3%ï¼ŒK å€¼å¢é•¿çº¦ 0.3%
```

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šè®¡ç®—é¢˜è¯¦è§£

### 9. ç­”æ¡ˆï¼šB

**è§£æ**ï¼š
æ— æ‰‹ç»­è´¹å…¬å¼ï¼š
```
amount_out = (reserve_out * amount_in) / (reserve_in + amount_in)
           = (50,000 * 10,000) / (1,000,000 + 10,000)
           = 500,000,000 / 1,010,000
           â‰ˆ 495.05 APT
```

**éªŒè¯ K å€¼ä¸å˜**ï¼š
```
k_before = 1,000,000 * 50,000 = 50,000,000,000
k_after = 1,010,000 * 49,504.95 = 50,000,000,000 âœ“
```

---

### 10. ç­”æ¡ˆï¼šB

**è§£æ**ï¼š
å¸¦æ‰‹ç»­è´¹å…¬å¼ï¼š
```
ç¬¬1æ­¥ï¼šæ‰£é™¤æ‰‹ç»­è´¹
amount_in_with_fee = 10,000 * 997 / 1000 = 9,970

ç¬¬2æ­¥ï¼šè®¡ç®—è¾“å‡º
amount_out = (50,000 * 9,970) / (1,000,000 + 9,970)
           = 498,500,000 / 1,009,970
           â‰ˆ 493.58 APT
```

**ä¸æ— æ‰‹ç»­è´¹å¯¹æ¯”**ï¼š
```
æ— æ‰‹ç»­è´¹è¾“å‡ºï¼š495.05 APT
æœ‰æ‰‹ç»­è´¹è¾“å‡ºï¼š493.58 APT
å·®å¼‚ï¼š495.05 - 493.58 = 1.47 APTï¼ˆçº¦ 0.3%ï¼‰
```

---

### 11. ç­”æ¡ˆï¼šB

**è§£æ**ï¼š
```
åˆå§‹ä»·æ ¼ = 1,000,000 / 50,000 = 20 USDC/APT

æ–°å‚¨å¤‡ï¼š
reserve_x' = 1,010,000 USDC
reserve_y' = 49,506.42 APT

æ–°ä»·æ ¼ = 1,010,000 / 49,506.42 â‰ˆ 20.40 USDC/APT

æ»‘ç‚¹ = (20.40 - 20) / 20 * 100%
     = 0.40 / 20 * 100%
     = 2%
```

---

### 12. ç­”æ¡ˆï¼šB

**è§£æ**ï¼š
```
é¢„æœŸè¾“å‡ºï¼š100 APT
æ»‘ç‚¹å®¹å¿åº¦ï¼š1%

æœ€å°æ¥å—è¾“å‡º = 100 * (1 - 0.01)
              = 100 * 0.99
              = 99 APT
```

**å‰ç«¯å®ç°**ï¼š
```typescript
const expectedOutput = 100;
const slippageTolerance = 1; // 1%
const minAmountOut = expectedOutput * (100 - slippageTolerance) / 100;
// minAmountOut = 99
```

---

### 13. ç­”æ¡ˆï¼šC

**è§£æ**ï¼š
å¤šè·³æ‰‹ç»­è´¹æ˜¯**å¤åˆ**çš„ï¼Œä¸æ˜¯ç®€å•ç›¸åŠ ã€‚

```
ç¬¬ä¸€è·³ï¼šä¿ç•™ 99.7%
ç¬¬äºŒè·³ï¼šä¿ç•™ 99.7% of 99.7% = 99.7% * 99.7%

æ€»ä¿ç•™ = 0.997 * 0.997 = 0.994009
æ€»æ‰‹ç»­è´¹ = 1 - 0.994009 = 0.005991 â‰ˆ 0.6%
```

**n è·³å…¬å¼**ï¼š
```
æ€»ä¿ç•™ = (1 - fee_rate)^n
æ€»æ‰‹ç»­è´¹ = 1 - (1 - fee_rate)^n
```

---

### 14. ç­”æ¡ˆï¼šA

**è§£æ**ï¼š
```
k_old = 50,000,000,000
k_new = 50,001,500,000
Î”k = 1,500,000

å¢é•¿ç‡ = 1,500,000 / 50,000,000,000 * 100%
       = 0.003%
```

è¿™æ°å¥½çº¦ç­‰äºä¸€æ¬¡ 0.3% æ‰‹ç»­è´¹äº¤æ˜“çš„å½±å“ã€‚

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šé«˜çº§åº”ç”¨è¯¦è§£

### 15. ç­”æ¡ˆï¼šA

**è§£æ**ï¼š
**ä¸‰æ˜æ²»æ”»å‡»**æµç¨‹ï¼š
```
1. [æ”»å‡»è€…] Front-run: ä¹°å…¥ â†’ æ¨é«˜ä»·æ ¼
2. [å—å®³è€…] äº¤æ˜“æ‰§è¡Œ â†’ é«˜ä»·æˆäº¤
3. [æ”»å‡»è€…] Back-run: å–å‡º â†’ è·åˆ©
```

**ç¤ºä¾‹**ï¼š
```
åˆå§‹ï¼š1 APT = 20 USDC

1. æ”»å‡»è€…ä¹°å…¥ 500 APTï¼ˆä»·æ ¼å‡è‡³ 20.5 USDCï¼‰
2. ç”¨æˆ·ä¹°å…¥ 1000 APTï¼ˆä»·æ ¼å‡è‡³ 21.2 USDCï¼‰
3. æ”»å‡»è€…å–å‡º 500 APTï¼ˆä»·æ ¼å›è½è‡³ 20.6 USDCï¼‰

æ”»å‡»è€…åˆ©æ¶¦ï¼šçº¦ 300 USDC
ç”¨æˆ·æŸå¤±ï¼šé¢å¤–æ”¯ä»˜çº¦ 1000 USDC
```

---

### 16. ç­”æ¡ˆï¼šC âŒ

**è§£æ**ï¼š
**å¢åŠ æ‰‹ç»­è´¹ç‡**ä¸èƒ½é˜²æ­¢ä¸‰æ˜æ²»æ”»å‡»ï¼Œå› ä¸ºï¼š
- æ”»å‡»è€…ä»ç„¶å¯ä»¥çœ‹åˆ°ä½ çš„äº¤æ˜“
- æ”»å‡»è€…ä»ç„¶å¯ä»¥æ’å…¥äº¤æ˜“
- åªä¼šè®©æ‰€æœ‰äººéƒ½æ”¯ä»˜æ›´å¤šæ‰‹ç»­è´¹

**æœ‰æ•ˆé˜²æŠ¤æ–¹æ³•**ï¼š
- A. è®¾ç½®åˆç†æ»‘ç‚¹ âœ“ï¼ˆé™åˆ¶æ”»å‡»æ”¶ç›Šï¼‰
- B. ç§æœ‰äº¤æ˜“æ±  âœ“ï¼ˆæ”»å‡»è€…çœ‹ä¸åˆ°ï¼‰
- D. Commit-Reveal âœ“ï¼ˆéšè—äº¤æ˜“å†…å®¹ï¼‰

---

### 17. ç­”æ¡ˆï¼šB

**è§£æ**ï¼š
```move
// âŒ å¯èƒ½æº¢å‡º
let result: u64 = reserve_x * reserve_y; 
// å¦‚æœä¸¤ä¸ªéƒ½æ˜¯ 10^9 çº§åˆ«ï¼Œä¹˜ç§¯ä¼šè¶…è¿‡ u64 æœ€å¤§å€¼

// âœ… å®‰å…¨
let result: u128 = (reserve_x as u128) * (reserve_y as u128);
```

**u64 vs u128**ï¼š
- u64 æœ€å¤§å€¼ï¼š18,446,744,073,709,551,615ï¼ˆçº¦ 1.8 * 10^19ï¼‰
- u128 æœ€å¤§å€¼ï¼š3.4 * 10^38

**ä½•æ—¶éœ€è¦ u128**ï¼š
- ä¸¤ä¸ª u64 ç›¸ä¹˜
- å¤§æ•°å€¼è®¡ç®—
- ç²¾åº¦è¦æ±‚é«˜çš„é™¤æ³•

---

### 18. ç­”æ¡ˆï¼šD

**è§£æ**ï¼š
è·¯ç”±é€‰æ‹©çš„é‡è¦å› ç´ æ’åºï¼š
1. **ä»·æ ¼å½±å“ï¼ˆæ»‘ç‚¹ï¼‰** - æœ€ç»ˆç”¨æˆ·å¾—åˆ°å¤šå°‘
2. **æµåŠ¨æ€§æ·±åº¦** - èƒ½å¦å¤„ç†å¤§é¢äº¤æ˜“
3. **ç´¯ç§¯æ‰‹ç»­è´¹** - å¤šè·³ä¼šå¢åŠ æˆæœ¬
4. Gas æˆæœ¬ - å¤šè·³æ¶ˆè€—æ›´å¤š Gas
5. âŒ ä»£å¸åç§° - å®Œå…¨ä¸ç›¸å…³

---

### 19. ç­”æ¡ˆï¼šB

**è§£æ**ï¼š
æ­£ç¡®çš„ K å€¼éªŒè¯ï¼š
```move
let k_before = (reserve_x as u128) * (reserve_y as u128);
// ... æ‰§è¡Œ swap
let k_after = (new_reserve_x as u128) * (new_reserve_y as u128);

// å…è®¸ K å€¼å¢åŠ ï¼ˆå› ä¸ºæ‰‹ç»­è´¹ï¼‰
assert!(k_after >= k_before, ERROR_K_INVARIANT);
```

**ä¸ºä»€ä¹ˆä¸èƒ½å®Œå…¨ç›¸ç­‰**ï¼š
- æ‰‹ç»­è´¹å½’å…¥å‚¨å¤‡ â†’ K å€¼å¢åŠ 
- å¦‚æœå¼ºåˆ¶ç›¸ç­‰ â†’ æ‰‹ç»­è´¹æ— å¤„å¯å»

---

### 20. ç­”æ¡ˆï¼šB

**è§£æ**ï¼š
```move
let amount_in = numerator / denominator + 1;
```

**åŸå› **ï¼šæ•´æ•°é™¤æ³•å‘ä¸‹å–æ•´å¯èƒ½å¯¼è‡´è¾“å…¥ä¸è¶³ã€‚

**ç¤ºä¾‹**ï¼š
```
éœ€è¦è¾“å‡ºï¼š1000
è®¡ç®—ç»“æœï¼š999.7
æ•´æ•°é™¤æ³•ï¼š999ï¼ˆå‘ä¸‹å–æ•´ï¼‰

å¦‚æœåªç”¨ 999ï¼š
å®é™…è¾“å‡º = 999.4 < 1000 âŒ

åŠ  1 åç”¨ 1000ï¼š
å®é™…è¾“å‡º = 1000.1 > 1000 âœ“
```

**trade-off**ï¼š
- ç”¨æˆ·å¯èƒ½å¤šæ”¯ä»˜ 1 å•ä½
- ä½†ä¿è¯äº¤æ˜“æˆåŠŸ
- è¿™æ˜¯å¯æ¥å—çš„ç²¾åº¦æŸå¤±

---

## ğŸ’» ç¼–ç¨‹é¢˜å‚è€ƒç­”æ¡ˆ

### ç¼–ç¨‹é¢˜ 1ï¼šå‚è€ƒå®ç°

```move
module swap_addr::swap_calculator {
    
    const ERROR_ZERO_AMOUNT: u64 = 1;
    const ERROR_INSUFFICIENT_LIQUIDITY: u64 = 2;
    
    const FEE_RATE: u64 = 30;
    const FEE_DENOMINATOR: u64 = 10000;
    
    public fun get_amount_out(
        amount_in: u64,
        reserve_in: u64,
        reserve_out: u64,
    ): u64 {
        // å‚æ•°éªŒè¯
        assert!(amount_in > 0, ERROR_ZERO_AMOUNT);
        assert!(
            reserve_in > 0 && reserve_out > 0, 
            ERROR_INSUFFICIENT_LIQUIDITY
        );
        
        // æ‰£é™¤æ‰‹ç»­è´¹ï¼ˆä½¿ç”¨ u128 é¿å…æº¢å‡ºï¼‰
        let amount_in_with_fee = ((amount_in as u128) * 
            ((FEE_DENOMINATOR - FEE_RATE) as u128)) / 
            (FEE_DENOMINATOR as u128);
        
        // è®¡ç®—è¾“å‡º
        let numerator = amount_in_with_fee * (reserve_out as u128);
        let denominator = (reserve_in as u128) + amount_in_with_fee;
        
        let amount_out = numerator / denominator;
        
        (amount_out as u64)
    }
}
```

**å…³é”®ç‚¹**ï¼š
1. âœ… ä½¿ç”¨ u128 é˜²æ­¢æº¢å‡º
2. âœ… å®Œæ•´çš„å‚æ•°éªŒè¯
3. âœ… å…ˆæ‰£æ‰‹ç»­è´¹ï¼Œå†è®¡ç®—è¾“å‡º
4. âœ… æœ€åè½¬å› u64

---

### ç¼–ç¨‹é¢˜ 2ï¼šå‚è€ƒå®ç°ï¼ˆæ ¸å¿ƒéƒ¨åˆ†ï¼‰

```move
public entry fun swap_exact_input<X, Y>(
    user: &signer,
    amount_in: u64,
    min_amount_out: u64,
) acquires Pool {
    // 1. å‚æ•°éªŒè¯
    assert!(amount_in > 0, ERROR_ZERO_AMOUNT);
    let user_addr = signer::address_of(user);
    
    // 2. è·å–æ± å­
    let pool = borrow_global_mut<Pool<X, Y>>(@swap_addr);
    let reserve_in = coin::value(&pool.reserve_x);
    let reserve_out = coin::value(&pool.reserve_y);
    
    assert!(
        reserve_in > 0 && reserve_out > 0, 
        ERROR_INSUFFICIENT_LIQUIDITY
    );
    
    // 3. è®¡ç®—è¾“å‡º
    let amount_out = calculate_amount_out(
        amount_in, 
        reserve_in, 
        reserve_out
    );
    
    // 4. æ»‘ç‚¹æ£€æŸ¥
    assert!(
        amount_out >= min_amount_out, 
        ERROR_SLIPPAGE_EXCEEDED
    );
    
    // 5. è½¬ç§»ä»£å¸
    let coins_in = coin::withdraw<X>(user, amount_in);
    let coins_out = coin::extract(&mut pool.reserve_y, amount_out);
    
    // 6. æ›´æ–°å‚¨å¤‡
    coin::merge(&mut pool.reserve_x, coins_in);
    coin::deposit(user_addr, coins_out);
    
    // 7. K å€¼éªŒè¯
    verify_k_invariant<X, Y>(reserve_in, reserve_out);
}

fun verify_k_invariant<X, Y>(
    old_reserve_in: u64,
    old_reserve_out: u64,
) acquires Pool {
    let pool = borrow_global<Pool<X, Y>>(@swap_addr);
    let new_reserve_x = coin::value(&pool.reserve_x);
    let new_reserve_y = coin::value(&pool.reserve_y);
    
    let k_old = (old_reserve_in as u128) * (old_reserve_out as u128);
    let k_new = (new_reserve_x as u128) * (new_reserve_y as u128);
    
    assert!(k_new >= k_old, ERROR_K_INVARIANT);
}
```

---

### ç¼–ç¨‹é¢˜ 3ï¼šå‚è€ƒå®ç°

```move
public fun calculate_price_impact(
    amount_in: u64,
    reserve_in: u64,
    reserve_out: u64,
): PriceImpact {
    // è®¡ç®—äº¤æ˜“å‰ä»·æ ¼ï¼ˆ8ä½å°æ•°ï¼‰
    let price_before = ((reserve_out as u128) * 100000000) / 
        (reserve_in as u128);
    
    // è®¡ç®—è¾“å‡º
    let amount_out = get_amount_out(amount_in, reserve_in, reserve_out);
    
    // è®¡ç®—äº¤æ˜“åä»·æ ¼
    let new_reserve_in = reserve_in + amount_in;
    let new_reserve_out = reserve_out - amount_out;
    let price_after = ((new_reserve_out as u128) * 100000000) / 
        (new_reserve_in as u128);
    
    // è®¡ç®—å½±å“ï¼ˆåŸºç‚¹ï¼‰
    let impact_bps = if (price_after > price_before) {
        ((price_after - price_before) * 10000) / price_before
    } else {
        ((price_before - price_after) * 10000) / price_before
    };
    
    PriceImpact {
        price_before: (price_before as u64),
        price_after: (price_after as u64),
        impact_bps: (impact_bps as u64),
        amount_out,
    }
}

public fun recommend_slippage(
    amount_in: u64,
    reserve_in: u64,
    reserve_out: u64,
): u64 {
    let impact = calculate_price_impact(amount_in, reserve_in, reserve_out);
    let amount_out = impact.amount_out;
    
    // æ ¹æ®å½±å“æ¨èæ»‘ç‚¹
    let slippage_bps = if (impact.impact_bps < 100) {
        50  // 0.5%
    } else if (impact.impact_bps < 500) {
        100 // 1%
    } else if (impact.impact_bps < 1000) {
        200 // 2%
    } else {
        500 // 5%
    };
    
    // è®¡ç®— min_amount_out
    ((amount_out as u128) * ((10000 - slippage_bps) as u128) / 
        10000 as u64)
}
```

---

## ğŸ“Š æ€»åˆ†è®¡ç®—

### é€‰æ‹©é¢˜è¯„åˆ†
```
æ­£ç¡®é¢˜æ•°ï¼š____ / 20
å¾—åˆ†ï¼š____ * 2 = ____ / 40
```

### ç¼–ç¨‹é¢˜è¯„åˆ†
```
ç¼–ç¨‹é¢˜ 1ï¼š____ / 20
ç¼–ç¨‹é¢˜ 2ï¼š____ / 25
ç¼–ç¨‹é¢˜ 3ï¼š____ / 15
å°è®¡ï¼š____ / 60
```

### æ€»åˆ†
```
é€‰æ‹©é¢˜ï¼š____ / 40
ç¼–ç¨‹é¢˜ï¼š____ / 60
æ€»åˆ†ï¼š____ / 100
```

---

## ğŸ¯ å­¦ä¹ å»ºè®®

### å¦‚æœæ€»åˆ† 90+
æ­å–œï¼ä½ å·²ç»æ·±å…¥ç†è§£äº† DEX Swap æœºåˆ¶ã€‚
**ä¸‹ä¸€æ­¥**ï¼š
- å­¦ä¹  Day 18: ä»·æ ¼é¢„è¨€æœºé›†æˆ
- ç ”ç©¶å…¶ä»– DEX çš„åˆ›æ–°è®¾è®¡ï¼ˆCurve, Uniswap V3ï¼‰
- å¼€å§‹æ„å»ºè‡ªå·±çš„ DEX é¡¹ç›®

### å¦‚æœæ€»åˆ† 70-89
å¾ˆå¥½ï¼åŸºç¡€å·²ç»æ‰å®ã€‚
**æ”¹è¿›æ–¹å‘**ï¼š
- é‡ç‚¹å¤ä¹ é”™é¢˜
- å¤šåšè®¡ç®—ç»ƒä¹ 
- ä¼˜åŒ–ä»£ç å®ç°

### å¦‚æœæ€»åˆ† < 70
éœ€è¦åŠ å¼ºåŸºç¡€ç†è§£ã€‚
**å»ºè®®**ï¼š
- é‡æ–°å­¦ä¹ ç†è®ºéƒ¨åˆ†
- æ‰‹å·¥æ¨å¯¼æ‰€æœ‰å…¬å¼
- é‡åšæ‰€æœ‰å®è·µä»»åŠ¡
- é˜…è¯»å‚è€ƒå®ç°çš„ä»£ç 

---

**è®°ä½**ï¼šç†è§£åŸç†æ¯”è®°ä½ç­”æ¡ˆæ›´é‡è¦ï¼ğŸš€
