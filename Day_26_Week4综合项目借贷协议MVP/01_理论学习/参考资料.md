# å€Ÿè´·åè®® MVP - å‚è€ƒèµ„æ–™

## ğŸ“š å®˜æ–¹æ–‡æ¡£

### Aptos ç›¸å…³
- [Aptos å¼€å‘è€…æ–‡æ¡£](https://aptos.dev/)
- [Move è¯­è¨€è§„èŒƒ](https://move-language.github.io/move/)
- [Aptos Framework æºç ](https://github.com/aptos-labs/aptos-core/tree/main/aptos-move/framework)
- [Aptos Coin æ ‡å‡†](https://github.com/aptos-labs/aptos-core/blob/main/aptos-move/framework/aptos-framework/sources/coin.move)

### DeFi åè®®å‚è€ƒ

#### Aave
- [Aave V3 æŠ€æœ¯æ–‡æ¡£](https://docs.aave.com/developers/)
- [Aave V3 ç™½çš®ä¹¦](https://github.com/aave/aave-v3-core/blob/master/techpaper/Aave_V3_Technical_Paper.pdf)
- [Aave V3 æºç ](https://github.com/aave/aave-v3-core)

#### Compound
- [Compound åè®®æ–‡æ¡£](https://docs.compound.finance/)
- [Compound ç™½çš®ä¹¦](https://compound.finance/documents/Compound.Whitepaper.pdf)
- [Compound æºç ](https://github.com/compound-finance/compound-protocol)

#### MakerDAO
- [MakerDAO æ–‡æ¡£](https://docs.makerdao.com/)
- [Multi-Collateral Dai ç™½çš®ä¹¦](https://makerdao.com/whitepaper/)

---

## ğŸ“ å­¦ä¹ èµ„æº

### è§†é¢‘æ•™ç¨‹
- [DeFi å€Ÿè´·åŸç†è¯¦è§£](https://www.youtube.com/watch?v=aTp9er6S73M)
- [Aave åè®®æ·±åº¦è§£æ](https://www.youtube.com/watch?v=WwE3lUq51gQ)
- [æ™ºèƒ½åˆçº¦å®‰å…¨æœ€ä½³å®è·µ](https://www.youtube.com/watch?v=P8LXLoTUJ5g)

### æ–‡ç« åšå®¢
- [Understanding Compound Protocol](https://medium.com/compound-finance/faq-1a2636713b69)
- [How Aave Interest Rates Work](https://docs.aave.com/risk/asset-risk/methodology)
- [DeFi Liquidations Explained](https://medium.com/balancer-protocol/a-primer-on-defi-liquidations-5e0c9095c1b7)
- [Flash Loans Deep Dive](https://www.coindesk.com/tech/2020/08/17/defi-flash-loans-explained/)

### ç ”ç©¶è®ºæ–‡
- [SoK: Decentralized Finance (DeFi)](https://arxiv.org/abs/2101.08778)
- [Attacking the DeFi Ecosystem](https://arxiv.org/abs/2002.08099)
- [High-Frequency Trading on Decentralized Exchanges](https://arxiv.org/abs/2009.14021)

---

## ğŸ”§ å¼€å‘å·¥å…·

### Aptos å·¥å…·é“¾
- [Aptos CLI](https://aptos.dev/tools/aptos-cli-tool/use-aptos-cli/)
- [Aptos SDK (TypeScript)](https://www.npmjs.com/package/aptos)
- [Move Analyzer (VS Code)](https://marketplace.visualstudio.com/items?itemName=move.move-analyzer)

### æµ‹è¯•å·¥å…·
- [Aptos Testnet Faucet](https://aptoslabs.com/testnet-faucet)
- [Aptos Explorer](https://explorer.aptoslabs.com/)
- [Aptos Node API](https://fullnode.testnet.aptoslabs.com/v1/spec#/)

### ä»·æ ¼æ•°æ®
- [Pyth Network](https://pyth.network/)
- [Switchboard](https://switchboard.xyz/)
- [CoinGecko API](https://www.coingecko.com/en/api)

---

## ğŸ“Š æ¡ˆä¾‹ç ”ç©¶

### æˆåŠŸæ¡ˆä¾‹

#### 1. Aave V2 â†’ V3 å‡çº§
**æ”¹è¿›ç‚¹**ï¼š
- Portal åŠŸèƒ½ï¼ˆè·¨é“¾æµåŠ¨æ€§ï¼‰
- é«˜æ•ˆæ¨¡å¼ï¼ˆe-Modeï¼‰
- éš”ç¦»æ¨¡å¼ï¼ˆé£é™©éš”ç¦»ï¼‰
- Gas ä¼˜åŒ–ï¼ˆé™ä½ 20-25%ï¼‰

**å­¦ä¹ è¦ç‚¹**ï¼š
- æ¨¡å—åŒ–è®¾è®¡çš„é‡è¦æ€§
- å‘åå…¼å®¹æ€§è€ƒè™‘
- æ¸è¿›å¼åŠŸèƒ½å‡çº§

#### 2. Compound æ²»ç†ä»£å¸
**è®¾è®¡**ï¼š
- ç”¨æˆ·å­˜æ¬¾/å€Ÿæ¬¾è‡ªåŠ¨è·å¾— COMP
- æŠ•ç¥¨æƒä¸ä»£å¸æ•°é‡æŒ‚é’©
- ææ¡ˆå’Œæ—¶é—´é”æœºåˆ¶

**å­¦ä¹ è¦ç‚¹**ï¼š
- æ¿€åŠ±æœºåˆ¶è®¾è®¡
- ç¤¾åŒºæ²»ç†ç»“æ„
- æƒåŠ›åˆ†æ•£åŒ–

### å®‰å…¨äº‹ä»¶

#### 1. bZx é—ªç”µè´·æ”»å‡»ï¼ˆ2020ï¼‰
**æ”»å‡»è¿‡ç¨‹**ï¼š
1. é—ªç”µè´·å€Ÿå‡º 10,000 ETH
2. ä½¿ç”¨ 5,500 ETH åœ¨ Compound ä¸Šåšå¤š ETH
3. ä½¿ç”¨ 3,500 ETH åœ¨ Uniswap æ“çºµä»·æ ¼
4. è§¦å‘é¢„è¨€æœºä»·æ ¼å¼‚å¸¸
5. åœ¨ bZx ä¸Šä»¥é«˜ä»·å–å‡º

**æŸå¤±**ï¼š$350,000

**æ•™è®­**ï¼š
- ä¸è¦ä¾èµ–å•ä¸€ä»·æ ¼æº
- ä½¿ç”¨ TWAP è€Œéå³æ—¶ä»·æ ¼
- è®¾ç½®ä»·æ ¼åå·®é˜ˆå€¼

#### 2. Harvest Finance æ”»å‡»ï¼ˆ2020ï¼‰
**æ”»å‡»è¿‡ç¨‹**ï¼š
1. åœ¨ Curve æ± ä¸­æ“çºµ USDC/USDT ä»·æ ¼
2. åˆ©ç”¨ä»·æ ¼å·®å¼‚åœ¨ Harvest å¥—åˆ©
3. é‡å¤æ“ä½œ 30 å¤šæ¬¡

**æŸå¤±**ï¼š$24,000,000

**æ•™è®­**ï¼š
- å¤§é¢äº¤æ˜“çš„æ»‘ç‚¹ä¿æŠ¤
- ä»·æ ¼æ“çºµæ£€æµ‹
- æµåŠ¨æ€§æ·±åº¦è€ƒè™‘

#### 3. Cream Finance æ”»å‡»ï¼ˆ2021ï¼‰
**æ”»å‡»è¿‡ç¨‹**ï¼š
1. é—ªç”µè´·å€Ÿå‡ºå¤§é‡ä»£å¸
2. åˆ©ç”¨å¯é‡å…¥æ¼æ´
3. å¤šæ¬¡æå–æŠµæŠ¼å“

**æŸå¤±**ï¼š$130,000,000

**æ•™è®­**ï¼š
- ä¸¥æ ¼çš„é‡å…¥ä¿æŠ¤
- Check-Effects-Interactions æ¨¡å¼
- å®Œå–„çš„å®¡è®¡æµç¨‹

---

## ğŸ›¡ï¸ å®‰å…¨æœ€ä½³å®è·µ

### æ™ºèƒ½åˆçº¦å®‰å…¨æ£€æŸ¥æ¸…å•

#### è¾“å…¥éªŒè¯
- [ ] æ‰€æœ‰é‡‘é¢ > 0
- [ ] åœ°å€éé›¶åœ°å€
- [ ] æ•°ç»„é•¿åº¦é™åˆ¶
- [ ] å‚æ•°èŒƒå›´æ£€æŸ¥

#### çŠ¶æ€ç®¡ç†
- [ ] å…ˆæ›´æ–°çŠ¶æ€ï¼Œåå¤–éƒ¨è°ƒç”¨
- [ ] ä½¿ç”¨ Check-Effects-Interactions æ¨¡å¼
- [ ] é¿å…çŠ¶æ€ä¸ä¸€è‡´

#### æ•°å­¦è¿ç®—
- [ ] æº¢å‡º/ä¸‹æº¢æ£€æŸ¥
- [ ] é™¤é›¶æ£€æŸ¥
- [ ] ç²¾åº¦æŸå¤±å¤„ç†
- [ ] èˆå…¥è¯¯å·®æ§åˆ¶

#### è®¿é—®æ§åˆ¶
- [ ] ä¸¥æ ¼çš„æƒé™æ£€æŸ¥
- [ ] å¤šé‡ç­¾åå…³é”®æ“ä½œ
- [ ] æ—¶é—´é”ä¿æŠ¤
- [ ] ç´§æ€¥æš‚åœæœºåˆ¶

#### å¤–éƒ¨è°ƒç”¨
- [ ] é‡å…¥ä¿æŠ¤
- [ ] Gas é™åˆ¶
- [ ] å¤±è´¥å¤„ç†
- [ ] è¿”å›å€¼æ£€æŸ¥

### å®¡è®¡å·¥å…·

#### é™æ€åˆ†æ
- **Move Prover**: å½¢å¼åŒ–éªŒè¯
- **Custom Linters**: è‡ªå®šä¹‰è§„åˆ™æ£€æŸ¥

#### åŠ¨æ€åˆ†æ
- **Fuzzing**: æ¨¡ç³Šæµ‹è¯•
- **Symbolic Execution**: ç¬¦å·æ‰§è¡Œ

#### æ‰‹å·¥å®¡è®¡
- **Code Review**: ä»£ç å®¡æŸ¥
- **Threat Modeling**: å¨èƒå»ºæ¨¡
- **Penetration Testing**: æ¸—é€æµ‹è¯•

---

## ğŸ’¡ è®¾è®¡æ¨¡å¼

### 1. å·¥å‚æ¨¡å¼
```move
module lending_protocol::pool_factory {
    public fun create_lending_pool(
        admin: &signer,
        config: PoolConfig
    ): address {
        // åˆ›å»ºæ–°çš„å€Ÿè´·æ± 
        let pool_address = create_resource_account(admin);
        // åˆå§‹åŒ–é…ç½®
        initialize_pool(pool_address, config);
        pool_address
    }
}
```

### 2. ç­–ç•¥æ¨¡å¼
```move
module lending_protocol::interest_strategy {
    // ä¸åŒçš„åˆ©ç‡ç­–ç•¥
    public fun linear_rate_strategy() { }
    public fun stable_rate_strategy() { }
    public fun variable_rate_strategy() { }
}
```

### 3. è§‚å¯Ÿè€…æ¨¡å¼
```move
module lending_protocol::events {
    // å‘å°„äº‹ä»¶é€šçŸ¥å¤–éƒ¨è§‚å¯Ÿè€…
    public fun emit_deposit_event() { }
    public fun emit_liquidation_event() { }
}
```

### 4. ä»£ç†æ¨¡å¼
```move
module lending_protocol::upgradeable_pool {
    // å¯å‡çº§çš„ä»£ç†åˆçº¦
    struct Proxy has key {
        implementation: address,
        admin: address,
    }
    
    public fun upgrade(
        admin: &signer,
        new_implementation: address
    ) acquires Proxy {
        // å‡çº§å®ç°åˆçº¦
    }
}
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### Gas ä¼˜åŒ–æŠ€å·§

#### 1. å­˜å‚¨ä¼˜åŒ–
```move
// âŒ ä½æ•ˆï¼šåˆ†æ•£å­˜å‚¨
struct User has key {
    deposit1: u64,
    deposit2: u64,
    deposit3: u64,
}

// âœ… é«˜æ•ˆï¼šç´§å‡‘å­˜å‚¨
struct User has key {
    deposits: vector<u64>,
}
```

#### 2. è®¡ç®—ä¼˜åŒ–
```move
// âŒ ä½æ•ˆï¼šé‡å¤è®¡ç®—
fun calculate_multiple_times() {
    let result1 = expensive_calculation();
    let result2 = expensive_calculation(); // é‡å¤
}

// âœ… é«˜æ•ˆï¼šç¼“å­˜ç»“æœ
fun calculate_once() {
    let result = expensive_calculation();
    use_result(result);
    use_result_again(result);
}
```

#### 3. æ‰¹é‡æ“ä½œ
```move
// âœ… æ‰¹é‡æ›´æ–°å¤šä¸ªç”¨æˆ·
public fun batch_update(
    users: vector<address>,
    amounts: vector<u64>
) {
    // ä¸€æ¬¡äº¤æ˜“æ›´æ–°æ‰€æœ‰ç”¨æˆ·
}
```

### æŸ¥è¯¢ä¼˜åŒ–

#### ä½¿ç”¨ç´¢å¼•å™¨
```typescript
// æŸ¥è¯¢ç”¨æˆ·çš„æ‰€æœ‰å­˜æ¬¾å†å²
const deposits = await indexer.queryEvents({
  address: userAddress,
  eventType: "DepositEvent",
  limit: 100
});
```

#### ç¼“å­˜ç­–ç•¥
```typescript
// ç¼“å­˜å¸¸ç”¨æ•°æ®
const priceCache = new Map();

async function getPrice(asset: string): Promise<number> {
  if (priceCache.has(asset)) {
    return priceCache.get(asset);
  }
  
  const price = await fetchPrice(asset);
  priceCache.set(asset, price);
  return price;
}
```

---

## ğŸŒ ç”Ÿæ€ç³»ç»Ÿé›†æˆ

### é¢„è¨€æœºé›†æˆ

#### Pyth Network
```move
use pyth::price_feed;

public fun get_pyth_price(price_id: vector<u8>): (u64, u64) {
    let price_info = price_feed::get_price(price_id);
    (price_info.price, price_info.confidence)
}
```

#### Switchboard
```move
use switchboard::aggregator;

public fun get_switchboard_price(aggregator_addr: address): u128 {
    aggregator::latest_value(aggregator_addr)
}
```

### é’±åŒ…é›†æˆ

#### Petra Wallet
```typescript
import { AptosClient } from "aptos";

async function connectWallet() {
  if ('aptos' in window) {
    const wallet = window.aptos;
    await wallet.connect();
    return wallet.account();
  }
}
```

#### Martian Wallet
```typescript
async function connectMartian() {
  const martian = window.martian;
  await martian.connect();
  return await martian.account();
}
```

---

## ğŸ“– å»¶ä¼¸é˜…è¯»

### DeFi ç†è®º
- [DeFi çš„æ¼”è¿›å†ç¨‹](https://ethereum.org/en/defi/)
- [æµåŠ¨æ€§æŒ–çŸ¿æœºåˆ¶](https://blog.coinbase.com/a-beginners-guide-to-decentralized-finance-defi-574c68ff43c4)
- [æ²»ç†ä»£å¸ç»æµå­¦](https://www.paradigm.xyz/2020/10/liquidity-mining)

### Move è¯­è¨€
- [Move è®¾è®¡ç†å¿µ](https://developers.diem.com/docs/technical-papers/move-paper/)
- [èµ„æºä¸æ‰€æœ‰æƒ](https://move-book.com/advanced-topics/ownership-and-references.html)
- [æ³›å‹ç¼–ç¨‹](https://move-book.com/advanced-topics/generics.html)

### åŒºå—é“¾å®‰å…¨
- [æ™ºèƒ½åˆçº¦å®‰å…¨æœ€ä½³å®è·µ](https://consensys.github.io/smart-contract-best-practices/)
- [DeFi å®‰å…¨æ¡†æ¶](https://www.defisafety.com/)
- [æ¼æ´æ¡ˆä¾‹åº“](https://github.com/rekt-news)

---

## ğŸ¯ å®è·µé¡¹ç›®å»ºè®®

### åˆçº§é¡¹ç›®
1. **ç®€å•å­˜æ¬¾ç³»ç»Ÿ**
   - å•ä¸€èµ„äº§å­˜å–æ¬¾
   - å›ºå®šåˆ©ç‡
   - åŸºç¡€ç”¨æˆ·ç•Œé¢

2. **åˆ©ç‡è®¡ç®—å™¨**
   - ä¸åŒåˆ©ç‡æ¨¡å‹å¯¹æ¯”
   - å¯è§†åŒ–åˆ©ç‡æ›²çº¿
   - å‚æ•°è°ƒæ•´å·¥å…·

### ä¸­çº§é¡¹ç›®
1. **å¤šèµ„äº§å€Ÿè´·æ± **
   - æ”¯æŒ 3-5 ç§èµ„äº§
   - åŠ¨æ€åˆ©ç‡
   - å¥åº·å› å­ç›‘æ§

2. **æ¸…ç®—æœºå™¨äºº**
   - ç›‘æ§ä¸å¥åº·è´¦æˆ·
   - è‡ªåŠ¨è§¦å‘æ¸…ç®—
   - ç›ˆåˆ©è®¡ç®—

### é«˜çº§é¡¹ç›®
1. **å®Œæ•´ DeFi å¹³å°**
   - å€Ÿè´· + DEX
   - æµåŠ¨æ€§æŒ–çŸ¿
   - DAO æ²»ç†

2. **è·¨é“¾å€Ÿè´·æ¡¥**
   - Aptos â†” Ethereum
   - æµåŠ¨æ€§å…±äº«
   - è·¨é“¾æ¸…ç®—

---

## ğŸ“ ç¤¾åŒºèµ„æº

### å®˜æ–¹ç¤¾åŒº
- [Aptos Discord](https://discord.gg/aptoslabs)
- [Aptos Forum](https://forum.aptoslabs.com/)
- [Aptos GitHub Discussions](https://github.com/aptos-labs/aptos-core/discussions)

### å¼€å‘è€…ç¤¾åŒº
- [Move å¼€å‘è€…ç¾¤](https://t.me/move_language)
- [Aptos ä¸­æ–‡ç¤¾åŒº](https://discord.gg/aptos-china)
- [DeFi å¼€å‘è€…è®ºå›](https://www.reddit.com/r/defi/)

### å­¦ä¹ å¹³å°
- [Aptos Learn](https://learn.aptoslabs.com/)
- [Move Book](https://move-book.com/)
- [DeFi æ•™ç¨‹](https://www.youtube.com/@DeFiDeveloper)

---

## ğŸ† è¿›é˜¶æ–¹å‘

å®Œæˆæœ¬é¡¹ç›®åï¼Œä½ å¯ä»¥ç»§ç»­å­¦ä¹ ï¼š

### Week 5 é¢„ä¹ 
- Aptos äº¤æ˜“ç»“æ„
- Mempool ç›‘æ§
- MEV æœºä¼šè¯†åˆ«
- å¥—åˆ©æœºå™¨äººå¼€å‘

### é•¿æœŸç›®æ ‡
- æˆä¸º DeFi åè®®æ¶æ„å¸ˆ
- æ™ºèƒ½åˆçº¦å®‰å…¨å®¡è®¡å¸ˆ
- MEV ç­–ç•¥å¼€å‘è€…
- DeFi äº§å“ç»ç†

---

**æŒç»­å­¦ä¹ ï¼Œä¸æ–­è¿›æ­¥ï¼åŠ æ²¹ï¼ğŸš€**
