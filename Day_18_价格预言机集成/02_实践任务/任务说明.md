# å®è·µä»»åŠ¡ï¼šä»·æ ¼é¢„è¨€æœºé›†æˆ

## ğŸ“‹ ä»»åŠ¡æ¦‚è¿°

ä»Šå¤©ä½ å°†å®ç°ä¸€ä¸ªå®Œæ•´çš„ä»·æ ¼é¢„è¨€æœºç³»ç»Ÿï¼ŒåŒ…æ‹¬ï¼š
1. Pyth ä»·æ ¼è·å–æ¨¡å—
2. Switchboard ä»·æ ¼è·å–æ¨¡å—
3. å¤šæºä»·æ ¼èšåˆå™¨
4. åœ¨ DEX ä¸­é›†æˆé¢„è¨€æœº

**æ€»æ—¶é—´**: 3 å°æ—¶  
**éš¾åº¦**: â­â­â­â­

---

## ğŸ¯ ä»»åŠ¡ä¸€ï¼šPyth ä»·æ ¼è·å–ï¼ˆ60 åˆ†é’Ÿï¼‰

### ä»»åŠ¡æè¿°

å®ç°ä¸€ä¸ª Pyth é¢„è¨€æœºé›†æˆæ¨¡å—ï¼Œèƒ½å¤Ÿå®‰å…¨åœ°è·å–å’ŒéªŒè¯ä»·æ ¼æ•°æ®ã€‚

### åŠŸèƒ½è¦æ±‚

1. **ä»·æ ¼è·å–**
   - ä» Pyth è·å–æŒ‡å®šèµ„äº§çš„ä»·æ ¼
   - æ”¯æŒ BTC/USD, ETH/USD, APT/USD

2. **ä»·æ ¼éªŒè¯**
   - æ£€æŸ¥ä»·æ ¼æ–°é²œåº¦ï¼ˆ<60ç§’ï¼‰
   - éªŒè¯ç½®ä¿¡åŒºé—´ï¼ˆ<1%ï¼‰
   - å¤„ç†ä»·æ ¼æ ¼å¼è½¬æ¢

3. **é”™è¯¯å¤„ç†**
   - ä»·æ ¼è¿‡æœŸ
   - ç½®ä¿¡åº¦è¿‡ä½
   - æ— æ•ˆä»·æ ¼

### æ¥å£å®šä¹‰

```move
module day18_task::pyth_oracle {
    /// åˆå§‹åŒ–ä»·æ ¼ Feed
    public entry fun initialize_price_feed(
        admin: &signer,
        feed_id: vector<u8>,
        max_price_age: u64,
        max_confidence_bp: u64,
        decimals: u8
    )
    
    /// è·å–éªŒè¯è¿‡çš„ä»·æ ¼
    /// @return (price, timestamp)
    public fun get_validated_price(
        feed_id: vector<u8>,
        max_price_age: u64,
        max_confidence_bp: u64
    ): (u64, u64)
    
    /// è·å– BTC/USD ä»·æ ¼
    #[view]
    public fun get_btc_usd_price(): (u64, u64)
    
    /// è·å– ETH/USD ä»·æ ¼
    #[view]
    public fun get_eth_usd_price(): (u64, u64)
    
    /// è·å– APT/USD ä»·æ ¼
    #[view]
    public fun get_apt_usd_price(): (u64, u64)
    
    /// æ‰¹é‡è·å–ä»·æ ¼
    #[view]
    public fun get_multiple_prices(
        feed_ids: vector<vector<u8>>
    ): vector<(u64, u64)>
}
```

### æµ‹è¯•ç”¨ä¾‹

```move
#[test_only]
module day18_task::pyth_oracle_test {
    use day18_task::pyth_oracle;
    
    #[test]
    fun test_get_btc_price() {
        let (price, timestamp) = pyth_oracle::get_btc_usd_price();
        assert!(price > 0, 0);
        assert!(timestamp > 0, 1);
    }
    
    #[test]
    fun test_price_validation() {
        let feed_id = x"e62df6...";
        let (price, _) = pyth_oracle::get_validated_price(
            feed_id,
            60,   // max age
            100   // max confidence bp (1%)
        );
        assert!(price > 0, 0);
    }
    
    #[test]
    #[expected_failure(abort_code = ERROR_STALE_PRICE)]
    fun test_stale_price_fails() {
        let feed_id = x"e62df6...";
        // ä½¿ç”¨å¾ˆå°çš„ max_ageï¼Œåº”è¯¥å¤±è´¥
        pyth_oracle::get_validated_price(feed_id, 1, 100);
    }
}
```

### å®ç°æç¤º

1. **ä»·æ ¼æ ¼å¼è½¬æ¢**
   ```move
   // Pyth ä»·æ ¼ï¼šprice * 10^expo
   // ç›®æ ‡æ ¼å¼ï¼š6 decimals
   fun convert_price(price: u64, expo: i64): u64 {
       // å¤„ç†æ­£è´Ÿ expo
       // è½¬æ¢ä¸ºæ ‡å‡† 6 decimals æ ¼å¼
   }
   ```

2. **æ–°é²œåº¦æ£€æŸ¥**
   ```move
   let current_time = timestamp::now_seconds();
   assert!(current_time - price_timestamp <= max_age, ERROR_STALE_PRICE);
   ```

3. **ç½®ä¿¡åº¦æ£€æŸ¥**
   ```move
   let confidence_bp = (confidence as u128) * 10000 / (price as u128);
   assert!(confidence_bp <= max_confidence_bp, ERROR_LOW_CONFIDENCE);
   ```

### éªŒæ”¶æ ‡å‡†

- [ ] èƒ½å¤ŸæˆåŠŸè·å– BTC/USD ä»·æ ¼
- [ ] ä»·æ ¼æ–°é²œåº¦æ£€æŸ¥ç”Ÿæ•ˆ
- [ ] ç½®ä¿¡åº¦éªŒè¯æ­£ç¡®
- [ ] ä»·æ ¼æ ¼å¼è½¬æ¢æ­£ç¡®ï¼ˆ6 decimalsï¼‰
- [ ] æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹é€šè¿‡

---

## ğŸ¯ ä»»åŠ¡äºŒï¼šSwitchboard é›†æˆï¼ˆ45 åˆ†é’Ÿï¼‰

### ä»»åŠ¡æè¿°

å®ç° Switchboard é¢„è¨€æœºé›†æˆï¼Œä½œä¸º Pyth çš„å¤‡é€‰æ–¹æ¡ˆã€‚

### åŠŸèƒ½è¦æ±‚

1. **èšåˆå™¨é…ç½®**
   - å­˜å‚¨èšåˆå™¨åœ°å€
   - é…ç½®æœ€å¤§ä»·æ ¼å¹´é¾„

2. **ä»·æ ¼è·å–**
   - ä» Switchboard è¯»å–ä»·æ ¼
   - éªŒè¯èšåˆå™¨çŠ¶æ€

3. **éªŒè¯æœºåˆ¶**
   - æ£€æŸ¥èšåˆå™¨æ˜¯å¦æ´»è·ƒ
   - éªŒè¯ä»·æ ¼æ–°é²œåº¦

### æ¥å£å®šä¹‰

```move
module day18_task::switchboard_oracle {
    /// åˆå§‹åŒ–èšåˆå™¨é…ç½®
    public entry fun initialize_aggregator(
        admin: &signer,
        aggregator_addr: address,
        max_price_age: u64,
        name: vector<u8>
    )
    
    /// è·å–éªŒè¯è¿‡çš„ä»·æ ¼
    /// @return (price, timestamp)
    public fun get_validated_price(
        aggregator_addr: address,
        max_price_age: u64
    ): (u64, u64)
    
    /// æ£€æŸ¥èšåˆå™¨æ˜¯å¦æ´»è·ƒ
    #[view]
    public fun is_aggregator_active(
        aggregator_addr: address
    ): bool
    
    /// è·å–èšåˆå™¨çŠ¶æ€
    #[view]
    public fun get_aggregator_info(
        aggregator_addr: address
    ): (u128, u64, bool)  // (value, timestamp, is_active)
}
```

### æµ‹è¯•ç”¨ä¾‹

```move
#[test]
fun test_switchboard_price() {
    let aggregator_addr = @0x123;
    let (price, timestamp) = switchboard_oracle::get_validated_price(
        aggregator_addr,
        300  // 5 minutes max age
    );
    assert!(price > 0, 0);
    assert!(timestamp > 0, 1);
}

#[test]
fun test_aggregator_active() {
    let aggregator_addr = @0x123;
    let is_active = switchboard_oracle::is_aggregator_active(aggregator_addr);
    assert!(is_active, 0);
}
```

### å®ç°æç¤º

1. **å­˜å‚¨ç»“æ„**
   ```move
   struct AggregatorConfig has key {
       aggregator_addr: address,
       max_price_age: u64,
       name: vector<u8>,
   }
   ```

2. **çŠ¶æ€æ£€æŸ¥**
   ```move
   assert!(is_aggregator_active(addr), ERROR_AGGREGATOR_INACTIVE);
   ```

### éªŒæ”¶æ ‡å‡†

- [ ] èƒ½å¤ŸæˆåŠŸé…ç½®èšåˆå™¨
- [ ] ä»·æ ¼è·å–æ­£å¸¸å·¥ä½œ
- [ ] èšåˆå™¨çŠ¶æ€æ£€æŸ¥æœ‰æ•ˆ
- [ ] æ–°é²œåº¦éªŒè¯æ­£ç¡®
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡

---

## ğŸ¯ ä»»åŠ¡ä¸‰ï¼šå¤šæºä»·æ ¼èšåˆå™¨ï¼ˆ60 åˆ†é’Ÿï¼‰

### ä»»åŠ¡æè¿°

å®ç°ä¸€ä¸ªå¼ºå¤§çš„ä»·æ ¼èšåˆå™¨ï¼Œæ”¯æŒå¤šç§èšåˆç­–ç•¥å’Œå¼‚å¸¸å€¼æ£€æµ‹ã€‚

### åŠŸèƒ½è¦æ±‚

1. **å¤šæºé›†æˆ**
   - åŒæ—¶ä» Pyth å’Œ Switchboard è·å–ä»·æ ¼
   - æ”¯æŒé…ç½®å¤šä¸ªä»·æ ¼æº

2. **èšåˆç®—æ³•**
   - ä¸­ä½æ•°èšåˆ
   - åŠ æƒå¹³å‡
   - ç®—æœ¯å¹³å‡

3. **å®‰å…¨æ£€æŸ¥**
   - æœ€å°‘æºæ•°é‡éªŒè¯
   - ä»·æ ¼åå·®æ£€æŸ¥
   - å¼‚å¸¸å€¼è¿‡æ»¤

### æ¥å£å®šä¹‰

```move
module day18_task::price_aggregator {
    /// åˆå§‹åŒ–èšåˆå™¨
    public entry fun initialize_aggregator(
        admin: &signer,
        asset_name: vector<u8>,
        aggregation_method: u8,  // 0=median, 1=mean, 2=weighted
        max_deviation_bp: u64,   // basis points
        min_sources: u64
    )
    
    /// æ·»åŠ ä»·æ ¼æº
    public entry fun add_price_source(
        admin: &signer,
        asset_name: vector<u8>,
        source_type: u8,       // 0=Pyth, 1=Switchboard
        identifier: vector<u8>,
        weight: u64
    )
    
    /// è·å–èšåˆä»·æ ¼
    /// @return (price, oldest_timestamp)
    public fun get_aggregated_price(
        asset_name: vector<u8>,
        aggregator_owner: address
    ): (u64, u64)
    
    /// è®¡ç®—ä¸­ä½æ•°
    public fun aggregate_median(prices: vector<u64>): u64
    
    /// è®¡ç®—å¹³å‡å€¼
    public fun aggregate_mean(prices: &vector<u64>): u64
    
    /// è®¡ç®—åŠ æƒå¹³å‡
    public fun aggregate_weighted_mean(
        prices: &vector<u64>,
        weights: &vector<u64>
    ): u64
    
    /// è®¡ç®—ä»·æ ¼åå·®
    public fun calculate_deviation(price1: u64, price2: u64): u64
}
```

### æµ‹è¯•ç”¨ä¾‹

```move
#[test]
fun test_median_aggregation() {
    let prices = vector[100, 102, 105, 103, 1000];  // 1000 æ˜¯å¼‚å¸¸å€¼
    let median = price_aggregator::aggregate_median(prices);
    assert!(median == 103, 0);  // ä¸­ä½æ•°ä¸å—å¼‚å¸¸å€¼å½±å“
}

#[test]
fun test_weighted_average() {
    let prices = vector[100, 110];
    let weights = vector[70, 30];  // Pyth 70%, Switchboard 30%
    let avg = price_aggregator::aggregate_weighted_mean(&prices, &weights);
    assert!(avg == 103, 0);  // (100*70 + 110*30) / 100
}

#[test]
fun test_aggregated_price() {
    // è®¾ç½®èšåˆå™¨
    let admin = account::create_account_for_test(@0xcafe);
    price_aggregator::initialize_aggregator(
        &admin,
        b"BTC/USD",
        0,      // median
        500,    // 5% max deviation
        2       // min 2 sources
    );
    
    // æ·»åŠ ä»·æ ¼æº
    price_aggregator::add_price_source(
        &admin,
        b"BTC/USD",
        0,  // Pyth
        x"e62df6...",
        50
    );
    
    // è·å–ä»·æ ¼
    let (price, _) = price_aggregator::get_aggregated_price(
        b"BTC/USD",
        @0xcafe
    );
    assert!(price > 0, 0);
}

#[test]
#[expected_failure(abort_code = ERROR_PRICE_DEVIATION_TOO_HIGH)]
fun test_deviation_check_fails() {
    // ä»·æ ¼åå·®è¶…è¿‡ 5% åº”è¯¥å¤±è´¥
    let prices = vector[100, 200];  // 100% åå·®
    // ... æµ‹è¯•ä»£ç 
}
```

### å®ç°æç¤º

1. **æ’åºç®—æ³•**
   ```move
   fun sort_prices(prices: &mut vector<u64>) {
       // å†’æ³¡æ’åº
       let len = vector::length(prices);
       let i = 0;
       while (i < len) {
           let j = 0;
           while (j < len - i - 1) {
               if (*vector::borrow(prices, j) > *vector::borrow(prices, j + 1)) {
                   vector::swap(prices, j, j + 1);
               };
               j = j + 1;
           };
           i = i + 1;
       };
   }
   ```

2. **åå·®è®¡ç®—**
   ```move
   fun calculate_deviation(p1: u64, p2: u64): u64 {
       let diff = if (p1 > p2) { p1 - p2 } else { p2 - p1 };
       let base = if (p1 > p2) { p2 } else { p1 };
       ((diff as u128) * 10000 / (base as u128) as u64)
   }
   ```

3. **åå·®éªŒè¯**
   ```move
   fun verify_price_deviation(
       prices: &vector<u64>,
       final_price: u64,
       max_deviation_bp: u64
   ) {
       let i = 0;
       while (i < vector::length(prices)) {
           let price = *vector::borrow(prices, i);
           let deviation = calculate_deviation(price, final_price);
           assert!(deviation <= max_deviation_bp, ERROR_DEVIATION_TOO_HIGH);
           i = i + 1;
       };
   }
   ```

### éªŒæ”¶æ ‡å‡†

- [ ] ä¸­ä½æ•°èšåˆæ­£ç¡®å®ç°
- [ ] åŠ æƒå¹³å‡è®¡ç®—æ­£ç¡®
- [ ] ä»·æ ¼åå·®æ£€æŸ¥æœ‰æ•ˆ
- [ ] æ”¯æŒå¤šä¸ªä»·æ ¼æº
- [ ] å¼‚å¸¸å€¼èƒ½è¢«æ­£ç¡®å¤„ç†
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡

---

## ğŸ¯ ä»»åŠ¡å››ï¼šé›†æˆåˆ° DEXï¼ˆ15 åˆ†é’Ÿï¼‰

### ä»»åŠ¡æè¿°

å°†é¢„è¨€æœºé›†æˆåˆ°ä¹‹å‰çš„ DEX ä¸­ï¼Œæä¾›ä»·æ ¼å±•ç¤ºåŠŸèƒ½ã€‚

### åŠŸèƒ½è¦æ±‚

1. **TVL è®¡ç®—**
   - ä½¿ç”¨é¢„è¨€æœºä»·æ ¼è®¡ç®—æ± å­æ€»ä»·å€¼

2. **ä»·æ ¼å±•ç¤º**
   - æ˜¾ç¤ºäº¤æ˜“å¯¹çš„ç¾å…ƒä»·æ ¼
   - è®¡ç®—æ±‡ç‡

### æ¥å£å®šä¹‰

```move
module day18_task::dex_with_oracle {
    /// è·å–æ± å­ TVLï¼ˆç¾å…ƒä»·å€¼ï¼‰
    #[view]
    public fun get_pool_tvl<X, Y>(
        oracle_addr: address
    ): u64
    
    /// è·å–æ±‡ç‡ï¼ˆX/Y çš„ç¾å…ƒä»·å€¼æ¯”ï¼‰
    #[view]
    public fun get_exchange_rate_in_usd<X, Y>(
        oracle_addr: address
    ): u64
    
    /// è·å–ä»£å¸ç¾å…ƒä»·æ ¼
    #[view]
    public fun get_token_price_usd<X>(
        oracle_addr: address
    ): u64
}
```

### æµ‹è¯•ç”¨ä¾‹

```move
#[test]
fun test_pool_tvl() {
    // å‡è®¾æ± å­æœ‰ 10 BTC å’Œ 450,000 USDC
    // BTC ä»·æ ¼ $45,000
    // TVL = 10 * 45,000 + 450,000 = $900,000
    let tvl = dex_with_oracle::get_pool_tvl<BTC, USDC>(@oracle);
    assert!(tvl == 900_000_000000, 0);  // 6 decimals
}
```

### éªŒæ”¶æ ‡å‡†

- [ ] TVL è®¡ç®—æ­£ç¡®
- [ ] æ±‡ç‡è®¡ç®—æ­£ç¡®
- [ ] ä»·æ ¼æŸ¥è¯¢æ¥å£å·¥ä½œæ­£å¸¸

---

## ğŸ“¦ å¯åŠ¨ä»£ç 

åœ¨ `sources/` ç›®å½•ä¸‹åˆ›å»ºä»¥ä¸‹æ–‡ä»¶ï¼š

### pyth_oracle.move
```move
module day18_task::pyth_oracle {
    // TODO: å®ç° Pyth é›†æˆ
}
```

### switchboard_oracle.move
```move
module day18_task::switchboard_oracle {
    // TODO: å®ç° Switchboard é›†æˆ
}
```

### price_aggregator.move
```move
module day18_task::price_aggregator {
    // TODO: å®ç°ä»·æ ¼èšåˆå™¨
}
```

### dex_with_oracle.move
```move
module day18_task::dex_with_oracle {
    // TODO: é›†æˆé¢„è¨€æœºåˆ° DEX
}
```

---

## ğŸ§ª æµ‹è¯•æŒ‡å—

### è¿è¡Œæµ‹è¯•

```bash
# æµ‹è¯• Pyth Oracle
aptos move test --filter pyth_oracle

# æµ‹è¯• Switchboard Oracle
aptos move test --filter switchboard_oracle

# æµ‹è¯•ä»·æ ¼èšåˆå™¨
aptos move test --filter price_aggregator

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
aptos move test
```

### æµ‹è¯•è¦†ç›–ç‡

ç¡®ä¿æµ‹è¯•è¦†ç›–ï¼š
- [ ] æ­£å¸¸æµç¨‹
- [ ] è¾¹ç•Œæƒ…å†µï¼ˆä»·æ ¼ä¸º 0ï¼Œè¿‡æœŸç­‰ï¼‰
- [ ] é”™è¯¯æƒ…å†µï¼ˆæ‰€æœ‰ assert è·¯å¾„ï¼‰
- [ ] æ•°å­¦è®¡ç®—æ­£ç¡®æ€§

---

## âœ… å®Œæˆæ£€æŸ¥æ¸…å•

### ä»»åŠ¡ä¸€ï¼šPyth Oracle
- [ ] å®ç°ä»·æ ¼è·å–å‡½æ•°
- [ ] å®ç°ä»·æ ¼éªŒè¯é€»è¾‘
- [ ] å®ç°ä»·æ ¼æ ¼å¼è½¬æ¢
- [ ] ç¼–å†™è‡³å°‘ 5 ä¸ªæµ‹è¯•ç”¨ä¾‹
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡

### ä»»åŠ¡äºŒï¼šSwitchboard Oracle
- [ ] å®ç°èšåˆå™¨é…ç½®
- [ ] å®ç°ä»·æ ¼è·å–
- [ ] å®ç°çŠ¶æ€æ£€æŸ¥
- [ ] ç¼–å†™è‡³å°‘ 3 ä¸ªæµ‹è¯•ç”¨ä¾‹
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡

### ä»»åŠ¡ä¸‰ï¼šä»·æ ¼èšåˆå™¨
- [ ] å®ç°ä¸­ä½æ•°ç®—æ³•
- [ ] å®ç°åŠ æƒå¹³å‡ç®—æ³•
- [ ] å®ç°åå·®æ£€æŸ¥
- [ ] å®ç°å¤šæºé›†æˆ
- [ ] ç¼–å†™è‡³å°‘ 8 ä¸ªæµ‹è¯•ç”¨ä¾‹
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡

### ä»»åŠ¡å››ï¼šDEX é›†æˆ
- [ ] å®ç° TVL è®¡ç®—
- [ ] å®ç°æ±‡ç‡æŸ¥è¯¢
- [ ] ç¼–å†™æµ‹è¯•ç”¨ä¾‹
- [ ] é›†æˆæµ‹è¯•é€šè¿‡

---

## ğŸ’¡ å®ç°æŠ€å·§

### 1. ä½¿ç”¨ u128 é¿å…æº¢å‡º

```move
// âŒ å¯èƒ½æº¢å‡º
let result = (a * b) / c;

// âœ… ä½¿ç”¨ u128
let result = ((a as u128) * (b as u128) / (c as u128) as u64);
```

### 2. å¤„ç†é™¤é›¶é”™è¯¯

```move
assert!(denominator > 0, ERROR_DIVISION_BY_ZERO);
let result = numerator / denominator;
```

### 3. ç²¾åº¦å¤„ç†

```move
// å…ˆä¹˜åé™¤ä¿æŒç²¾åº¦
let result = (value * multiplier) / divisor;

// ä¸è¦å…ˆé™¤åä¹˜
// let result = (value / divisor) * multiplier;  // æŸå¤±ç²¾åº¦ï¼
```

### 4. æ’åºä¼˜åŒ–

```move
// å¯¹äºå°æ•°ç»„ï¼Œå†’æ³¡æ’åºå°±å¤Ÿäº†
// å¯¹äºå¤§æ•°ç»„ï¼Œè€ƒè™‘å¿«é€Ÿæ’åº
```

---

## ğŸ“ æäº¤è¦æ±‚

å®Œæˆåæäº¤ï¼š

1. **æºä»£ç **
   - `sources/pyth_oracle.move`
   - `sources/switchboard_oracle.move`
   - `sources/price_aggregator.move`
   - `sources/dex_with_oracle.move`

2. **æµ‹è¯•ä»£ç **
   - `tests/pyth_oracle_test.move`
   - `tests/switchboard_test.move`
   - `tests/aggregator_test.move`
   - `tests/dex_oracle_test.move`

3. **æµ‹è¯•ç»“æœæˆªå›¾**
   - æ‰€æœ‰æµ‹è¯•é€šè¿‡çš„æˆªå›¾

4. **å®ç°æ€»ç»“**
   - é‡åˆ°çš„å›°éš¾å’Œè§£å†³æ–¹æ¡ˆ
   - å…³é”®å®ç°æ€è·¯
   - æ€§èƒ½ä¼˜åŒ–ç‚¹

---

## ğŸ¯ åŠ åˆ†é¡¹ï¼ˆå¯é€‰ï¼‰

1. **TWAP å®ç°**
   - å®ç°æ—¶é—´åŠ æƒå¹³å‡ä»·æ ¼
   - é˜²æ­¢é—ªç”µè´·æ”»å‡»

2. **æ–­è·¯å™¨æ¨¡å¼**
   - ä»·æ ¼å‰§çƒˆæ³¢åŠ¨æ—¶è‡ªåŠ¨æš‚åœ
   - ç®¡ç†å‘˜æ¢å¤åŠŸèƒ½

3. **ä»·æ ¼å†å²è®°å½•**
   - å­˜å‚¨å†å²ä»·æ ¼
   - æ”¯æŒå†å²æŸ¥è¯¢

4. **Gas ä¼˜åŒ–**
   - ä¼˜åŒ–å­˜å‚¨ç»“æ„
   - å‡å°‘è®¡ç®—å¤æ‚åº¦

5. **æ‰¹é‡æ“ä½œ**
   - æ‰¹é‡è·å–å¤šä¸ªèµ„äº§ä»·æ ¼
   - æ‰¹é‡æ›´æ–°

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•å¤„ç† Pyth çš„ i64 ç±»å‹ï¼Ÿ

```move
// Pyth ä½¿ç”¨æœ‰ç¬¦å·æ•´æ•°ï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†
use pyth::i64;

let magnitude = i64::get_magnitude_if_positive(&price);
let magnitude_neg = i64::get_magnitude_if_negative(&expo);
```

### Q2: å¦‚ä½•æµ‹è¯•é¢„è¨€æœºï¼ˆæ²¡æœ‰çœŸå®æ•°æ®ï¼‰ï¼Ÿ

```move
// ä½¿ç”¨æ¨¡æ‹Ÿå®ç°
fun get_mock_price(): u64 {
    45000_000000  // $45,000 with 6 decimals
}
```

### Q3: å¦‚ä½•å¤„ç†ä¸åŒçš„ decimalsï¼Ÿ

```move
fun normalize_decimals(value: u64, from_decimals: u8, to_decimals: u8): u64 {
    if (from_decimals == to_decimals) {
        return value
    };
    
    if (from_decimals > to_decimals) {
        let diff = from_decimals - to_decimals;
        value / pow(10, diff)
    } else {
        let diff = to_decimals - from_decimals;
        value * pow(10, diff)
    }
}
```

---

**é¢„è®¡å®Œæˆæ—¶é—´**: 3 å°æ—¶  
**å¼€å§‹æ—¶é—´**: _______  
**å®Œæˆæ—¶é—´**: _______

**ç¥ä½ å¥½è¿ï¼ğŸš€**
