# Day 06 æ¯æ—¥è€ƒè¯• - ç­”æ¡ˆè§£æ

## é€‰æ‹©é¢˜ç­”æ¡ˆï¼ˆ50 åˆ†ï¼‰

---

### ç¬¬ 1 é¢˜ï¼šé”™è¯¯çš„èƒ½åŠ›å£°æ˜

**æ­£ç¡®ç­”æ¡ˆï¼šD**

**è§£æï¼š**
```move
D. struct Token has copy, store { amount: u64 }
```

è¿™ä¸ªå£°æ˜æ˜¯**é”™è¯¯**çš„ï¼Œå› ä¸ºä»£å¸ç±»å‹ä¸åº”è¯¥æœ‰ `copy` èƒ½åŠ›ã€‚å¦‚æœä»£å¸å¯ä»¥è¢«å¤åˆ¶ï¼Œå°±ä¼šå¯¼è‡´åŒèŠ±é—®é¢˜ã€‚

- **é€‰é¡¹ A**ï¼šâœ… é…ç½®æ•°æ®å¯ä»¥æœ‰æ‰€æœ‰èƒ½åŠ›
- **é€‰é¡¹ B**ï¼šâœ… ä»£å¸åªæœ‰ store èƒ½åŠ›ï¼Œæ­£ç¡®
- **é€‰é¡¹ C**ï¼šâœ… è´¦æˆ·ä½œä¸ºå…¨å±€èµ„æºéœ€è¦ key èƒ½åŠ›
- **é€‰é¡¹ D**ï¼šâŒ ä»£å¸æœ‰ copy èƒ½åŠ›æ˜¯å±é™©çš„

**çŸ¥è¯†ç‚¹**ï¼šèƒ½åŠ›ç³»ç»Ÿçš„å®‰å…¨æ€§åŸåˆ™

---

### ç¬¬ 2 é¢˜ï¼šæ‰€æœ‰æƒç§»åŠ¨

**æ­£ç¡®ç­”æ¡ˆï¼šB**

**è§£æï¼š**

```move
struct Resource {
    value: u64
}

fun test() {
    let r = Resource { value: 100 };
    let r2 = r;    // r è¢«ç§»åŠ¨åˆ° r2
    let r3 = r;    // é”™è¯¯ï¼r å·²ç»ä¸å­˜åœ¨äº†
}
```

å› ä¸º `Resource` æ²¡æœ‰ `copy` èƒ½åŠ›ï¼Œæ‰€ä»¥ `let r2 = r` ä¼š**ç§»åŠ¨**ï¼ˆè€Œéå¤åˆ¶ï¼‰`r` çš„æ‰€æœ‰æƒã€‚ä¹‹å `r` å°±ä¸èƒ½å†ä½¿ç”¨äº†ã€‚

**çŸ¥è¯†ç‚¹**ï¼šMove çš„æ‰€æœ‰æƒç³»ç»Ÿ

---

### ç¬¬ 3 é¢˜ï¼šä¸ºä»€ä¹ˆä»£å¸ä¸åº”è¯¥æœ‰ copy èƒ½åŠ›

**æ­£ç¡®ç­”æ¡ˆï¼šB**

**è§£æï¼š**

å¦‚æœä»£å¸æœ‰ `copy` èƒ½åŠ›ï¼Œç”¨æˆ·å¯ä»¥æ— é™å¤åˆ¶ä»£å¸ï¼š

```move
let coin1 = Coin { value: 100 };
let coin2 = coin1;  // å¦‚æœæœ‰ copyï¼Œè¿™é‡Œæ˜¯å¤åˆ¶
let coin3 = coin1;  // åˆå¤åˆ¶äº†ä¸€æ¬¡
// ç°åœ¨æœ‰ 3 ä¸ªä»·å€¼ 100 çš„ä»£å¸ï¼Œå‡­ç©ºäº§ç”Ÿäº† 200ï¼
```

è¿™å°±æ˜¯**åŒèŠ±æ”»å‡»**ã€‚Move é€šè¿‡èƒ½åŠ›ç³»ç»Ÿåœ¨ç¼–è¯‘æœŸå°±é˜²æ­¢äº†è¿™ç§é—®é¢˜ã€‚

**çŸ¥è¯†ç‚¹**ï¼šèµ„æºå®‰å…¨æ€§

---

### ç¬¬ 4 é¢˜ï¼šHot Potato æ¨¡å¼

**æ­£ç¡®ç­”æ¡ˆï¼šB**

**è§£æï¼š**

Hot Potato æ¨¡å¼çš„æ ¸å¿ƒæ˜¯ç»“æ„ä½“**æ²¡æœ‰ä»»ä½•èƒ½åŠ›**ï¼š

```move
struct Receipt {  // æ²¡æœ‰ä»»ä½• has å£°æ˜
    amount: u64
}
```

è¿™æ„å‘³ç€ï¼š
- âŒ ä¸èƒ½å¤åˆ¶ï¼ˆæ²¡æœ‰ copyï¼‰
- âŒ ä¸èƒ½ä¸¢å¼ƒï¼ˆæ²¡æœ‰ dropï¼‰
- âŒ ä¸èƒ½å­˜å‚¨ï¼ˆæ²¡æœ‰ storeï¼‰
- âœ… å¿…é¡»è¢«æ˜¾å¼å¤„ç†ï¼ˆè§£æ„é”€æ¯ï¼‰

**çŸ¥è¯†ç‚¹**ï¼šHot Potato æ¨¡å¼

---

### ç¬¬ 5 é¢˜ï¼šæ³›å‹å‡½æ•°å£°æ˜

**æ­£ç¡®ç­”æ¡ˆï¼šDï¼ˆä»¥ä¸Šéƒ½æ­£ç¡®ï¼‰**

**è§£æï¼š**

```move
// A: æ­£ç¡® - T å¯ä»¥æ˜¯ä»»ä½•ç±»å‹
public fun process<T>(value: T): T { value }

// B: æ­£ç¡® - T éœ€è¦ copy æ‰èƒ½å¤åˆ¶
public fun duplicate<T: copy>(value: T): (T, T) { (value, value) }

// C: æ­£ç¡® - T éœ€è¦ drop æ‰èƒ½è¢«ä¸¢å¼ƒ
public fun store<T: drop>(value: T) { /* ... */ }
```

æ‰€æœ‰ä¸‰ä¸ªå£°æ˜éƒ½æ˜¯åˆæ³•çš„ã€‚å…³é”®æ˜¯ç†è§£æ³›å‹çº¦æŸçš„ä½œç”¨ã€‚

**çŸ¥è¯†ç‚¹**ï¼šæ³›å‹çº¦æŸ

---

### ç¬¬ 6 é¢˜ï¼šèƒ½åŠ›ç»§æ‰¿è§„åˆ™

**æ­£ç¡®ç­”æ¡ˆï¼šA**

**è§£æï¼š**

å­ç±»å‹çš„èƒ½åŠ›ä¸èƒ½è¶…è¿‡å…¶å­—æ®µç±»å‹çš„èƒ½åŠ›ï¼š

```move
struct Inner {  // æ²¡æœ‰ drop
    value: u64
}

// âŒ é”™è¯¯ï¼
struct Container has drop {
    inner: Inner  // Inner æ²¡æœ‰ drop
}

// âœ… æ­£ç¡®
struct Container {  // ä¸å£°æ˜ drop
    inner: Inner
}
```

**è§„åˆ™**ï¼šå¦‚æœä»»ä½•å­—æ®µæ²¡æœ‰æŸä¸ªèƒ½åŠ›ï¼Œå®¹å™¨ä¹Ÿä¸èƒ½æœ‰è¿™ä¸ªèƒ½åŠ›ã€‚

**çŸ¥è¯†ç‚¹**ï¼šèƒ½åŠ›ç»§æ‰¿

---

### ç¬¬ 7 é¢˜ï¼šWitness æ¨¡å¼

**æ­£ç¡®ç­”æ¡ˆï¼šB**

**è§£æï¼š**

```move
struct Witness has drop {}
```

Witness æ¨¡å¼ç”¨äº**ä¸€æ¬¡æ€§æˆæƒ**ï¼š
- åªæœ‰ `drop` èƒ½åŠ›ï¼Œä½¿ç”¨åå¯ä»¥ç«‹å³ä¸¢å¼ƒ
- æ²¡æœ‰ `copy`ï¼Œä¸èƒ½å¤åˆ¶ï¼Œç¡®ä¿å”¯ä¸€æ€§
- æ²¡æœ‰ `store`ï¼Œä¸èƒ½æŒä¹…åŒ–
- å¸¸ç”¨äºåˆå§‹åŒ–æ“ä½œçš„æƒé™æ§åˆ¶

**çŸ¥è¯†ç‚¹**ï¼šWitness æ¨¡å¼

---

### ç¬¬ 8 é¢˜ï¼škey èƒ½åŠ›

**æ­£ç¡®ç­”æ¡ˆï¼šD**

**è§£æï¼š**

å››ç§èƒ½åŠ›çš„ä½œç”¨ï¼š
- **copy**ï¼šå…è®¸å¤åˆ¶
- **drop**ï¼šå…è®¸ä¸¢å¼ƒ
- **store**ï¼šå…è®¸å­˜å‚¨åœ¨ç»“æ„ä½“æˆ–å…¨å±€å­˜å‚¨ä¸­
- **key**ï¼šå…è®¸ä½œä¸ºå…¨å±€å­˜å‚¨çš„**é¡¶å±‚å¯¹è±¡**

```move
struct Account has key {  // å¯ä»¥ç”¨ move_to å­˜å‚¨
    balance: u64
}
```

**çŸ¥è¯†ç‚¹**ï¼škey èƒ½åŠ›çš„ä½œç”¨

---

### ç¬¬ 9 é¢˜ï¼šæ³›å‹çº¦æŸ

**æ­£ç¡®ç­”æ¡ˆï¼šD**

**è§£æï¼š**

é€‰é¡¹ D æ˜¯**é”™è¯¯**çš„ã€‚æ³›å‹çº¦æŸä¸æ€»æ˜¯å¯é€‰çš„ï¼š

```move
// âŒ é”™è¯¯ï¼T æ²¡æœ‰ copyï¼Œä¸èƒ½å¤åˆ¶
public fun duplicate<T>(value: T): (T, T) {
    (value, value)  // ç¼–è¯‘é”™è¯¯
}

// âœ… æ­£ç¡®ï¼šæ·»åŠ çº¦æŸ
public fun duplicate<T: copy>(value: T): (T, T) {
    (value, value)
}
```

å¦‚æœå‡½æ•°ä½“éœ€è¦æŸç§èƒ½åŠ›ï¼Œå°±å¿…é¡»æ·»åŠ çº¦æŸã€‚

**çŸ¥è¯†ç‚¹**ï¼šæ³›å‹çº¦æŸçš„å¿…è¦æ€§

---

### ç¬¬ 10 é¢˜ï¼šä¸éœ€è¦ copy èƒ½åŠ›çš„æ“ä½œ

**æ­£ç¡®ç­”æ¡ˆï¼šC**

**è§£æï¼š**

```move
A. let x = value; let y = value;  // éœ€è¦ copyï¼ˆä½¿ç”¨ä¸¤æ¬¡ï¼‰
B. vector::push_back(&mut vec, value);  // éœ€è¦ç§»åŠ¨ï¼Œä¸ä¸€å®šéœ€è¦ copy
C. return value;  // âœ… åªéœ€è¦ç§»åŠ¨ï¼Œä¸éœ€è¦ copy
D. *&value  // éœ€è¦ copyï¼ˆè§£å¼•ç”¨ï¼‰
```

`return value` æ˜¯**æ‰€æœ‰æƒè½¬ç§»**ï¼Œä¸æ˜¯å¤åˆ¶ï¼Œæ‰€ä»¥ä¸éœ€è¦ `copy` èƒ½åŠ›ã€‚

**çŸ¥è¯†ç‚¹**ï¼šæ‰€æœ‰æƒè½¬ç§» vs å¤åˆ¶

---

### ç¬¬ 11 é¢˜ï¼ˆé™„åŠ é¢˜ï¼‰ï¼šæ³›å‹çº¦æŸçš„åº”ç”¨

**æ­£ç¡®ç­”æ¡ˆï¼šA**

**è§£æï¼š**

```move
struct Container<T: store> has key {  // T å¿…é¡»æœ‰ store
    items: vector<T>
}

struct Item has store {  // âœ… æœ‰ store
    value: u64
}

struct NonStorable {  // âŒ æ²¡æœ‰ store
    value: u64
}
```

- **é€‰é¡¹ A**ï¼šâœ… `Item` æœ‰ `store` èƒ½åŠ›ï¼Œæ»¡è¶³çº¦æŸ
- **é€‰é¡¹ B**ï¼šâŒ `NonStorable` æ²¡æœ‰ `store`ï¼Œä¸æ»¡è¶³çº¦æŸ
- **é€‰é¡¹ C**ï¼šâŒ åªèƒ½å­˜å‚¨æœ‰ `store` èƒ½åŠ›çš„ç±»å‹
- **é€‰é¡¹ D**ï¼šâŒ çº¦æŸæ˜¯å¿…è¦çš„ï¼Œç¡®ä¿ç±»å‹å®‰å…¨

**çŸ¥è¯†ç‚¹**ï¼šæ³›å‹çº¦æŸçš„å®é™…åº”ç”¨

---

## é€‰æ‹©é¢˜è®¡åˆ†

| é¢˜å· | ç­”æ¡ˆ | åˆ†æ•° | ä½ çš„å¾—åˆ† |
|------|------|------|----------|
| 1 | D | 5 |  |
| 2 | B | 5 |  |
| 3 | B | 5 |  |
| 4 | B | 5 |  |
| 5 | D | 5 |  |
| 6 | A | 5 |  |
| 7 | B | 5 |  |
| 8 | D | 5 |  |
| 9 | D | 5 |  |
| 10 | C | 5 |  |
| 11 | A | 10 |  |
| **æ€»åˆ†** | | **60** |  |

---

## ç¼–ç¨‹é¢˜ç­”æ¡ˆï¼ˆ50 åˆ†ï¼‰

---

### ç¼–ç¨‹é¢˜ 1ï¼šæ³›å‹äº¤æ¢å‡½æ•°

**å‚è€ƒç­”æ¡ˆï¼š**

```move
module exam::problem1 {
    public fun swap_if_greater(a: u64, b: u64): (u64, u64) {
        if (a > b) {
            (b, a)
        } else {
            (a, b)
        }
    }

    #[test]
    fun test_swap_if_greater() {
        let (a, b) = swap_if_greater(5, 3);
        assert!(a == 3 && b == 5, 0);
        
        let (a, b) = swap_if_greater(2, 8);
        assert!(a == 2 && b == 8, 1);
        
        let (a, b) = swap_if_greater(5, 5);
        assert!(a == 5 && b == 5, 2);
    }
}
```

**è¯„åˆ†è¦ç‚¹ï¼š**
- âœ… æ­£ç¡®ä½¿ç”¨æ³›å‹ï¼ˆå®é™…å®ç°ä¸º u64ï¼‰ï¼š5 åˆ†
- âœ… æ¯”è¾ƒå’Œäº¤æ¢é€»è¾‘æ­£ç¡®ï¼š5 åˆ†
- âœ… æµ‹è¯•é€šè¿‡ï¼š5 åˆ†

---

### ç¼–ç¨‹é¢˜ 2ï¼šæƒé™ç³»ç»Ÿ

**å‚è€ƒç­”æ¡ˆï¼š**

```move
module exam::problem2 {
    use std::signer;
    use std::option::{Self, Option};

    struct AdminCap has drop {}

    struct Resource has store {
        value: u64
    }

    struct Storage has key {
        resource: Option<Resource>
    }

    public fun create_admin_cap(): AdminCap {
        AdminCap {}
    }

    public fun create_storage(account: &signer) {
        move_to(account, Storage {
            resource: option::none()
        });
    }

    public fun store_resource(
        _cap: &AdminCap,
        account: &signer,
        resource: Resource
    ) acquires Storage {
        let addr = signer::address_of(account);
        let storage = borrow_global_mut<Storage>(addr);
        option::fill(&mut storage.resource, resource);
    }

    public fun retrieve_resource(
        _cap: &AdminCap,
        account: &signer
    ): Resource acquires Storage {
        let addr = signer::address_of(account);
        let storage = borrow_global_mut<Storage>(addr);
        option::extract(&mut storage.resource)
    }

    public fun destroy_admin_cap(cap: AdminCap) {
        let AdminCap {} = cap;
    }

    #[test(admin = @0x1)]
    fun test_permission_system(admin: &signer) acquires Storage {
        let cap = create_admin_cap();
        create_storage(admin);
        
        let resource = Resource { value: 100 };
        store_resource(&cap, admin, resource);
        
        let retrieved = retrieve_resource(&cap, admin);
        assert!(retrieved.value == 100, 0);
        
        // é”€æ¯èµ„æº
        let Resource { value: _ } = retrieved;
        destroy_admin_cap(cap);
    }
}
```

**è¯„åˆ†è¦ç‚¹ï¼š**
- âœ… AdminCap åªæœ‰ dropï¼š4 åˆ†
- âœ… Resource åªæœ‰ storeï¼š2 åˆ†
- âœ… Storage æœ‰ keyï¼š2 åˆ†
- âœ… å‡½æ•°å®ç°æ­£ç¡®ï¼š8 åˆ†
- âœ… æµ‹è¯•é€šè¿‡ï¼š4 åˆ†

---

### ç¼–ç¨‹é¢˜ 3ï¼šHot Potato å®æˆ˜

**å‚è€ƒç­”æ¡ˆï¼š**

```move
module exam::problem3 {
    struct Ticket {
        user: address,
        expires_at: u64
    }

    public fun get_ticket(user: address, duration: u64): Ticket {
        Ticket {
            user,
            expires_at: duration
        }
    }

    public fun use_ticket(ticket: &Ticket, current_time: u64): bool {
        current_time < ticket.expires_at
    }

    public fun return_ticket(ticket: Ticket) {
        let Ticket { user: _, expires_at: _ } = ticket;
    }

    #[test]
    fun test_ticket_system() {
        let ticket = get_ticket(@0x1, 100);
        
        // æœªè¿‡æœŸ
        assert!(use_ticket(&ticket, 50), 0);
        
        // å·²è¿‡æœŸ
        assert!(!use_ticket(&ticket, 150), 1);
        
        return_ticket(ticket);
    }

    #[test]
    fun test_valid_usage() {
        let ticket = get_ticket(@0x1, 100);
        let valid = use_ticket(&ticket, 50);
        assert!(valid, 0);
        return_ticket(ticket);
    }
}
```

**è¯„åˆ†è¦ç‚¹ï¼š**
- âœ… Ticket æ²¡æœ‰ä»»ä½•èƒ½åŠ›ï¼š5 åˆ†
- âœ… get_ticket å®ç°æ­£ç¡®ï¼š3 åˆ†
- âœ… use_ticket é€»è¾‘æ­£ç¡®ï¼š3 åˆ†
- âœ… return_ticket æ­£ç¡®é”€æ¯ï¼š4 åˆ†

---

## ç¼–ç¨‹é¢˜è®¡åˆ†

| é¢˜ç›® | æ€»åˆ† | ä½ çš„å¾—åˆ† |
|------|------|----------|
| ç¼–ç¨‹é¢˜ 1 | 15 |  |
| ç¼–ç¨‹é¢˜ 2 | 20 |  |
| ç¼–ç¨‹é¢˜ 3 | 15 |  |
| **æ€»åˆ†** | **50** |  |

---

## æ€»æˆç»©ç»Ÿè®¡

| éƒ¨åˆ† | æ€»åˆ† | ä½ çš„å¾—åˆ† |
|------|------|----------|
| é€‰æ‹©é¢˜ | 60 |  |
| ç¼–ç¨‹é¢˜ | 50 |  |
| **æ€»åˆ†** | **110** |  |

**åŠæ ¼çº¿**ï¼š77 åˆ†ï¼ˆ70%ï¼‰  
**ä¼˜ç§€çº¿**ï¼š99 åˆ†ï¼ˆ90%ï¼‰

---

## ğŸ’¡ é”™é¢˜å¤ä¹ å»ºè®®

### å¦‚æœé€‰æ‹©é¢˜é”™è¯¯è¾ƒå¤šï¼š
- é‡æ–°é˜…è¯» `01_ç†è®ºå­¦ä¹ /æ ¸å¿ƒæ¦‚å¿µ.md`
- ç‰¹åˆ«å…³æ³¨èƒ½åŠ›ç³»ç»Ÿéƒ¨åˆ†
- ç†è§£ä¸ºä»€ä¹ˆéœ€è¦èƒ½åŠ›çº¦æŸ

### å¦‚æœç¼–ç¨‹é¢˜é”™è¯¯è¾ƒå¤šï¼š
- ç ”ç©¶å‚è€ƒç­”æ¡ˆçš„å®ç°ç»†èŠ‚
- é‡æ–°å®Œæˆ `02_å®è·µä»»åŠ¡`
- ç¡®ä¿ç†è§£ Hot Potato æ¨¡å¼

### å¸¸è§è¯¯åŒºï¼š

1. **èƒ½åŠ›å£°æ˜æ··ä¹±**
   - ä»£å¸ä¸è¦ copy
   - æƒé™å‡­è¯ä¸è¦ store
   - Hot Potato ä¸è¦ä»»ä½•èƒ½åŠ›

2. **å¿˜è®° acquires å£°æ˜**
   ```move
   // é”™è¯¯
   public fun balance(addr: address): u64 {
       borrow_global<Account>(addr).balance
   }
   
   // æ­£ç¡®
   public fun balance(addr: address): u64 acquires Account {
       borrow_global<Account>(addr).balance
   }
   ```

3. **èµ„æºæœªæ­£ç¡®å¤„ç†**
   ```move
   // é”™è¯¯ï¼šèµ„æºæ³„æ¼
   public fun bad(coin: Coin) {
       // æ²¡æœ‰å¤„ç† coin
   }
   
   // æ­£ç¡®ï¼šè§£æ„é”€æ¯
   public fun good(coin: Coin) {
       let Coin { value: _ } = coin;
   }
   ```

---

## ğŸ¯ ä¸‹ä¸€æ­¥

- âœ… å¦‚æœå¾—åˆ† â‰¥ 77ï¼šç»§ç»­ Day 07
- âš ï¸ å¦‚æœå¾—åˆ† < 77ï¼šå¤ä¹ ä»Šå¤©å†…å®¹ï¼Œé‡æ–°æµ‹è¯•
- ğŸŒŸ å¦‚æœå¾—åˆ† â‰¥ 99ï¼šä¼˜ç§€ï¼å¯ä»¥æ·±å…¥ç ”ç©¶ Move Prover

**è®°ä½**ï¼šèƒ½åŠ›ç³»ç»Ÿæ˜¯ Move æœ€æ ¸å¿ƒçš„å®‰å…¨ç‰¹æ€§ï¼Œå¿…é¡»å®Œå…¨æŒæ¡ï¼

åŠ æ²¹ï¼ğŸ’ª
