# Day 08 选择题

## 📝 考试说明

- **题目数量**：20 题
- **每题分值**：2 分
- **总分**：40 分
- **建议时间**：30 分钟
- **及格分数**：28 分（70%）

---

## 第一部分：事件基础概念（1-5 题）

### 1. 关于 Move 事件系统，以下说法正确的是？

A. 事件可以在链上直接读取  
B. 事件只能被链下监听  
C. 事件必须存储在全局状态中  
D. 事件可以修改合约状态

<details>
<summary>💡 提示</summary>
思考事件的本质：它是用来通知的，不是用来存储状态的。
</details>

---

### 2. EventHandle 的作用是什么？

A. 存储事件数据  
B. 作为事件的容器和发射器  
C. 验证事件的合法性  
D. 加密事件内容

<details>
<summary>💡 提示</summary>
EventHandle 就像一个"事件发射器"，用来管理和发射特定类型的事件。
</details>

---

### 3. 事件结构体必须具有哪些能力？

A. `key`  
B. `drop` 和 `store`  
C. `copy`  
D. `key` 和 `store`

<details>
<summary>💡 提示</summary>
事件需要能够被丢弃（发射后），也需要能存储在 EventHandle 中。
</details>

---

### 4. 以下哪个场景最适合使用事件？

A. 存储用户余额  
B. 通知前端转账完成  
C. 验证用户身份  
D. 计算交易手续费

<details>
<summary>💡 提示</summary>
事件用于通知和记录，不用于存储状态或执行逻辑。
</details>

---

### 5. EventHandle 必须存储在哪里？

A. 函数参数中  
B. 全局变量中  
C. 资源（struct with key）中  
D. 临时变量中

<details>
<summary>💡 提示</summary>
EventHandle 需要持久化存储，只能放在带 key 能力的资源中。
</details>

---

## 第二部分：事件操作（6-10 题）

### 6. 发射事件使用哪个函数？

A. `event::create_event()`  
B. `event::emit_event()`  
C. `event::send_event()`  
D. `event::publish_event()`

<details>
<summary>💡 提示</summary>
查看 aptos_framework::event 模块的 API。
</details>

---

### 7. 关于事件序号（sequence number），正确的是？

A. 需要手动设置  
B. 自动递增  
C. 可以重复  
D. 从 1 开始

<details>
<summary>💡 提示</summary>
EventHandle 自动管理序号，每发射一个事件，序号加 1。
</details>

---

### 8. 以下代码有什么问题？

```move
public fun transfer(from: &signer, to: address, amount: u64) {
    let store = borrow_global<CoinStore>(signer::address_of(from));
    event::emit_event(&mut store.events, ...);  // 错误
}
```

A. 没有 acquires 声明  
B. 不能借用不可变引用后修改  
C. 事件类型错误  
D. 缺少时间戳

<details>
<summary>💡 提示</summary>
emit_event 需要可变引用 &mut，但这里借用的是不可变引用。
</details>

---

### 9. 一个资源可以有多少个 EventHandle？

A. 只能有 1 个  
B. 最多 3 个  
C. 没有限制  
D. 最多 10 个

<details>
<summary>💡 提示</summary>
根据业务需要，可以定义任意数量的 EventHandle。
</details>

---

### 10. 创建 EventHandle 的正确方式是？

A. `event::EventHandle::new()`  
B. `event::new_event_handle<T>(account)`  
C. `EventHandle { counter: 0 }`  
D. `event::create_handle()`

<details>
<summary>💡 提示</summary>
使用标准库提供的构造函数，需要传入 signer 引用。
</details>

---

## 第三部分：事件设计（11-15 题）

### 11. 设计转账事件时，哪些字段是必要的？

A. from, to, amount, timestamp  
B. 只需要 amount  
C. from, to  
D. 完整的交易历史

<details>
<summary>💡 提示</summary>
事件应该包含足够的信息来完整描述这个操作。
</details>

---

### 12. 事件数据应该如何设计？

A. 包含所有可能的信息  
B. 精简但完整，只包含关键信息  
C. 只包含用户地址  
D. 越详细越好

<details>
<summary>💡 提示</summary>
事件会被永久存储，应该精简但完整。
</details>

---

### 13. 如果需要存储大量数据（如图片），应该怎么做？

A. 直接存储在事件中  
B. 使用 vector<u8> 存储完整内容  
C. 只存储 IPFS 哈希  
D. 不使用事件

<details>
<summary>💡 提示</summary>
链上存储成本高，大文件应该存储在链下（如 IPFS），事件只记录哈希。
</details>

---

### 14. 多个相关操作应该如何发射事件？

A. 合并成一个事件  
B. 每个操作发射独立的事件  
C. 不发射事件  
D. 只发射最后一个操作的事件

<details>
<summary>💡 提示</summary>
不同类型的操作应该使用不同的事件类型，便于追踪。
</details>

---

### 15. 事件中的 timestamp 字段应该如何获取？

A. 使用系统时间  
B. 用户传入  
C. `timestamp::now_seconds()`  
D. 不需要时间戳

<details>
<summary>💡 提示</summary>
使用 Aptos 提供的时间戳模块获取区块链时间。
</details>

---

## 第四部分：链下索引（16-18 题）

### 16. 链下索引器的主要作用是什么？

A. 验证交易  
B. 监听事件并构建数据库  
C. 执行智能合约  
D. 挖矿

<details>
<summary>💡 提示</summary>
索引器是链下服务，将区块链数据转换为易于查询的格式。
</details>

---

### 17. 为什么需要链下索引器？

A. 链上查询慢且贵  
B. 需要复杂查询和聚合  
C. 需要历史数据分析  
D. 以上都是

<details>
<summary>💡 提示</summary>
索引器解决了链上查询的多个痛点。
</details>

---

### 18. Aptos 索引器的数据存储在哪里？

A. 区块链上  
B. PostgreSQL 数据库  
C. 内存中  
D. 文件系统

<details>
<summary>💡 提示</summary>
索引器将数据存储在传统数据库中，便于快速查询。
</details>

---

## 第五部分：最佳实践（19-20 题）

### 19. 关于事件的最佳实践，错误的是？

A. 事件名称应该清晰描述操作  
B. 每个事件类型使用独立的 EventHandle  
C. 事件应该包含所有可能的数据  
D. 重要操作都应该发射事件

<details>
<summary>💡 提示</summary>
事件应该精简，不是"越多越好"。
</details>

---

### 20. 在什么情况下事件发射会失败？

A. EventHandle 不存在  
B. 权限不足  
C. 整个交易回滚时  
D. 以上都可能

<details>
<summary>💡 提示</summary>
事件发射是交易的一部分，交易失败则事件不会被记录。
</details>

---

## 📊 答题卡

请在完成答题后，对照答案文件检查。

| 题号 | 你的答案 | 正确答案 | 得分 |
|------|----------|----------|------|
| 1    |          |          |      |
| 2    |          |          |      |
| 3    |          |          |      |
| 4    |          |          |      |
| 5    |          |          |      |
| 6    |          |          |      |
| 7    |          |          |      |
| 8    |          |          |      |
| 9    |          |          |      |
| 10   |          |          |      |
| 11   |          |          |      |
| 12   |          |          |      |
| 13   |          |          |      |
| 14   |          |          |      |
| 15   |          |          |      |
| 16   |          |          |      |
| 17   |          |          |      |
| 18   |          |          |      |
| 19   |          |          |      |
| 20   |          |          |      |

**总分：______ / 40 分**

---

## 🎯 评分标准

- **36-40 分（90%+）**：优秀！对事件系统有深入理解
- **32-35 分（80-89%）**：良好！基本概念掌握扎实
- **28-31 分（70-79%）**：及格！需要加强实践
- **< 28 分（< 70%）**：需要重新学习理论部分

---

**完成后请查看 `答案解析.md` 核对答案！**
