````markdown
# Day 02 æ¯æ—¥è€ƒè¯• - ç¼–ç¨‹é¢˜

**æ€»åˆ†ï¼š50 åˆ†**  
**æ—¶é—´ï¼š40 åˆ†é’Ÿ**

---

## ç¼–ç¨‹é¢˜ 1ï¼šå®‰å…¨çš„æ•°å€¼è¿ç®—åº“ï¼ˆ20 åˆ†ï¼‰

### é¢˜ç›®æè¿°

å®ç°ä¸€ä¸ªå®‰å…¨çš„æ•°å€¼è¿ç®—åº“ï¼Œæ‰€æœ‰è¿ç®—éƒ½è¦æ£€æŸ¥æº¢å‡ºå’Œä¸‹æº¢ã€‚

### è¦æ±‚å®ç°çš„å‡½æ•°

```move
module my_addr::safe_math {
    
    const MAX_U64: u128 = 18446744073709551615;
    const E_OVERFLOW: u64 = 1;
    const E_UNDERFLOW: u64 = 2;
    const E_DIVISION_BY_ZERO: u64 = 3;

    /// å®‰å…¨åŠ æ³•
    public fun checked_add(a: u64, b: u64): u64 {
        // TODO: å®ç°
        // æç¤ºï¼šè½¬æ¢ä¸ºu128è¿›è¡Œè®¡ç®—
        0
    }

    /// å®‰å…¨å‡æ³•
    public fun checked_sub(a: u64, b: u64): u64 {
        // TODO: å®ç°
        0
    }

    /// å®‰å…¨ä¹˜æ³•
    public fun checked_mul(a: u64, b: u64): u64 {
        // TODO: å®ç°
        0
    }

    /// å®‰å…¨é™¤æ³•
    public fun checked_div(a: u64, b: u64): u64 {
        // TODO: å®ç°
        0
    }

    /// è®¡ç®—ç™¾åˆ†æ¯”ï¼ˆé¿å…æº¢å‡ºï¼‰
    /// ä¾‹å¦‚ï¼špercentage(100, 15) = 15 (100çš„15%)
    public fun percentage(value: u64, percent: u64): u64 {
        // TODO: å®ç°
        // æ³¨æ„ï¼špercentå¯èƒ½å¤§äº100
        0
    }
}
```

### æµ‹è¯•ç”¨ä¾‹

```move
#[test]
fun test_checked_add() {
    assert!(checked_add(100, 200) == 300, 0);
}

#[test]
#[expected_failure(abort_code = E_OVERFLOW)]
fun test_add_overflow() {
    checked_add(18446744073709551615, 1);
}

#[test]
fun test_checked_sub() {
    assert!(checked_sub(100, 30) == 70, 0);
}

#[test]
#[expected_failure(abort_code = E_UNDERFLOW)]
fun test_sub_underflow() {
    checked_sub(10, 20);
}

#[test]
fun test_checked_mul() {
    assert!(checked_mul(100, 200) == 20000, 0);
}

#[test]
#[expected_failure(abort_code = E_OVERFLOW)]
fun test_mul_overflow() {
    checked_mul(10000000000, 10000000000);
}

#[test]
fun test_checked_div() {
    assert!(checked_div(100, 10) == 10, 0);
}

#[test]
#[expected_failure(abort_code = E_DIVISION_BY_ZERO)]
fun test_div_by_zero() {
    checked_div(100, 0);
}

#[test]
fun test_percentage() {
    assert!(percentage(100, 15) == 15, 0);
    assert!(percentage(1000, 50) == 500, 1);
    assert!(percentage(200, 150) == 300, 2);  // 150%
}
```

### è¯„åˆ†æ ‡å‡†

- åŠ å‡ä¹˜é™¤æ­£ç¡®å®ç°ï¼š12 åˆ†ï¼ˆæ¯ä¸ª3åˆ†ï¼‰
- percentageå‡½æ•°æ­£ç¡®ï¼š4 åˆ†
- æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼š4 åˆ†

---

## ç¼–ç¨‹é¢˜ 2ï¼šç±»å‹å®‰å…¨çš„æ¸©åº¦è½¬æ¢å™¨ï¼ˆ15 åˆ†ï¼‰

### é¢˜ç›®æè¿°

å®ç°ä¸€ä¸ªæ¸©åº¦è½¬æ¢ç³»ç»Ÿï¼Œä½¿ç”¨ç»“æ„ä½“è¡¨ç¤ºä¸åŒæ¸©åº¦å•ä½ï¼Œç¡®ä¿ç±»å‹å®‰å…¨ã€‚

### ç»“æ„ä½“å®šä¹‰

```move
struct Celsius has copy, drop, store {
    value: u64  // å®é™…æ¸©åº¦ * 100ï¼ˆä¿ç•™ä¸¤ä½å°æ•°ï¼‰
}

struct Fahrenheit has copy, drop, store {
    value: u64  // å®é™…æ¸©åº¦ * 100
}

struct Kelvin has copy, drop, store {
    value: u64  // å®é™…æ¸©åº¦ * 100
}
```

### è¦æ±‚å®ç°çš„å‡½æ•°

```move
module my_addr::temperature {
    
    struct Celsius has copy, drop, store {
        value: u64
    }

    struct Fahrenheit has copy, drop, store {
        value: u64
    }

    struct Kelvin has copy, drop, store {
        value: u64
    }

    const ABSOLUTE_ZERO_CELSIUS: u64 = 27315;  // -273.15 * 100
    const E_BELOW_ABSOLUTE_ZERO: u64 = 1;

    /// åˆ›å»ºæ‘„æ°æ¸©åº¦ï¼ˆvalueæ˜¯å®é™…æ¸©åº¦*100ï¼‰
    public fun celsius(value: u64): Celsius {
        Celsius { value }
    }

    /// åˆ›å»ºåæ°æ¸©åº¦
    public fun fahrenheit(value: u64): Fahrenheit {
        Fahrenheit { value }
    }

    /// åˆ›å»ºå¼€æ°æ¸©åº¦
    public fun kelvin(value: u64): Kelvin {
        Kelvin { value }
    }

    /// æ‘„æ°è½¬åæ°ï¼šF = C * 9/5 + 32
    public fun celsius_to_fahrenheit(c: Celsius): Fahrenheit {
        // TODO: å®ç°
        fahrenheit(0)
    }

    /// æ‘„æ°è½¬å¼€æ°ï¼šK = C + 273.15
    public fun celsius_to_kelvin(c: Celsius): Kelvin {
        // TODO: å®ç°
        kelvin(0)
    }

    /// åæ°è½¬æ‘„æ°ï¼šC = (F - 32) * 5/9
    public fun fahrenheit_to_celsius(f: Fahrenheit): Celsius {
        // TODO: å®ç°
        celsius(0)
    }

    /// å¼€æ°è½¬æ‘„æ°ï¼šC = K - 273.15
    public fun kelvin_to_celsius(k: Kelvin): Celsius {
        // TODO: å®ç°
        celsius(0)
    }

    /// è·å–æ¸©åº¦å€¼
    public fun get_celsius_value(c: Celsius): u64 {
        c.value
    }

    public fun get_fahrenheit_value(f: Fahrenheit): u64 {
        f.value
    }

    public fun get_kelvin_value(k: Kelvin): u64 {
        k.value
    }
}
```

### æµ‹è¯•ç”¨ä¾‹

```move
#[test]
fun test_celsius_to_fahrenheit() {
    // 0Â°C = 32Â°F
    let c = celsius(0);
    let f = celsius_to_fahrenheit(c);
    assert!(get_fahrenheit_value(f) == 3200, 0);
    
    // 100Â°C = 212Â°F
    let c2 = celsius(10000);
    let f2 = celsius_to_fahrenheit(c2);
    assert!(get_fahrenheit_value(f2) == 21200, 1);
}

#[test]
fun test_celsius_to_kelvin() {
    // 0Â°C = 273.15K
    let c = celsius(0);
    let k = celsius_to_kelvin(c);
    assert!(get_kelvin_value(k) == 27315, 0);
}

#[test]
fun test_round_trip() {
    // 25Â°C -> F -> C
    let c1 = celsius(2500);
    let f = celsius_to_fahrenheit(c1);
    let c2 = fahrenheit_to_celsius(f);
    
    // åº”è¯¥æ¥è¿‘åŸå€¼ï¼ˆå¯èƒ½æœ‰èˆå…¥è¯¯å·®ï¼‰
    let diff = if (get_celsius_value(c2) > 2500) {
        get_celsius_value(c2) - 2500
    } else {
        2500 - get_celsius_value(c2)
    };
    assert!(diff < 5, 0);  // è¯¯å·®å°äº0.05åº¦
}
```

### è¯„åˆ†æ ‡å‡†

- ç»“æ„ä½“å®šä¹‰æ­£ç¡®ï¼š2 åˆ†
- è½¬æ¢å‡½æ•°æ­£ç¡®å®ç°ï¼š10 åˆ†ï¼ˆæ¯ä¸ª2.5åˆ†ï¼‰
- æµ‹è¯•é€šè¿‡ï¼š3 åˆ†

---

## ç¼–ç¨‹é¢˜ 3ï¼šå˜é‡è¿½è¸ªå™¨ï¼ˆ15 åˆ†ï¼‰

### é¢˜ç›®æè¿°

å®ç°ä¸€ä¸ªç³»ç»Ÿï¼Œè¿½è¸ªå˜é‡çš„ä¿®æ”¹å†å²ã€‚

### ç»“æ„ä½“å®šä¹‰

```move
struct VariableTracker has key {
    current_value: u64,
    history: vector<u64>,     // å†å²å€¼
    timestamps: vector<u64>,  // æ¯æ¬¡ä¿®æ”¹çš„æ—¶é—´æˆ³
    max_history: u64          // æœ€å¤§å†å²è®°å½•æ•°
}
```

### è¦æ±‚å®ç°çš„å‡½æ•°

```move
module my_addr::variable_tracker {
    use std::signer;
    use std::vector;

    struct VariableTracker has key {
        current_value: u64,
        history: vector<u64>,
        timestamps: vector<u64>,
        max_history: u64
    }

    const E_TRACKER_EXISTS: u64 = 1;
    const E_TRACKER_NOT_FOUND: u64 = 2;
    const E_INDEX_OUT_OF_BOUNDS: u64 = 3;

    /// åˆ›å»ºè¿½è¸ªå™¨
    public fun create_tracker(account: &signer, initial_value: u64, max_history: u64) {
        // TODO: å®ç°
    }

    /// æ›´æ–°å€¼ï¼ˆè®°å½•åˆ°å†å²ï¼‰
    public fun update_value(account: &signer, new_value: u64, timestamp: u64) {
        // TODO: å®ç°
        // å¦‚æœå†å²è®°å½•æ»¡äº†ï¼Œåˆ é™¤æœ€æ—§çš„
    }

    /// è·å–å½“å‰å€¼
    public fun get_current_value(addr: address): u64 {
        // TODO: å®ç°
        0
    }

    /// è·å–å†å²è®°å½•æ•°é‡
    public fun get_history_count(addr: address): u64 {
        // TODO: å®ç°
        0
    }

    /// è·å–ç‰¹å®šç´¢å¼•çš„å†å²å€¼
    public fun get_history_at(addr: address, index: u64): (u64, u64) {
        // TODO: å®ç°
        // è¿”å› (value, timestamp)
        (0, 0)
    }

    /// è·å–å¹³å‡å€¼
    public fun get_average_value(addr: address): u64 {
        // TODO: å®ç°
        // åŒ…æ‹¬å½“å‰å€¼å’Œæ‰€æœ‰å†å²å€¼çš„å¹³å‡
        0
    }

    /// è·å–æœ€å¤§å€¼
    public fun get_max_value(addr: address): u64 {
        // TODO: å®ç°
        0
    }

    /// è·å–æœ€å°å€¼
    public fun get_min_value(addr: address): u64 {
        // TODO: å®ç°
        0
    }
}
```

### æµ‹è¯•ç”¨ä¾‹

```move
#[test(account = @0x1)]
fun test_create_and_update(account: &signer) acquires VariableTracker {
    create_tracker(account, 100, 5);
    let addr = signer::address_of(account);
    
    assert!(get_current_value(addr) == 100, 0);
    
    update_value(account, 200, 1000);
    assert!(get_current_value(addr) == 200, 1);
    assert!(get_history_count(addr) == 1, 2);
}

#[test(account = @0x1)]
fun test_history_limit(account: &signer) acquires VariableTracker {
    create_tracker(account, 100, 3);
    let addr = signer::address_of(account);
    
    update_value(account, 200, 1000);
    update_value(account, 300, 2000);
    update_value(account, 400, 3000);
    update_value(account, 500, 4000);  // åº”è¯¥åˆ é™¤æœ€æ—§çš„
    
    assert!(get_history_count(addr) == 3, 0);
}

#[test(account = @0x1)]
fun test_statistics(account: &signer) acquires VariableTracker {
    create_tracker(account, 100, 5);
    let addr = signer::address_of(account);
    
    update_value(account, 200, 1000);
    update_value(account, 50, 2000);
    update_value(account, 300, 3000);
    
    assert!(get_max_value(addr) == 300, 0);
    assert!(get_min_value(addr) == 50, 1);
    
    // å¹³å‡å€¼ = (100 + 200 + 50 + 300) / 4 = 162.5 -> 162
    assert!(get_average_value(addr) == 162, 2);
}
```

### è¯„åˆ†æ ‡å‡†

- åˆ›å»ºå’Œæ›´æ–°åŠŸèƒ½ï¼š5 åˆ†
- å†å²è®°å½•ç®¡ç†ï¼š4 åˆ†
- ç»Ÿè®¡å‡½æ•°æ­£ç¡®ï¼š4 åˆ†
- æµ‹è¯•é€šè¿‡ï¼š2 åˆ†

---

## æäº¤è¯´æ˜

### æ–‡ä»¶ç»“æ„

```
03_æ¯æ—¥è€ƒè¯•/
â””â”€â”€ ä½ çš„ç­”æ¡ˆ/
    â”œâ”€â”€ Move.toml
    â””â”€â”€ sources/
        â”œâ”€â”€ safe_math.move
        â”œâ”€â”€ temperature.move
        â””â”€â”€ variable_tracker.move
```

### Move.toml

```toml
[package]
name = "day02_exam"
version = "1.0.0"

[addresses]
my_addr = "_"

[dependencies.AptosFramework]
git = "https://github.com/aptos-labs/aptos-core.git"
rev = "mainnet"
subdir = "aptos-move/framework/aptos-framework"
```

### æµ‹è¯•æ–¹æ³•

```bash
# æµ‹è¯•æ‰€æœ‰é¢˜ç›®
aptos move test

# æµ‹è¯•å•ä¸ªé¢˜ç›®
aptos move test --filter safe_math
aptos move test --filter temperature
aptos move test --filter variable_tracker
```

---

## è¯„åˆ†æ±‡æ€»

| é¢˜ç›® | åˆ†æ•° | ä½ çš„å¾—åˆ† |
|------|------|----------|
| ç¼–ç¨‹é¢˜ 1 | 20 |  |
| ç¼–ç¨‹é¢˜ 2 | 15 |  |
| ç¼–ç¨‹é¢˜ 3 | 15 |  |
| **æ€»åˆ†** | **50** |  |

**åŠæ ¼çº¿**ï¼š35 åˆ†ï¼ˆ70%ï¼‰  
**ä¼˜ç§€çº¿**ï¼š45 åˆ†ï¼ˆ90%ï¼‰

---

## ğŸ’¡ è§£é¢˜æç¤º

### ç¼–ç¨‹é¢˜ 1
- ä½¿ç”¨u128è¿›è¡Œä¸­é—´è®¡ç®—
- æ£€æŸ¥ç»“æœæ˜¯å¦è¶…è¿‡MAX_U64
- percentageå‡½æ•°ï¼š`value * percent / 100`ï¼Œæ³¨æ„æº¢å‡º

### ç¼–ç¨‹é¢˜ 2
- æ¸©åº¦å€¼éƒ½ä¹˜ä»¥100å­˜å‚¨ï¼ˆå®šç‚¹æ•°ï¼‰
- è½¬æ¢å…¬å¼è¦æ­£ç¡®å¤„ç†å®šç‚¹æ•°
- æ³¨æ„é™¤æ³•çš„èˆå…¥

### ç¼–ç¨‹é¢˜ 3
- ä½¿ç”¨vectorç®¡ç†å†å²è®°å½•
- å½“å†å²æ»¡æ—¶ï¼Œç”¨`vector::remove`åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ 
- ç»Ÿè®¡å‡½æ•°è¦éå†æ‰€æœ‰å€¼ï¼ˆåŒ…æ‹¬å½“å‰å€¼ï¼‰

---

## å¸¸è§é”™è¯¯

### âŒ é”™è¯¯ 1ï¼šå¿˜è®°å¤„ç†å®šç‚¹æ•°

```move
// é”™è¯¯ï¼šæ‘„æ°è½¬åæ°
public fun celsius_to_fahrenheit(c: Celsius): Fahrenheit {
    let f_value = c.value * 9 / 5 + 32;  // âŒ å¿˜è®°c.valueæ˜¯*100çš„
    fahrenheit(f_value)
}

// æ­£ç¡®
public fun celsius_to_fahrenheit(c: Celsius): Fahrenheit {
    let f_value = (c.value * 9 / 5) + 3200;  // 32 * 100
    fahrenheit(f_value)
}
```

### âŒ é”™è¯¯ 2ï¼švectoræ“ä½œé¡ºåº

```move
// é”™è¯¯
vector::push_back(&mut history, new_value);
if (vector::length(&history) > max_history) {
    vector::remove(&mut history, 0);  // è¿™æ ·ä¼šå¯¼è‡´å¤šä¸€ä¸ªå…ƒç´ 
}

// æ­£ç¡®
if (vector::length(&history) >= max_history) {
    vector::remove(&mut history, 0);
}
vector::push_back(&mut history, new_value);
```

---

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š40 åˆ†é’Ÿ  
**å®é™…ç”¨æ—¶**ï¼š________

ç­”æ¡ˆå’Œè¯¦ç»†è§£æè¯·å‚è€ƒ `ç­”æ¡ˆè§£æ.md`

åŠ æ²¹ï¼ğŸ’ª

````
